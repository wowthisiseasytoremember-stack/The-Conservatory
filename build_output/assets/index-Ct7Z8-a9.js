(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function Ow(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Eg={exports:{}},ec={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zE;function GN(){if(zE)return ec;zE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var l=null;if(a!==void 0&&(l=""+a),r.key!==void 0&&(l=""+r.key),"key"in r){a={};for(var c in r)c!=="key"&&(a[c]=r[c])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:a}}return ec.Fragment=e,ec.jsx=t,ec.jsxs=t,ec}var HE;function qN(){return HE||(HE=1,Eg.exports=GN()),Eg.exports}var I=qN(),Sg={exports:{}},De={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KE;function zN(){if(KE)return De;KE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.for("react.activity"),E=Symbol.iterator;function C(B){return B===null||typeof B!="object"?null:(B=E&&B[E]||B["@@iterator"],typeof B=="function"?B:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,k={};function K(B,oe,pe){this.props=B,this.context=oe,this.refs=k,this.updater=pe||x}K.prototype.isReactComponent={},K.prototype.setState=function(B,oe){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,oe,"setState")},K.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function W(){}W.prototype=K.prototype;function q(B,oe,pe){this.props=B,this.context=oe,this.refs=k,this.updater=pe||x}var ee=q.prototype=new W;ee.constructor=q,P(ee,K.prototype),ee.isPureReactComponent=!0;var ae=Array.isArray;function z(){}var N={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function D(B,oe,pe){var ge=pe.ref;return{$$typeof:n,type:B,key:oe,ref:ge!==void 0?ge:null,props:pe}}function L(B,oe){return D(B.type,oe,B.props)}function U(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function G(B){var oe={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(pe){return oe[pe]})}var V=/\/+/g;function ke(B,oe){return typeof B=="object"&&B!==null&&B.key!=null?G(""+B.key):oe.toString(36)}function ht(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(z,z):(B.status="pending",B.then(function(oe){B.status==="pending"&&(B.status="fulfilled",B.value=oe)},function(oe){B.status==="pending"&&(B.status="rejected",B.reason=oe)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function te(B,oe,pe,ge,Re){var Le=typeof B;(Le==="undefined"||Le==="boolean")&&(B=null);var $e=!1;if(B===null)$e=!0;else switch(Le){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(B.$$typeof){case n:case e:$e=!0;break;case _:return $e=B._init,te($e(B._payload),oe,pe,ge,Re)}}if($e)return Re=Re(B),$e=ge===""?"."+ke(B,0):ge,ae(Re)?(pe="",$e!=null&&(pe=$e.replace(V,"$&/")+"/"),te(Re,oe,pe,"",function(Yr){return Yr})):Re!=null&&(U(Re)&&(Re=L(Re,pe+(Re.key==null||B&&B.key===Re.key?"":(""+Re.key).replace(V,"$&/")+"/")+$e)),oe.push(Re)),1;$e=0;var Kt=ge===""?".":ge+":";if(ae(B))for(var _t=0;_t<B.length;_t++)ge=B[_t],Le=Kt+ke(ge,_t),$e+=te(ge,oe,pe,Le,Re);else if(_t=C(B),typeof _t=="function")for(B=_t.call(B),_t=0;!(ge=B.next()).done;)ge=ge.value,Le=Kt+ke(ge,_t++),$e+=te(ge,oe,pe,Le,Re);else if(Le==="object"){if(typeof B.then=="function")return te(ht(B),oe,pe,ge,Re);throw oe=String(B),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return $e}function fe(B,oe,pe){if(B==null)return B;var ge=[],Re=0;return te(B,ge,"","",function(Le){return oe.call(pe,Le,Re++)}),ge}function Te(B){if(B._status===-1){var oe=B._result;oe=oe(),oe.then(function(pe){(B._status===0||B._status===-1)&&(B._status=1,B._result=pe)},function(pe){(B._status===0||B._status===-1)&&(B._status=2,B._result=pe)}),B._status===-1&&(B._status=0,B._result=oe)}if(B._status===1)return B._result.default;throw B._result}var Fe=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},tt={map:fe,forEach:function(B,oe,pe){fe(B,function(){oe.apply(this,arguments)},pe)},count:function(B){var oe=0;return fe(B,function(){oe++}),oe},toArray:function(B){return fe(B,function(oe){return oe})||[]},only:function(B){if(!U(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return De.Activity=T,De.Children=tt,De.Component=K,De.Fragment=t,De.Profiler=r,De.PureComponent=q,De.StrictMode=i,De.Suspense=f,De.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,De.__COMPILER_RUNTIME={__proto__:null,c:function(B){return N.H.useMemoCache(B)}},De.cache=function(B){return function(){return B.apply(null,arguments)}},De.cacheSignal=function(){return null},De.cloneElement=function(B,oe,pe){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var ge=P({},B.props),Re=B.key;if(oe!=null)for(Le in oe.key!==void 0&&(Re=""+oe.key),oe)!M.call(oe,Le)||Le==="key"||Le==="__self"||Le==="__source"||Le==="ref"&&oe.ref===void 0||(ge[Le]=oe[Le]);var Le=arguments.length-2;if(Le===1)ge.children=pe;else if(1<Le){for(var $e=Array(Le),Kt=0;Kt<Le;Kt++)$e[Kt]=arguments[Kt+2];ge.children=$e}return D(B.type,Re,ge)},De.createContext=function(B){return B={$$typeof:l,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:a,_context:B},B},De.createElement=function(B,oe,pe){var ge,Re={},Le=null;if(oe!=null)for(ge in oe.key!==void 0&&(Le=""+oe.key),oe)M.call(oe,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(Re[ge]=oe[ge]);var $e=arguments.length-2;if($e===1)Re.children=pe;else if(1<$e){for(var Kt=Array($e),_t=0;_t<$e;_t++)Kt[_t]=arguments[_t+2];Re.children=Kt}if(B&&B.defaultProps)for(ge in $e=B.defaultProps,$e)Re[ge]===void 0&&(Re[ge]=$e[ge]);return D(B,Le,Re)},De.createRef=function(){return{current:null}},De.forwardRef=function(B){return{$$typeof:c,render:B}},De.isValidElement=U,De.lazy=function(B){return{$$typeof:_,_payload:{_status:-1,_result:B},_init:Te}},De.memo=function(B,oe){return{$$typeof:p,type:B,compare:oe===void 0?null:oe}},De.startTransition=function(B){var oe=N.T,pe={};N.T=pe;try{var ge=B(),Re=N.S;Re!==null&&Re(pe,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(z,Fe)}catch(Le){Fe(Le)}finally{oe!==null&&pe.types!==null&&(oe.types=pe.types),N.T=oe}},De.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},De.use=function(B){return N.H.use(B)},De.useActionState=function(B,oe,pe){return N.H.useActionState(B,oe,pe)},De.useCallback=function(B,oe){return N.H.useCallback(B,oe)},De.useContext=function(B){return N.H.useContext(B)},De.useDebugValue=function(){},De.useDeferredValue=function(B,oe){return N.H.useDeferredValue(B,oe)},De.useEffect=function(B,oe){return N.H.useEffect(B,oe)},De.useEffectEvent=function(B){return N.H.useEffectEvent(B)},De.useId=function(){return N.H.useId()},De.useImperativeHandle=function(B,oe,pe){return N.H.useImperativeHandle(B,oe,pe)},De.useInsertionEffect=function(B,oe){return N.H.useInsertionEffect(B,oe)},De.useLayoutEffect=function(B,oe){return N.H.useLayoutEffect(B,oe)},De.useMemo=function(B,oe){return N.H.useMemo(B,oe)},De.useOptimistic=function(B,oe){return N.H.useOptimistic(B,oe)},De.useReducer=function(B,oe,pe){return N.H.useReducer(B,oe,pe)},De.useRef=function(B){return N.H.useRef(B)},De.useState=function(B){return N.H.useState(B)},De.useSyncExternalStore=function(B,oe,pe){return N.H.useSyncExternalStore(B,oe,pe)},De.useTransition=function(){return N.H.useTransition()},De.version="19.2.4",De}var JE;function jy(){return JE||(JE=1,Sg.exports=zN()),Sg.exports}var ye=jy();const HN=Ow(ye);var Ag={exports:{}},tc={},Ig={exports:{}},wg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E;function KN(){return $E||($E=1,(function(n){function e(te,fe){var Te=te.length;te.push(fe);e:for(;0<Te;){var Fe=Te-1>>>1,tt=te[Fe];if(0<r(tt,fe))te[Fe]=fe,te[Te]=tt,Te=Fe;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var fe=te[0],Te=te.pop();if(Te!==fe){te[0]=Te;e:for(var Fe=0,tt=te.length,B=tt>>>1;Fe<B;){var oe=2*(Fe+1)-1,pe=te[oe],ge=oe+1,Re=te[ge];if(0>r(pe,Te))ge<tt&&0>r(Re,pe)?(te[Fe]=Re,te[ge]=Te,Fe=ge):(te[Fe]=pe,te[oe]=Te,Fe=oe);else if(ge<tt&&0>r(Re,Te))te[Fe]=Re,te[ge]=Te,Fe=ge;else break e}}return fe}function r(te,fe){var Te=te.sortIndex-fe.sortIndex;return Te!==0?Te:te.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var f=[],p=[],_=1,T=null,E=3,C=!1,x=!1,P=!1,k=!1,K=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function ee(te){for(var fe=t(p);fe!==null;){if(fe.callback===null)i(p);else if(fe.startTime<=te)i(p),fe.sortIndex=fe.expirationTime,e(f,fe);else break;fe=t(p)}}function ae(te){if(P=!1,ee(te),!x)if(t(f)!==null)x=!0,z||(z=!0,G());else{var fe=t(p);fe!==null&&ht(ae,fe.startTime-te)}}var z=!1,N=-1,M=5,D=-1;function L(){return k?!0:!(n.unstable_now()-D<M)}function U(){if(k=!1,z){var te=n.unstable_now();D=te;var fe=!0;try{e:{x=!1,P&&(P=!1,W(N),N=-1),C=!0;var Te=E;try{t:{for(ee(te),T=t(f);T!==null&&!(T.expirationTime>te&&L());){var Fe=T.callback;if(typeof Fe=="function"){T.callback=null,E=T.priorityLevel;var tt=Fe(T.expirationTime<=te);if(te=n.unstable_now(),typeof tt=="function"){T.callback=tt,ee(te),fe=!0;break t}T===t(f)&&i(f),ee(te)}else i(f);T=t(f)}if(T!==null)fe=!0;else{var B=t(p);B!==null&&ht(ae,B.startTime-te),fe=!1}}break e}finally{T=null,E=Te,C=!1}fe=void 0}}finally{fe?G():z=!1}}}var G;if(typeof q=="function")G=function(){q(U)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ke=V.port2;V.port1.onmessage=U,G=function(){ke.postMessage(null)}}else G=function(){K(U,0)};function ht(te,fe){N=K(function(){te(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(te){switch(E){case 1:case 2:case 3:var fe=3;break;default:fe=E}var Te=E;E=fe;try{return te()}finally{E=Te}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(te,fe){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Te=E;E=te;try{return fe()}finally{E=Te}},n.unstable_scheduleCallback=function(te,fe,Te){var Fe=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Fe+Te:Fe):Te=Fe,te){case 1:var tt=-1;break;case 2:tt=250;break;case 5:tt=1073741823;break;case 4:tt=1e4;break;default:tt=5e3}return tt=Te+tt,te={id:_++,callback:fe,priorityLevel:te,startTime:Te,expirationTime:tt,sortIndex:-1},Te>Fe?(te.sortIndex=Te,e(p,te),t(f)===null&&te===t(p)&&(P?(W(N),N=-1):P=!0,ht(ae,Te-Fe))):(te.sortIndex=tt,e(f,te),x||C||(x=!0,z||(z=!0,G()))),te},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(te){var fe=E;return function(){var Te=E;E=fe;try{return te.apply(this,arguments)}finally{E=Te}}}})(wg)),wg}var YE;function JN(){return YE||(YE=1,Ig.exports=KN()),Ig.exports}var Cg={exports:{}},cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QE;function $N(){if(QE)return cn;QE=1;var n=jy();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(f,p,_){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:T==null?null:""+T,children:f,containerInfo:p,implementation:_}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,cn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(f,p,null,_)},cn.flushSync=function(f){var p=l.T,_=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=p,i.p=_,i.d.f()}},cn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},cn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},cn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,T=c(_,p.crossOrigin),E=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:T,integrity:E,fetchPriority:C}):_==="script"&&i.d.X(f,{crossOrigin:T,integrity:E,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},cn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=c(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},cn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,T=c(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:T,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},cn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=c(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},cn.requestFormReset=function(f){i.d.r(f)},cn.unstable_batchedUpdates=function(f,p){return f(p)},cn.useFormState=function(f,p,_){return l.H.useFormState(f,p,_)},cn.useFormStatus=function(){return l.H.useHostTransitionStatus()},cn.version="19.2.4",cn}var jE;function YN(){if(jE)return Cg.exports;jE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cg.exports=$N(),Cg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XE;function QN(){if(XE)return tc;XE=1;var n=JN(),e=jy(),t=YN();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function f(s){if(a(s)!==s)throw Error(i(188))}function p(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var u=s,d=o;;){var y=u.return;if(y===null)break;var v=y.alternate;if(v===null){if(d=y.return,d!==null){u=d;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===u)return f(y),s;if(v===d)return f(y),o;v=v.sibling}throw Error(i(188))}if(u.return!==d.return)u=y,d=v;else{for(var A=!1,b=y.child;b;){if(b===u){A=!0,u=y,d=v;break}if(b===d){A=!0,d=y,u=v;break}b=b.sibling}if(!A){for(b=v.child;b;){if(b===u){A=!0,u=v,d=y;break}if(b===d){A=!0,d=v,u=y;break}b=b.sibling}if(!A)throw Error(i(189))}}if(u.alternate!==d)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:o}function _(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=_(s),o!==null)return o;s=s.sibling}return null}var T=Object.assign,E=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),q=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function G(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var V=Symbol.for("react.client.reference");function ke(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===V?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case P:return"Fragment";case K:return"Profiler";case k:return"StrictMode";case ae:return"Suspense";case z:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case x:return"Portal";case q:return s.displayName||"Context";case W:return(s._context.displayName||"Context")+".Consumer";case ee:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return o=s.displayName||null,o!==null?o:ke(s.type)||"Memo";case M:o=s._payload,s=s._init;try{return ke(s(o))}catch{}}return null}var ht=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Fe=[],tt=-1;function B(s){return{current:s}}function oe(s){0>tt||(s.current=Fe[tt],Fe[tt]=null,tt--)}function pe(s,o){tt++,Fe[tt]=s.current,s.current=o}var ge=B(null),Re=B(null),Le=B(null),$e=B(null);function Kt(s,o){switch(pe(Le,o),pe(Re,s),pe(ge,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?fE(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=fE(o),s=hE(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}oe(ge),pe(ge,s)}function _t(){oe(ge),oe(Re),oe(Le)}function Yr(s){s.memoizedState!==null&&pe($e,s);var o=ge.current,u=hE(o,s.type);o!==u&&(pe(Re,s),pe(ge,u))}function ia(s){Re.current===s&&(oe(ge),oe(Re)),$e.current===s&&(oe($e),ju._currentValue=Te)}var sa,ra;function Mi(s){if(sa===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);sa=o&&o[1]||"",ra=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+sa+s+ra}var jl=!1;function Qr(s,o){if(!s||jl)return"";jl=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(Z){var j=Z}Reflect.construct(s,[],re)}else{try{re.call()}catch(Z){j=Z}s.call(re.prototype)}}else{try{throw Error()}catch(Z){j=Z}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(Z){if(Z&&j&&typeof Z.stack=="string")return[Z.stack,j.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),A=v[0],b=v[1];if(A&&b){var O=A.split(`
`),Q=b.split(`
`);for(y=d=0;d<O.length&&!O[d].includes("DetermineComponentFrameRoot");)d++;for(;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;if(d===O.length||y===Q.length)for(d=O.length-1,y=Q.length-1;1<=d&&0<=y&&O[d]!==Q[y];)y--;for(;1<=d&&0<=y;d--,y--)if(O[d]!==Q[y]){if(d!==1||y!==1)do if(d--,y--,0>y||O[d]!==Q[y]){var ne=`
`+O[d].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=d&&0<=y);break}}}finally{jl=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Mi(u):""}function Xl(s,o){switch(s.tag){case 26:case 27:case 5:return Mi(s.type);case 16:return Mi("Lazy");case 13:return s.child!==o&&o!==null?Mi("Suspense Fallback"):Mi("Suspense");case 19:return Mi("SuspenseList");case 0:case 15:return Qr(s.type,!1);case 11:return Qr(s.type.render,!1);case 1:return Qr(s.type,!0);case 31:return Mi("Activity");default:return""}}function Wl(s){try{var o="",u=null;do o+=Xl(s,u),u=s,s=s.return;while(s);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Vt=Object.prototype.hasOwnProperty,Jt=n.unstable_scheduleCallback,zs=n.unstable_cancelCallback,Ap=n.unstable_shouldYield,rd=n.unstable_requestPaint,gn=n.unstable_now,jr=n.unstable_getCurrentPriorityLevel,Zl=n.unstable_ImmediatePriority,eu=n.unstable_UserBlockingPriority,Hs=n.unstable_NormalPriority,Ip=n.unstable_LowPriority,od=n.unstable_IdlePriority,ad=n.log,ld=n.unstable_setDisableYieldValue,di=null,tn=null;function $n(s){if(typeof ad=="function"&&ld(s),tn&&typeof tn.setStrictMode=="function")try{tn.setStrictMode(di,s)}catch{}}var bt=Math.clz32?Math.clz32:cd,ud=Math.log,oa=Math.LN2;function cd(s){return s>>>=0,s===0?32:31-(ud(s)/oa|0)|0}var Di=256,Xr=262144,kt=4194304;function Pi(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Vi(s,o,u){var d=s.pendingLanes;if(d===0)return 0;var y=0,v=s.suspendedLanes,A=s.pingedLanes;s=s.warmLanes;var b=d&134217727;return b!==0?(d=b&~v,d!==0?y=Pi(d):(A&=b,A!==0?y=Pi(A):u||(u=b&~s,u!==0&&(y=Pi(u))))):(b=d&~v,b!==0?y=Pi(b):A!==0?y=Pi(A):u||(u=d&~s,u!==0&&(y=Pi(u)))),y===0?0:o!==0&&o!==y&&(o&v)===0&&(v=y&-y,u=o&-o,v>=u||v===32&&(u&4194048)!==0)?o:y}function fi(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function wp(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dd(){var s=kt;return kt<<=1,(kt&62914560)===0&&(kt=4194304),s}function ki(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function Wr(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Cp(s,o,u,d,y,v){var A=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var b=s.entanglements,O=s.expirationTimes,Q=s.hiddenUpdates;for(u=A&~u;0<u;){var ne=31-bt(u),re=1<<ne;b[ne]=0,O[ne]=-1;var j=Q[ne];if(j!==null)for(Q[ne]=null,ne=0;ne<j.length;ne++){var Z=j[ne];Z!==null&&(Z.lane&=-536870913)}u&=~re}d!==0&&Zr(s,d,0),v!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=v&~(A&~o))}function Zr(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var d=31-bt(o);s.entangledLanes|=o,s.entanglements[d]=s.entanglements[d]|1073741824|u&261930}function tu(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var d=31-bt(u),y=1<<d;y&o|s[d]&o&&(s[d]|=o),u&=~y}}function nu(s,o){var u=o&-o;return u=(u&42)!==0?1:eo(u),(u&(s.suspendedLanes|o))!==0?0:u}function eo(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function as(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function fd(){var s=fe.p;return s!==0?s:(s=window.event,s===void 0?32:LE(s.type))}function hi(s,o){var u=fe.p;try{return fe.p=s,o()}finally{fe.p=u}}var pi=Math.random().toString(36).slice(2),Lt="__reactFiber$"+pi,jt="__reactProps$"+pi,Li="__reactContainer$"+pi,aa="__reactEvents$"+pi,bp="__reactListeners$"+pi,hd="__reactHandles$"+pi,pd="__reactResources$"+pi,Ui="__reactMarker$"+pi;function la(s){delete s[Lt],delete s[jt],delete s[aa],delete s[bp],delete s[hd]}function Oi(s){var o=s[Lt];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Li]||u[Lt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=TE(s);s!==null;){if(u=s[Lt])return u;s=TE(s)}return o}s=u,u=s.parentNode}return null}function Yn(s){if(s=s[Lt]||s[Li]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Pn(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function Fi(s){var o=s[pd];return o||(o=s[pd]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ut(s){s[Ui]=!0}var iu=new Set,su={};function Bi(s,o){Gi(s,o),Gi(s+"Capture",o)}function Gi(s,o){for(su[s]=o,s=0;s<o.length;s++)iu.add(o[s])}var ru=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ou={},au={};function md(s){return Vt.call(au,s)?!0:Vt.call(ou,s)?!1:ru.test(s)?au[s]=!0:(ou[s]=!0,!1)}function ua(s,o,u){if(md(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function Vn(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Ot(s,o,u,d){if(d===null)s.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+d)}}function Xt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ks(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function lu(s,o,u){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,v=d.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(A){u=""+A,v.call(this,A)}}),Object.defineProperty(s,o,{enumerable:d.enumerable}),{getValue:function(){return u},setValue:function(A){u=""+A},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function nt(s){if(!s._valueTracker){var o=Ks(s)?"checked":"value";s._valueTracker=lu(s,o,""+s[o])}}function to(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),d="";return s&&(d=Ks(s)?s.checked?"true":"false":s.value),s=d,s!==u?(o.setValue(s),!0):!1}function qi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var no=/[\n"\\]/g;function An(s){return s.replace(no,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ca(s,o,u,d,y,v,A,b){s.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?s.type=A:s.removeAttribute("type"),o!=null?A==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Xt(o)):s.value!==""+Xt(o)&&(s.value=""+Xt(o)):A!=="submit"&&A!=="reset"||s.removeAttribute("value"),o!=null?uu(s,A,Xt(o)):u!=null?uu(s,A,Xt(u)):d!=null&&s.removeAttribute("value"),y==null&&v!=null&&(s.defaultChecked=!!v),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.name=""+Xt(b):s.removeAttribute("name")}function gd(s,o,u,d,y,v,A,b){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),o!=null||u!=null){if(!(v!=="submit"&&v!=="reset"||o!=null)){nt(s);return}u=u!=null?""+Xt(u):"",o=o!=null?""+Xt(o):u,b||o===s.value||(s.value=o),s.defaultValue=o}d=d??y,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=b?s.checked:!!d,s.defaultChecked=!!d,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(s.name=A),nt(s)}function uu(s,o,u){o==="number"&&qi(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Js(s,o,u,d){if(s=s.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=o.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&d&&(s[u].defaultSelected=!0)}else{for(u=""+Xt(u),o=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,d&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function yd(s,o,u){if(o!=null&&(o=""+Xt(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+Xt(u):""}function $s(s,o,u,d){if(o==null){if(d!=null){if(u!=null)throw Error(i(92));if(ht(d)){if(1<d.length)throw Error(i(93));d=d[0]}u=d}u==null&&(u=""),o=u}u=Xt(o),s.defaultValue=u,d=s.textContent,d===u&&d!==""&&d!==null&&(s.value=d),nt(s)}function In(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var _d=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cu(s,o,u){var d=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?d?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":d?s.setProperty(o,u):typeof u!="number"||u===0||_d.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function du(s,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,u!=null){for(var d in u)!u.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var y in o)d=o[y],o.hasOwnProperty(y)&&u[y]!==d&&cu(s,y,d)}else for(var v in o)o.hasOwnProperty(v)&&cu(s,v,o[v])}function da(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ys=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fa(s){return Ys.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function mi(){}var fu=null;function Qn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Qs=null,zi=null;function io(s){var o=Yn(s);if(o&&(s=o.stateNode)){var u=s[jt]||null;e:switch(s=o.stateNode,o.type){case"input":if(ca(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+An(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var d=u[o];if(d!==s&&d.form===s.form){var y=d[jt]||null;if(!y)throw Error(i(90));ca(d,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)d=u[o],d.form===s.form&&to(d)}break e;case"textarea":yd(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Js(s,!!u.multiple,o,!1)}}}var ha=!1;function js(s,o,u){if(ha)return s(o,u);ha=!0;try{var d=s(o);return d}finally{if(ha=!1,(Qs!==null||zi!==null)&&(hf(),Qs&&(o=Qs,s=zi,zi=Qs=null,io(o),s)))for(o=0;o<s.length;o++)io(s[o])}}function gi(s,o){var u=s.stateNode;if(u===null)return null;var d=u[jt]||null;if(d===null)return null;u=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),so=!1;if(jn)try{var lt={};Object.defineProperty(lt,"passive",{get:function(){so=!0}}),window.addEventListener("test",lt,lt),window.removeEventListener("test",lt,lt)}catch{so=!1}var Hi=null,hu=null,ro=null;function pu(){if(ro)return ro;var s,o=hu,u=o.length,d,y="value"in Hi?Hi.value:Hi.textContent,v=y.length;for(s=0;s<u&&o[s]===y[s];s++);var A=u-s;for(d=1;d<=A&&o[u-d]===y[v-d];d++);return ro=y.slice(s,1<d?1-d:void 0)}function oo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function ls(){return!0}function yi(){return!1}function nn(s){function o(u,d,y,v,A){this._reactName=u,this._targetInst=y,this.type=d,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var b in s)s.hasOwnProperty(b)&&(u=s[b],this[b]=u?u(v):v[b]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ls:yi,this.isPropagationStopped=yi,this}return T(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),o}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ki=nn(us),Xs=T({},us,{view:0,detail:0}),mu=nn(Xs),Ws,pa,Ji,ma=T({},Xs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ji&&(Ji&&s.type==="mousemove"?(Ws=s.screenX-Ji.screenX,pa=s.screenY-Ji.screenY):pa=Ws=0,Ji=s),Ws)},movementY:function(s){return"movementY"in s?s.movementY:pa}}),gu=nn(ma),ao=T({},ma,{dataTransfer:0}),Td=nn(ao),Ed=T({},Xs,{relatedTarget:0}),lo=nn(Ed),yu=T({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),Sd=nn(yu),ga=T({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ad=nn(ga),Id=T({},us,{data:0}),$i=nn(Id),wd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rd(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=bd[s])?!!o[s]:!1}function Zs(){return Rd}var yn=T({},Xs,{key:function(s){if(s.key){var o=wd[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=oo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Cd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zs,charCode:function(s){return s.type==="keypress"?oo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?oo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),xd=nn(yn),Nd=T({},ma,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cs=nn(Nd),g=T({},Xs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zs}),S=nn(g),w=T({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=nn(w),$=T({},ma,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),X=nn($),ce=T({},us,{newState:0,oldState:0}),Pe=nn(ce),Rt=[9,13,27,32],We=jn&&"CompositionEvent"in window,vt=null;jn&&"documentMode"in document&&(vt=document.documentMode);var Xn=jn&&"TextEvent"in window&&!vt,Yi=jn&&(!We||vt&&8<vt&&11>=vt),_i=" ",vi=!1;function uo(s,o){switch(s){case"keyup":return Rt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ya(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var _a=!1;function d1(s,o){switch(s){case"compositionend":return ya(o);case"keypress":return o.which!==32?null:(vi=!0,_i);case"textInput":return s=o.data,s===_i&&vi?null:s;default:return null}}function f1(s,o){if(_a)return s==="compositionend"||!We&&uo(s,o)?(s=pu(),ro=hu=Hi=null,_a=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Yi&&o.locale!=="ko"?null:o.data;default:return null}}var h1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Av(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!h1[s.type]:o==="textarea"}function Iv(s,o,u,d){Qs?zi?zi.push(d):zi=[d]:Qs=d,o=Tf(o,"onChange"),0<o.length&&(u=new Ki("onChange","change",null,u,d),s.push({event:u,listeners:o}))}var _u=null,vu=null;function p1(s){oE(s,0)}function Md(s){var o=Pn(s);if(to(o))return s}function wv(s,o){if(s==="change")return o}var Cv=!1;if(jn){var Rp;if(jn){var xp="oninput"in document;if(!xp){var bv=document.createElement("div");bv.setAttribute("oninput","return;"),xp=typeof bv.oninput=="function"}Rp=xp}else Rp=!1;Cv=Rp&&(!document.documentMode||9<document.documentMode)}function Rv(){_u&&(_u.detachEvent("onpropertychange",xv),vu=_u=null)}function xv(s){if(s.propertyName==="value"&&Md(vu)){var o=[];Iv(o,vu,s,Qn(s)),js(p1,o)}}function m1(s,o,u){s==="focusin"?(Rv(),_u=o,vu=u,_u.attachEvent("onpropertychange",xv)):s==="focusout"&&Rv()}function g1(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Md(vu)}function y1(s,o){if(s==="click")return Md(o)}function _1(s,o){if(s==="input"||s==="change")return Md(o)}function v1(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var kn=typeof Object.is=="function"?Object.is:v1;function Tu(s,o){if(kn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),d=Object.keys(o);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var y=u[d];if(!Vt.call(o,y)||!kn(s[y],o[y]))return!1}return!0}function Nv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Mv(s,o){var u=Nv(s);s=0;for(var d;u;){if(u.nodeType===3){if(d=s+u.textContent.length,s<=o&&d>=o)return{node:u,offset:o-s};s=d}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Nv(u)}}function Dv(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Dv(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Pv(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=qi(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=qi(s.document)}return o}function Np(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var T1=jn&&"documentMode"in document&&11>=document.documentMode,va=null,Mp=null,Eu=null,Dp=!1;function Vv(s,o,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Dp||va==null||va!==qi(d)||(d=va,"selectionStart"in d&&Np(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Eu&&Tu(Eu,d)||(Eu=d,d=Tf(Mp,"onSelect"),0<d.length&&(o=new Ki("onSelect","select",null,o,u),s.push({event:o,listeners:d}),o.target=va)))}function co(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Ta={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionrun:co("Transition","TransitionRun"),transitionstart:co("Transition","TransitionStart"),transitioncancel:co("Transition","TransitionCancel"),transitionend:co("Transition","TransitionEnd")},Pp={},kv={};jn&&(kv=document.createElement("div").style,"AnimationEvent"in window||(delete Ta.animationend.animation,delete Ta.animationiteration.animation,delete Ta.animationstart.animation),"TransitionEvent"in window||delete Ta.transitionend.transition);function fo(s){if(Pp[s])return Pp[s];if(!Ta[s])return s;var o=Ta[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in kv)return Pp[s]=o[u];return s}var Lv=fo("animationend"),Uv=fo("animationiteration"),Ov=fo("animationstart"),E1=fo("transitionrun"),S1=fo("transitionstart"),A1=fo("transitioncancel"),Fv=fo("transitionend"),Bv=new Map,Vp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vp.push("scrollEnd");function Ti(s,o){Bv.set(s,o),Bi(o,[s])}var Dd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Wn=[],Ea=0,kp=0;function Pd(){for(var s=Ea,o=kp=Ea=0;o<s;){var u=Wn[o];Wn[o++]=null;var d=Wn[o];Wn[o++]=null;var y=Wn[o];Wn[o++]=null;var v=Wn[o];if(Wn[o++]=null,d!==null&&y!==null){var A=d.pending;A===null?y.next=y:(y.next=A.next,A.next=y),d.pending=y}v!==0&&Gv(u,y,v)}}function Vd(s,o,u,d){Wn[Ea++]=s,Wn[Ea++]=o,Wn[Ea++]=u,Wn[Ea++]=d,kp|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Lp(s,o,u,d){return Vd(s,o,u,d),kd(s)}function ho(s,o){return Vd(s,null,null,o),kd(s)}function Gv(s,o,u){s.lanes|=u;var d=s.alternate;d!==null&&(d.lanes|=u);for(var y=!1,v=s.return;v!==null;)v.childLanes|=u,d=v.alternate,d!==null&&(d.childLanes|=u),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(y=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,y&&o!==null&&(y=31-bt(u),s=v.hiddenUpdates,d=s[y],d===null?s[y]=[o]:d.push(o),o.lane=u|536870912),v):null}function kd(s){if(50<zu)throw zu=0,Km=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Sa={};function I1(s,o,u,d){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(s,o,u,d){return new I1(s,o,u,d)}function Up(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ds(s,o){var u=s.alternate;return u===null?(u=Ln(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function qv(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Ld(s,o,u,d,y,v){var A=0;if(d=s,typeof s=="function")Up(s)&&(A=1);else if(typeof s=="string")A=xN(s,u,ge.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=Ln(31,u,o,y),s.elementType=D,s.lanes=v,s;case P:return po(u.children,y,v,o);case k:A=8,y|=24;break;case K:return s=Ln(12,u,o,y|2),s.elementType=K,s.lanes=v,s;case ae:return s=Ln(13,u,o,y),s.elementType=ae,s.lanes=v,s;case z:return s=Ln(19,u,o,y),s.elementType=z,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case q:A=10;break e;case W:A=9;break e;case ee:A=11;break e;case N:A=14;break e;case M:A=16,d=null;break e}A=29,u=Error(i(130,s===null?"null":typeof s,"")),d=null}return o=Ln(A,u,o,y),o.elementType=s,o.type=d,o.lanes=v,o}function po(s,o,u,d){return s=Ln(7,s,d,o),s.lanes=u,s}function Op(s,o,u){return s=Ln(6,s,null,o),s.lanes=u,s}function zv(s){var o=Ln(18,null,null,0);return o.stateNode=s,o}function Fp(s,o,u){return o=Ln(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Hv=new WeakMap;function Zn(s,o){if(typeof s=="object"&&s!==null){var u=Hv.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Wl(o)},Hv.set(s,o),o)}return{value:s,source:o,stack:Wl(o)}}var Aa=[],Ia=0,Ud=null,Su=0,ei=[],ti=0,er=null,Qi=1,ji="";function fs(s,o){Aa[Ia++]=Su,Aa[Ia++]=Ud,Ud=s,Su=o}function Kv(s,o,u){ei[ti++]=Qi,ei[ti++]=ji,ei[ti++]=er,er=s;var d=Qi;s=ji;var y=32-bt(d)-1;d&=~(1<<y),u+=1;var v=32-bt(o)+y;if(30<v){var A=y-y%5;v=(d&(1<<A)-1).toString(32),d>>=A,y-=A,Qi=1<<32-bt(o)+y|u<<y|d,ji=v+s}else Qi=1<<v|u<<y|d,ji=s}function Bp(s){s.return!==null&&(fs(s,1),Kv(s,1,0))}function Gp(s){for(;s===Ud;)Ud=Aa[--Ia],Aa[Ia]=null,Su=Aa[--Ia],Aa[Ia]=null;for(;s===er;)er=ei[--ti],ei[ti]=null,ji=ei[--ti],ei[ti]=null,Qi=ei[--ti],ei[ti]=null}function Jv(s,o){ei[ti++]=Qi,ei[ti++]=ji,ei[ti++]=er,Qi=o.id,ji=o.overflow,er=s}var sn=null,mt=null,Je=!1,tr=null,ni=!1,qp=Error(i(519));function nr(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Au(Zn(o,s)),qp}function $v(s){var o=s.stateNode,u=s.type,d=s.memoizedProps;switch(o[Lt]=s,o[jt]=d,u){case"dialog":Ge("cancel",o),Ge("close",o);break;case"iframe":case"object":case"embed":Ge("load",o);break;case"video":case"audio":for(u=0;u<Ku.length;u++)Ge(Ku[u],o);break;case"source":Ge("error",o);break;case"img":case"image":case"link":Ge("error",o),Ge("load",o);break;case"details":Ge("toggle",o);break;case"input":Ge("invalid",o),gd(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ge("invalid",o);break;case"textarea":Ge("invalid",o),$s(o,d.value,d.defaultValue,d.children)}u=d.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||d.suppressHydrationWarning===!0||cE(o.textContent,u)?(d.popover!=null&&(Ge("beforetoggle",o),Ge("toggle",o)),d.onScroll!=null&&Ge("scroll",o),d.onScrollEnd!=null&&Ge("scrollend",o),d.onClick!=null&&(o.onclick=mi),o=!0):o=!1,o||nr(s,!0)}function Yv(s){for(sn=s.return;sn;)switch(sn.tag){case 5:case 31:case 13:ni=!1;return;case 27:case 3:ni=!0;return;default:sn=sn.return}}function wa(s){if(s!==sn)return!1;if(!Je)return Yv(s),Je=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||og(s.type,s.memoizedProps)),u=!u),u&&mt&&nr(s),Yv(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));mt=vE(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));mt=vE(s)}else o===27?(o=mt,gr(s.type)?(s=dg,dg=null,mt=s):mt=o):mt=sn?si(s.stateNode.nextSibling):null;return!0}function mo(){mt=sn=null,Je=!1}function zp(){var s=tr;return s!==null&&(Rn===null?Rn=s:Rn.push.apply(Rn,s),tr=null),s}function Au(s){tr===null?tr=[s]:tr.push(s)}var Hp=B(null),go=null,hs=null;function ir(s,o,u){pe(Hp,o._currentValue),o._currentValue=u}function ps(s){s._currentValue=Hp.current,oe(Hp)}function Kp(s,o,u){for(;s!==null;){var d=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),s===u)break;s=s.return}}function Jp(s,o,u,d){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var v=y.dependencies;if(v!==null){var A=y.child;v=v.firstContext;e:for(;v!==null;){var b=v;v=y;for(var O=0;O<o.length;O++)if(b.context===o[O]){v.lanes|=u,b=v.alternate,b!==null&&(b.lanes|=u),Kp(v.return,u,s),d||(A=null);break e}v=b.next}}else if(y.tag===18){if(A=y.return,A===null)throw Error(i(341));A.lanes|=u,v=A.alternate,v!==null&&(v.lanes|=u),Kp(A,u,s),A=null}else A=y.child;if(A!==null)A.return=y;else for(A=y;A!==null;){if(A===s){A=null;break}if(y=A.sibling,y!==null){y.return=A.return,A=y;break}A=A.return}y=A}}function Ca(s,o,u,d){s=null;for(var y=o,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var A=y.alternate;if(A===null)throw Error(i(387));if(A=A.memoizedProps,A!==null){var b=y.type;kn(y.pendingProps.value,A.value)||(s!==null?s.push(b):s=[b])}}else if(y===$e.current){if(A=y.alternate,A===null)throw Error(i(387));A.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(ju):s=[ju])}y=y.return}s!==null&&Jp(o,s,u,d),o.flags|=262144}function Od(s){for(s=s.firstContext;s!==null;){if(!kn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function yo(s){go=s,hs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function rn(s){return Qv(go,s)}function Fd(s,o){return go===null&&yo(s),Qv(s,o)}function Qv(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},hs===null){if(s===null)throw Error(i(308));hs=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else hs=hs.next=o;return u}var w1=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,d){s.push(d)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},C1=n.unstable_scheduleCallback,b1=n.unstable_NormalPriority,Ft={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $p(){return{controller:new w1,data:new Map,refCount:0}}function Iu(s){s.refCount--,s.refCount===0&&C1(b1,function(){s.controller.abort()})}var wu=null,Yp=0,ba=0,Ra=null;function R1(s,o){if(wu===null){var u=wu=[];Yp=0,ba=Xm(),Ra={status:"pending",value:void 0,then:function(d){u.push(d)}}}return Yp++,o.then(jv,jv),o}function jv(){if(--Yp===0&&wu!==null){Ra!==null&&(Ra.status="fulfilled");var s=wu;wu=null,ba=0,Ra=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function x1(s,o){var u=[],d={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){d.status="fulfilled",d.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(d.status="rejected",d.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),d}var Xv=te.S;te.S=function(s,o){VT=gn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&R1(s,o),Xv!==null&&Xv(s,o)};var _o=B(null);function Qp(){var s=_o.current;return s!==null?s:ft.pooledCache}function Bd(s,o){o===null?pe(_o,_o.current):pe(_o,o.pool)}function Wv(){var s=Qp();return s===null?null:{parent:Ft._currentValue,pool:s}}var xa=Error(i(460)),jp=Error(i(474)),Gd=Error(i(542)),qd={then:function(){}};function Zv(s){return s=s.status,s==="fulfilled"||s==="rejected"}function e0(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(mi,mi),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,n0(s),s;default:if(typeof o.status=="string")o.then(mi,mi);else{if(s=ft,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(d){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=d}},function(d){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,n0(s),s}throw To=o,xa}}function vo(s){try{var o=s._init;return o(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(To=u,xa):u}}var To=null;function t0(){if(To===null)throw Error(i(459));var s=To;return To=null,s}function n0(s){if(s===xa||s===Gd)throw Error(i(483))}var Na=null,Cu=0;function zd(s){var o=Cu;return Cu+=1,Na===null&&(Na=[]),e0(Na,s,o)}function bu(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Hd(s,o){throw o.$$typeof===E?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function i0(s){function o(H,F){if(s){var Y=H.deletions;Y===null?(H.deletions=[F],H.flags|=16):Y.push(F)}}function u(H,F){if(!s)return null;for(;F!==null;)o(H,F),F=F.sibling;return null}function d(H){for(var F=new Map;H!==null;)H.key!==null?F.set(H.key,H):F.set(H.index,H),H=H.sibling;return F}function y(H,F){return H=ds(H,F),H.index=0,H.sibling=null,H}function v(H,F,Y){return H.index=Y,s?(Y=H.alternate,Y!==null?(Y=Y.index,Y<F?(H.flags|=67108866,F):Y):(H.flags|=67108866,F)):(H.flags|=1048576,F)}function A(H){return s&&H.alternate===null&&(H.flags|=67108866),H}function b(H,F,Y,se){return F===null||F.tag!==6?(F=Op(Y,H.mode,se),F.return=H,F):(F=y(F,Y),F.return=H,F)}function O(H,F,Y,se){var Ie=Y.type;return Ie===P?ne(H,F,Y.props.children,se,Y.key):F!==null&&(F.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===M&&vo(Ie)===F.type)?(F=y(F,Y.props),bu(F,Y),F.return=H,F):(F=Ld(Y.type,Y.key,Y.props,null,H.mode,se),bu(F,Y),F.return=H,F)}function Q(H,F,Y,se){return F===null||F.tag!==4||F.stateNode.containerInfo!==Y.containerInfo||F.stateNode.implementation!==Y.implementation?(F=Fp(Y,H.mode,se),F.return=H,F):(F=y(F,Y.children||[]),F.return=H,F)}function ne(H,F,Y,se,Ie){return F===null||F.tag!==7?(F=po(Y,H.mode,se,Ie),F.return=H,F):(F=y(F,Y),F.return=H,F)}function re(H,F,Y){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Op(""+F,H.mode,Y),F.return=H,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case C:return Y=Ld(F.type,F.key,F.props,null,H.mode,Y),bu(Y,F),Y.return=H,Y;case x:return F=Fp(F,H.mode,Y),F.return=H,F;case M:return F=vo(F),re(H,F,Y)}if(ht(F)||G(F))return F=po(F,H.mode,Y,null),F.return=H,F;if(typeof F.then=="function")return re(H,zd(F),Y);if(F.$$typeof===q)return re(H,Fd(H,F),Y);Hd(H,F)}return null}function j(H,F,Y,se){var Ie=F!==null?F.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ie!==null?null:b(H,F,""+Y,se);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:return Y.key===Ie?O(H,F,Y,se):null;case x:return Y.key===Ie?Q(H,F,Y,se):null;case M:return Y=vo(Y),j(H,F,Y,se)}if(ht(Y)||G(Y))return Ie!==null?null:ne(H,F,Y,se,null);if(typeof Y.then=="function")return j(H,F,zd(Y),se);if(Y.$$typeof===q)return j(H,F,Fd(H,Y),se);Hd(H,Y)}return null}function Z(H,F,Y,se,Ie){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return H=H.get(Y)||null,b(F,H,""+se,Ie);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case C:return H=H.get(se.key===null?Y:se.key)||null,O(F,H,se,Ie);case x:return H=H.get(se.key===null?Y:se.key)||null,Q(F,H,se,Ie);case M:return se=vo(se),Z(H,F,Y,se,Ie)}if(ht(se)||G(se))return H=H.get(Y)||null,ne(F,H,se,Ie,null);if(typeof se.then=="function")return Z(H,F,Y,zd(se),Ie);if(se.$$typeof===q)return Z(H,F,Y,Fd(F,se),Ie);Hd(F,se)}return null}function ve(H,F,Y,se){for(var Ie=null,Qe=null,Se=F,Ue=F=0,ze=null;Se!==null&&Ue<Y.length;Ue++){Se.index>Ue?(ze=Se,Se=null):ze=Se.sibling;var je=j(H,Se,Y[Ue],se);if(je===null){Se===null&&(Se=ze);break}s&&Se&&je.alternate===null&&o(H,Se),F=v(je,F,Ue),Qe===null?Ie=je:Qe.sibling=je,Qe=je,Se=ze}if(Ue===Y.length)return u(H,Se),Je&&fs(H,Ue),Ie;if(Se===null){for(;Ue<Y.length;Ue++)Se=re(H,Y[Ue],se),Se!==null&&(F=v(Se,F,Ue),Qe===null?Ie=Se:Qe.sibling=Se,Qe=Se);return Je&&fs(H,Ue),Ie}for(Se=d(Se);Ue<Y.length;Ue++)ze=Z(Se,H,Ue,Y[Ue],se),ze!==null&&(s&&ze.alternate!==null&&Se.delete(ze.key===null?Ue:ze.key),F=v(ze,F,Ue),Qe===null?Ie=ze:Qe.sibling=ze,Qe=ze);return s&&Se.forEach(function(Er){return o(H,Er)}),Je&&fs(H,Ue),Ie}function Ce(H,F,Y,se){if(Y==null)throw Error(i(151));for(var Ie=null,Qe=null,Se=F,Ue=F=0,ze=null,je=Y.next();Se!==null&&!je.done;Ue++,je=Y.next()){Se.index>Ue?(ze=Se,Se=null):ze=Se.sibling;var Er=j(H,Se,je.value,se);if(Er===null){Se===null&&(Se=ze);break}s&&Se&&Er.alternate===null&&o(H,Se),F=v(Er,F,Ue),Qe===null?Ie=Er:Qe.sibling=Er,Qe=Er,Se=ze}if(je.done)return u(H,Se),Je&&fs(H,Ue),Ie;if(Se===null){for(;!je.done;Ue++,je=Y.next())je=re(H,je.value,se),je!==null&&(F=v(je,F,Ue),Qe===null?Ie=je:Qe.sibling=je,Qe=je);return Je&&fs(H,Ue),Ie}for(Se=d(Se);!je.done;Ue++,je=Y.next())je=Z(Se,H,Ue,je.value,se),je!==null&&(s&&je.alternate!==null&&Se.delete(je.key===null?Ue:je.key),F=v(je,F,Ue),Qe===null?Ie=je:Qe.sibling=je,Qe=je);return s&&Se.forEach(function(BN){return o(H,BN)}),Je&&fs(H,Ue),Ie}function dt(H,F,Y,se){if(typeof Y=="object"&&Y!==null&&Y.type===P&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:e:{for(var Ie=Y.key;F!==null;){if(F.key===Ie){if(Ie=Y.type,Ie===P){if(F.tag===7){u(H,F.sibling),se=y(F,Y.props.children),se.return=H,H=se;break e}}else if(F.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===M&&vo(Ie)===F.type){u(H,F.sibling),se=y(F,Y.props),bu(se,Y),se.return=H,H=se;break e}u(H,F);break}else o(H,F);F=F.sibling}Y.type===P?(se=po(Y.props.children,H.mode,se,Y.key),se.return=H,H=se):(se=Ld(Y.type,Y.key,Y.props,null,H.mode,se),bu(se,Y),se.return=H,H=se)}return A(H);case x:e:{for(Ie=Y.key;F!==null;){if(F.key===Ie)if(F.tag===4&&F.stateNode.containerInfo===Y.containerInfo&&F.stateNode.implementation===Y.implementation){u(H,F.sibling),se=y(F,Y.children||[]),se.return=H,H=se;break e}else{u(H,F);break}else o(H,F);F=F.sibling}se=Fp(Y,H.mode,se),se.return=H,H=se}return A(H);case M:return Y=vo(Y),dt(H,F,Y,se)}if(ht(Y))return ve(H,F,Y,se);if(G(Y)){if(Ie=G(Y),typeof Ie!="function")throw Error(i(150));return Y=Ie.call(Y),Ce(H,F,Y,se)}if(typeof Y.then=="function")return dt(H,F,zd(Y),se);if(Y.$$typeof===q)return dt(H,F,Fd(H,Y),se);Hd(H,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,F!==null&&F.tag===6?(u(H,F.sibling),se=y(F,Y),se.return=H,H=se):(u(H,F),se=Op(Y,H.mode,se),se.return=H,H=se),A(H)):u(H,F)}return function(H,F,Y,se){try{Cu=0;var Ie=dt(H,F,Y,se);return Na=null,Ie}catch(Se){if(Se===xa||Se===Gd)throw Se;var Qe=Ln(29,Se,null,H.mode);return Qe.lanes=se,Qe.return=H,Qe}finally{}}}var Eo=i0(!0),s0=i0(!1),sr=!1;function Xp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wp(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function rr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function or(s,o,u){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Ze&2)!==0){var y=d.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),d.pending=o,o=kd(s),Gv(s,null,u),o}return Vd(s,d,o,u),kd(s)}function Ru(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var d=o.lanes;d&=s.pendingLanes,u|=d,o.lanes=u,tu(s,u)}}function Zp(s,o){var u=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var y=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};v===null?y=v=A:v=v.next=A,u=u.next}while(u!==null);v===null?y=v=o:v=v.next=o}else y=v=o;u={baseState:d.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var em=!1;function xu(){if(em){var s=Ra;if(s!==null)throw s}}function Nu(s,o,u,d){em=!1;var y=s.updateQueue;sr=!1;var v=y.firstBaseUpdate,A=y.lastBaseUpdate,b=y.shared.pending;if(b!==null){y.shared.pending=null;var O=b,Q=O.next;O.next=null,A===null?v=Q:A.next=Q,A=O;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,b=ne.lastBaseUpdate,b!==A&&(b===null?ne.firstBaseUpdate=Q:b.next=Q,ne.lastBaseUpdate=O))}if(v!==null){var re=y.baseState;A=0,ne=Q=O=null,b=v;do{var j=b.lane&-536870913,Z=j!==b.lane;if(Z?(qe&j)===j:(d&j)===j){j!==0&&j===ba&&(em=!0),ne!==null&&(ne=ne.next={lane:0,tag:b.tag,payload:b.payload,callback:null,next:null});e:{var ve=s,Ce=b;j=o;var dt=u;switch(Ce.tag){case 1:if(ve=Ce.payload,typeof ve=="function"){re=ve.call(dt,re,j);break e}re=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Ce.payload,j=typeof ve=="function"?ve.call(dt,re,j):ve,j==null)break e;re=T({},re,j);break e;case 2:sr=!0}}j=b.callback,j!==null&&(s.flags|=64,Z&&(s.flags|=8192),Z=y.callbacks,Z===null?y.callbacks=[j]:Z.push(j))}else Z={lane:j,tag:b.tag,payload:b.payload,callback:b.callback,next:null},ne===null?(Q=ne=Z,O=re):ne=ne.next=Z,A|=j;if(b=b.next,b===null){if(b=y.shared.pending,b===null)break;Z=b,b=Z.next,Z.next=null,y.lastBaseUpdate=Z,y.shared.pending=null}}while(!0);ne===null&&(O=re),y.baseState=O,y.firstBaseUpdate=Q,y.lastBaseUpdate=ne,v===null&&(y.shared.lanes=0),dr|=A,s.lanes=A,s.memoizedState=re}}function r0(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function o0(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)r0(u[s],o)}var Ma=B(null),Kd=B(0);function a0(s,o){s=As,pe(Kd,s),pe(Ma,o),As=s|o.baseLanes}function tm(){pe(Kd,As),pe(Ma,Ma.current)}function nm(){As=Kd.current,oe(Ma),oe(Kd)}var Un=B(null),ii=null;function ar(s){var o=s.alternate;pe(xt,xt.current&1),pe(Un,s),ii===null&&(o===null||Ma.current!==null||o.memoizedState!==null)&&(ii=s)}function im(s){pe(xt,xt.current),pe(Un,s),ii===null&&(ii=s)}function l0(s){s.tag===22?(pe(xt,xt.current),pe(Un,s),ii===null&&(ii=s)):lr()}function lr(){pe(xt,xt.current),pe(Un,Un.current)}function On(s){oe(Un),ii===s&&(ii=null),oe(xt)}var xt=B(0);function Jd(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ug(u)||cg(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ms=0,Ve=null,ut=null,Bt=null,$d=!1,Da=!1,So=!1,Yd=0,Mu=0,Pa=null,N1=0;function At(){throw Error(i(321))}function sm(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!kn(s[u],o[u]))return!1;return!0}function rm(s,o,u,d,y,v){return ms=v,Ve=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,te.H=s===null||s.memoizedState===null?K0:Tm,So=!1,v=u(d,y),So=!1,Da&&(v=c0(o,u,d,y)),u0(s),v}function u0(s){te.H=Vu;var o=ut!==null&&ut.next!==null;if(ms=0,Bt=ut=Ve=null,$d=!1,Mu=0,Pa=null,o)throw Error(i(300));s===null||Gt||(s=s.dependencies,s!==null&&Od(s)&&(Gt=!0))}function c0(s,o,u,d){Ve=s;var y=0;do{if(Da&&(Pa=null),Mu=0,Da=!1,25<=y)throw Error(i(301));if(y+=1,Bt=ut=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}te.H=J0,v=o(u,d)}while(Da);return v}function M1(){var s=te.H,o=s.useState()[0];return o=typeof o.then=="function"?Du(o):o,s=s.useState()[0],(ut!==null?ut.memoizedState:null)!==s&&(Ve.flags|=1024),o}function om(){var s=Yd!==0;return Yd=0,s}function am(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function lm(s){if($d){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}$d=!1}ms=0,Bt=ut=Ve=null,Da=!1,Mu=Yd=0,Pa=null}function _n(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?Ve.memoizedState=Bt=s:Bt=Bt.next=s,Bt}function Nt(){if(ut===null){var s=Ve.alternate;s=s!==null?s.memoizedState:null}else s=ut.next;var o=Bt===null?Ve.memoizedState:Bt.next;if(o!==null)Bt=o,ut=s;else{if(s===null)throw Ve.alternate===null?Error(i(467)):Error(i(310));ut=s,s={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Bt===null?Ve.memoizedState=Bt=s:Bt=Bt.next=s}return Bt}function Qd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Du(s){var o=Mu;return Mu+=1,Pa===null&&(Pa=[]),s=e0(Pa,s,o),o=Ve,(Bt===null?o.memoizedState:Bt.next)===null&&(o=o.alternate,te.H=o===null||o.memoizedState===null?K0:Tm),s}function jd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Du(s);if(s.$$typeof===q)return rn(s)}throw Error(i(438,String(s)))}function um(s){var o=null,u=Ve.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var d=Ve.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Qd(),Ve.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),d=0;d<s;d++)u[d]=L;return o.index++,u}function gs(s,o){return typeof o=="function"?o(s):o}function Xd(s){var o=Nt();return cm(o,ut,s)}function cm(s,o,u){var d=s.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=u;var y=s.baseQueue,v=d.pending;if(v!==null){if(y!==null){var A=y.next;y.next=v.next,v.next=A}o.baseQueue=y=v,d.pending=null}if(v=s.baseState,y===null)s.memoizedState=v;else{o=y.next;var b=A=null,O=null,Q=o,ne=!1;do{var re=Q.lane&-536870913;if(re!==Q.lane?(qe&re)===re:(ms&re)===re){var j=Q.revertLane;if(j===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),re===ba&&(ne=!0);else if((ms&j)===j){Q=Q.next,j===ba&&(ne=!0);continue}else re={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(b=O=re,A=v):O=O.next=re,Ve.lanes|=j,dr|=j;re=Q.action,So&&u(v,re),v=Q.hasEagerState?Q.eagerState:u(v,re)}else j={lane:re,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},O===null?(b=O=j,A=v):O=O.next=j,Ve.lanes|=re,dr|=re;Q=Q.next}while(Q!==null&&Q!==o);if(O===null?A=v:O.next=b,!kn(v,s.memoizedState)&&(Gt=!0,ne&&(u=Ra,u!==null)))throw u;s.memoizedState=v,s.baseState=A,s.baseQueue=O,d.lastRenderedState=v}return y===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function dm(s){var o=Nt(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var d=u.dispatch,y=u.pending,v=o.memoizedState;if(y!==null){u.pending=null;var A=y=y.next;do v=s(v,A.action),A=A.next;while(A!==y);kn(v,o.memoizedState)||(Gt=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),u.lastRenderedState=v}return[v,d]}function d0(s,o,u){var d=Ve,y=Nt(),v=Je;if(v){if(u===void 0)throw Error(i(407));u=u()}else u=o();var A=!kn((ut||y).memoizedState,u);if(A&&(y.memoizedState=u,Gt=!0),y=y.queue,pm(p0.bind(null,d,y,s),[s]),y.getSnapshot!==o||A||Bt!==null&&Bt.memoizedState.tag&1){if(d.flags|=2048,Va(9,{destroy:void 0},h0.bind(null,d,y,u,o),null),ft===null)throw Error(i(349));v||(ms&127)!==0||f0(d,o,u)}return u}function f0(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Ve.updateQueue,o===null?(o=Qd(),Ve.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function h0(s,o,u,d){o.value=u,o.getSnapshot=d,m0(o)&&g0(s)}function p0(s,o,u){return u(function(){m0(o)&&g0(s)})}function m0(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!kn(s,u)}catch{return!0}}function g0(s){var o=ho(s,2);o!==null&&xn(o,s,2)}function fm(s){var o=_n();if(typeof s=="function"){var u=s;if(s=u(),So){$n(!0);try{u()}finally{$n(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:s},o}function y0(s,o,u,d){return s.baseState=u,cm(s,ut,typeof d=="function"?d:gs)}function D1(s,o,u,d,y){if(ef(s))throw Error(i(485));if(s=o.action,s!==null){var v={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){v.listeners.push(A)}};te.T!==null?u(!0):v.isTransition=!1,d(v),u=o.pending,u===null?(v.next=o.pending=v,_0(o,v)):(v.next=u.next,o.pending=u.next=v)}}function _0(s,o){var u=o.action,d=o.payload,y=s.state;if(o.isTransition){var v=te.T,A={};te.T=A;try{var b=u(y,d),O=te.S;O!==null&&O(A,b),v0(s,o,b)}catch(Q){hm(s,o,Q)}finally{v!==null&&A.types!==null&&(v.types=A.types),te.T=v}}else try{v=u(y,d),v0(s,o,v)}catch(Q){hm(s,o,Q)}}function v0(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(d){T0(s,o,d)},function(d){return hm(s,o,d)}):T0(s,o,u)}function T0(s,o,u){o.status="fulfilled",o.value=u,E0(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,_0(s,u)))}function hm(s,o,u){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=u,E0(o),o=o.next;while(o!==d)}s.action=null}function E0(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function S0(s,o){return o}function A0(s,o){if(Je){var u=ft.formState;if(u!==null){e:{var d=Ve;if(Je){if(mt){t:{for(var y=mt,v=ni;y.nodeType!==8;){if(!v){y=null;break t}if(y=si(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){mt=si(y.nextSibling),d=y.data==="F!";break e}}nr(d)}d=!1}d&&(o=u[0])}}return u=_n(),u.memoizedState=u.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S0,lastRenderedState:o},u.queue=d,u=q0.bind(null,Ve,d),d.dispatch=u,d=fm(!1),v=vm.bind(null,Ve,!1,d.queue),d=_n(),y={state:o,dispatch:null,action:s,pending:null},d.queue=y,u=D1.bind(null,Ve,y,v,u),y.dispatch=u,d.memoizedState=s,[o,u,!1]}function I0(s){var o=Nt();return w0(o,ut,s)}function w0(s,o,u){if(o=cm(s,o,S0)[0],s=Xd(gs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=Du(o)}catch(A){throw A===xa?Gd:A}else d=o;o=Nt();var y=o.queue,v=y.dispatch;return u!==o.memoizedState&&(Ve.flags|=2048,Va(9,{destroy:void 0},P1.bind(null,y,u),null)),[d,v,s]}function P1(s,o){s.action=o}function C0(s){var o=Nt(),u=ut;if(u!==null)return w0(o,u,s);Nt(),o=o.memoizedState,u=Nt();var d=u.queue.dispatch;return u.memoizedState=s,[o,d,!1]}function Va(s,o,u,d){return s={tag:s,create:u,deps:d,inst:o,next:null},o=Ve.updateQueue,o===null&&(o=Qd(),Ve.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(d=u.next,u.next=s,s.next=d,o.lastEffect=s),s}function b0(){return Nt().memoizedState}function Wd(s,o,u,d){var y=_n();Ve.flags|=s,y.memoizedState=Va(1|o,{destroy:void 0},u,d===void 0?null:d)}function Zd(s,o,u,d){var y=Nt();d=d===void 0?null:d;var v=y.memoizedState.inst;ut!==null&&d!==null&&sm(d,ut.memoizedState.deps)?y.memoizedState=Va(o,v,u,d):(Ve.flags|=s,y.memoizedState=Va(1|o,v,u,d))}function R0(s,o){Wd(8390656,8,s,o)}function pm(s,o){Zd(2048,8,s,o)}function V1(s){Ve.flags|=4;var o=Ve.updateQueue;if(o===null)o=Qd(),Ve.updateQueue=o,o.events=[s];else{var u=o.events;u===null?o.events=[s]:u.push(s)}}function x0(s){var o=Nt().memoizedState;return V1({ref:o,nextImpl:s}),function(){if((Ze&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function N0(s,o){return Zd(4,2,s,o)}function M0(s,o){return Zd(4,4,s,o)}function D0(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function P0(s,o,u){u=u!=null?u.concat([s]):null,Zd(4,4,D0.bind(null,o,s),u)}function mm(){}function V0(s,o){var u=Nt();o=o===void 0?null:o;var d=u.memoizedState;return o!==null&&sm(o,d[1])?d[0]:(u.memoizedState=[s,o],s)}function k0(s,o){var u=Nt();o=o===void 0?null:o;var d=u.memoizedState;if(o!==null&&sm(o,d[1]))return d[0];if(d=s(),So){$n(!0);try{s()}finally{$n(!1)}}return u.memoizedState=[d,o],d}function gm(s,o,u){return u===void 0||(ms&1073741824)!==0&&(qe&261930)===0?s.memoizedState=o:(s.memoizedState=u,s=LT(),Ve.lanes|=s,dr|=s,u)}function L0(s,o,u,d){return kn(u,o)?u:Ma.current!==null?(s=gm(s,u,d),kn(s,o)||(Gt=!0),s):(ms&42)===0||(ms&1073741824)!==0&&(qe&261930)===0?(Gt=!0,s.memoizedState=u):(s=LT(),Ve.lanes|=s,dr|=s,o)}function U0(s,o,u,d,y){var v=fe.p;fe.p=v!==0&&8>v?v:8;var A=te.T,b={};te.T=b,vm(s,!1,o,u);try{var O=y(),Q=te.S;if(Q!==null&&Q(b,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var ne=x1(O,d);Pu(s,o,ne,Gn(s))}else Pu(s,o,d,Gn(s))}catch(re){Pu(s,o,{then:function(){},status:"rejected",reason:re},Gn())}finally{fe.p=v,A!==null&&b.types!==null&&(A.types=b.types),te.T=A}}function k1(){}function ym(s,o,u,d){if(s.tag!==5)throw Error(i(476));var y=O0(s).queue;U0(s,y,o,Te,u===null?k1:function(){return F0(s),u(d)})}function O0(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:Te},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function F0(s){var o=O0(s);o.next===null&&(o=s.alternate.memoizedState),Pu(s,o.next.queue,{},Gn())}function _m(){return rn(ju)}function B0(){return Nt().memoizedState}function G0(){return Nt().memoizedState}function L1(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Gn();s=rr(u);var d=or(o,s,u);d!==null&&(xn(d,o,u),Ru(d,o,u)),o={cache:$p()},s.payload=o;return}o=o.return}}function U1(s,o,u){var d=Gn();u={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ef(s)?z0(o,u):(u=Lp(s,o,u,d),u!==null&&(xn(u,s,d),H0(u,o,d)))}function q0(s,o,u){var d=Gn();Pu(s,o,u,d)}function Pu(s,o,u,d){var y={lane:d,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(ef(s))z0(o,y);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var A=o.lastRenderedState,b=v(A,u);if(y.hasEagerState=!0,y.eagerState=b,kn(b,A))return Vd(s,o,y,0),ft===null&&Pd(),!1}catch{}finally{}if(u=Lp(s,o,y,d),u!==null)return xn(u,s,d),H0(u,o,d),!0}return!1}function vm(s,o,u,d){if(d={lane:2,revertLane:Xm(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},ef(s)){if(o)throw Error(i(479))}else o=Lp(s,u,d,2),o!==null&&xn(o,s,2)}function ef(s){var o=s.alternate;return s===Ve||o!==null&&o===Ve}function z0(s,o){Da=$d=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function H0(s,o,u){if((u&4194048)!==0){var d=o.lanes;d&=s.pendingLanes,u|=d,o.lanes=u,tu(s,u)}}var Vu={readContext:rn,use:jd,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useLayoutEffect:At,useInsertionEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useSyncExternalStore:At,useId:At,useHostTransitionStatus:At,useFormState:At,useActionState:At,useOptimistic:At,useMemoCache:At,useCacheRefresh:At};Vu.useEffectEvent=At;var K0={readContext:rn,use:jd,useCallback:function(s,o){return _n().memoizedState=[s,o===void 0?null:o],s},useContext:rn,useEffect:R0,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Wd(4194308,4,D0.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Wd(4194308,4,s,o)},useInsertionEffect:function(s,o){Wd(4,2,s,o)},useMemo:function(s,o){var u=_n();o=o===void 0?null:o;var d=s();if(So){$n(!0);try{s()}finally{$n(!1)}}return u.memoizedState=[d,o],d},useReducer:function(s,o,u){var d=_n();if(u!==void 0){var y=u(o);if(So){$n(!0);try{u(o)}finally{$n(!1)}}}else y=o;return d.memoizedState=d.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},d.queue=s,s=s.dispatch=U1.bind(null,Ve,s),[d.memoizedState,s]},useRef:function(s){var o=_n();return s={current:s},o.memoizedState=s},useState:function(s){s=fm(s);var o=s.queue,u=q0.bind(null,Ve,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:mm,useDeferredValue:function(s,o){var u=_n();return gm(u,s,o)},useTransition:function(){var s=fm(!1);return s=U0.bind(null,Ve,s.queue,!0,!1),_n().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var d=Ve,y=_n();if(Je){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),ft===null)throw Error(i(349));(qe&127)!==0||f0(d,o,u)}y.memoizedState=u;var v={value:u,getSnapshot:o};return y.queue=v,R0(p0.bind(null,d,v,s),[s]),d.flags|=2048,Va(9,{destroy:void 0},h0.bind(null,d,v,u,o),null),u},useId:function(){var s=_n(),o=ft.identifierPrefix;if(Je){var u=ji,d=Qi;u=(d&~(1<<32-bt(d)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Yd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=N1++,o="_"+o+"r_"+u.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:_m,useFormState:A0,useActionState:A0,useOptimistic:function(s){var o=_n();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=vm.bind(null,Ve,!0,u),u.dispatch=o,[s,o]},useMemoCache:um,useCacheRefresh:function(){return _n().memoizedState=L1.bind(null,Ve)},useEffectEvent:function(s){var o=_n(),u={impl:s};return o.memoizedState=u,function(){if((Ze&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},Tm={readContext:rn,use:jd,useCallback:V0,useContext:rn,useEffect:pm,useImperativeHandle:P0,useInsertionEffect:N0,useLayoutEffect:M0,useMemo:k0,useReducer:Xd,useRef:b0,useState:function(){return Xd(gs)},useDebugValue:mm,useDeferredValue:function(s,o){var u=Nt();return L0(u,ut.memoizedState,s,o)},useTransition:function(){var s=Xd(gs)[0],o=Nt().memoizedState;return[typeof s=="boolean"?s:Du(s),o]},useSyncExternalStore:d0,useId:B0,useHostTransitionStatus:_m,useFormState:I0,useActionState:I0,useOptimistic:function(s,o){var u=Nt();return y0(u,ut,s,o)},useMemoCache:um,useCacheRefresh:G0};Tm.useEffectEvent=x0;var J0={readContext:rn,use:jd,useCallback:V0,useContext:rn,useEffect:pm,useImperativeHandle:P0,useInsertionEffect:N0,useLayoutEffect:M0,useMemo:k0,useReducer:dm,useRef:b0,useState:function(){return dm(gs)},useDebugValue:mm,useDeferredValue:function(s,o){var u=Nt();return ut===null?gm(u,s,o):L0(u,ut.memoizedState,s,o)},useTransition:function(){var s=dm(gs)[0],o=Nt().memoizedState;return[typeof s=="boolean"?s:Du(s),o]},useSyncExternalStore:d0,useId:B0,useHostTransitionStatus:_m,useFormState:C0,useActionState:C0,useOptimistic:function(s,o){var u=Nt();return ut!==null?y0(u,ut,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:um,useCacheRefresh:G0};J0.useEffectEvent=x0;function Em(s,o,u,d){o=s.memoizedState,u=u(d,o),u=u==null?o:T({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Sm={enqueueSetState:function(s,o,u){s=s._reactInternals;var d=Gn(),y=rr(d);y.payload=o,u!=null&&(y.callback=u),o=or(s,y,d),o!==null&&(xn(o,s,d),Ru(o,s,d))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var d=Gn(),y=rr(d);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=or(s,y,d),o!==null&&(xn(o,s,d),Ru(o,s,d))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Gn(),d=rr(u);d.tag=2,o!=null&&(d.callback=o),o=or(s,d,u),o!==null&&(xn(o,s,u),Ru(o,s,u))}};function $0(s,o,u,d,y,v,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,v,A):o.prototype&&o.prototype.isPureReactComponent?!Tu(u,d)||!Tu(y,v):!0}function Y0(s,o,u,d){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,d),o.state!==s&&Sm.enqueueReplaceState(o,o.state,null)}function Ao(s,o){var u=o;if("ref"in o){u={};for(var d in o)d!=="ref"&&(u[d]=o[d])}if(s=s.defaultProps){u===o&&(u=T({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}function Q0(s){Dd(s)}function j0(s){console.error(s)}function X0(s){Dd(s)}function tf(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function W0(s,o,u){try{var d=s.onCaughtError;d(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Am(s,o,u){return u=rr(u),u.tag=3,u.payload={element:null},u.callback=function(){tf(s,o)},u}function Z0(s){return s=rr(s),s.tag=3,s}function eT(s,o,u,d){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var v=d.value;s.payload=function(){return y(v)},s.callback=function(){W0(o,u,d)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(s.callback=function(){W0(o,u,d),typeof y!="function"&&(fr===null?fr=new Set([this]):fr.add(this));var b=d.stack;this.componentDidCatch(d.value,{componentStack:b!==null?b:""})})}function O1(s,o,u,d,y){if(u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=u.alternate,o!==null&&Ca(o,u,y,!0),u=Un.current,u!==null){switch(u.tag){case 31:case 13:return ii===null?pf():u.alternate===null&&It===0&&(It=3),u.flags&=-257,u.flags|=65536,u.lanes=y,d===qd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([d]):o.add(d),Ym(s,d,y)),!1;case 22:return u.flags|=65536,d===qd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([d]):u.add(d)),Ym(s,d,y)),!1}throw Error(i(435,u.tag))}return Ym(s,d,y),pf(),!1}if(Je)return o=Un.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,d!==qp&&(s=Error(i(422),{cause:d}),Au(Zn(s,u)))):(d!==qp&&(o=Error(i(423),{cause:d}),Au(Zn(o,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,d=Zn(d,u),y=Am(s.stateNode,d,y),Zp(s,y),It!==4&&(It=2)),!1;var v=Error(i(520),{cause:d});if(v=Zn(v,u),qu===null?qu=[v]:qu.push(v),It!==4&&(It=2),o===null)return!0;d=Zn(d,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=Am(u.stateNode,d,s),Zp(u,s),!1;case 1:if(o=u.type,v=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(fr===null||!fr.has(v))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Z0(y),eT(y,s,u,d),Zp(u,y),!1}u=u.return}while(u!==null);return!1}var Im=Error(i(461)),Gt=!1;function on(s,o,u,d){o.child=s===null?s0(o,null,u,d):Eo(o,s.child,u,d)}function tT(s,o,u,d,y){u=u.render;var v=o.ref;if("ref"in d){var A={};for(var b in d)b!=="ref"&&(A[b]=d[b])}else A=d;return yo(o),d=rm(s,o,u,A,v,y),b=om(),s!==null&&!Gt?(am(s,o,y),ys(s,o,y)):(Je&&b&&Bp(o),o.flags|=1,on(s,o,d,y),o.child)}function nT(s,o,u,d,y){if(s===null){var v=u.type;return typeof v=="function"&&!Up(v)&&v.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=v,iT(s,o,v,d,y)):(s=Ld(u.type,null,d,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(v=s.child,!Dm(s,y)){var A=v.memoizedProps;if(u=u.compare,u=u!==null?u:Tu,u(A,d)&&s.ref===o.ref)return ys(s,o,y)}return o.flags|=1,s=ds(v,d),s.ref=o.ref,s.return=o,o.child=s}function iT(s,o,u,d,y){if(s!==null){var v=s.memoizedProps;if(Tu(v,d)&&s.ref===o.ref)if(Gt=!1,o.pendingProps=d=v,Dm(s,y))(s.flags&131072)!==0&&(Gt=!0);else return o.lanes=s.lanes,ys(s,o,y)}return wm(s,o,u,d,y)}function sT(s,o,u,d){var y=d.children,v=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((o.flags&128)!==0){if(v=v!==null?v.baseLanes|u:u,s!==null){for(d=o.child=s.child,y=0;d!==null;)y=y|d.lanes|d.childLanes,d=d.sibling;d=y&~v}else d=0,o.child=null;return rT(s,o,v,u,d)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Bd(o,v!==null?v.cachePool:null),v!==null?a0(o,v):tm(),l0(o);else return d=o.lanes=536870912,rT(s,o,v!==null?v.baseLanes|u:u,u,d)}else v!==null?(Bd(o,v.cachePool),a0(o,v),lr(),o.memoizedState=null):(s!==null&&Bd(o,null),tm(),lr());return on(s,o,y,u),o.child}function ku(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function rT(s,o,u,d,y){var v=Qp();return v=v===null?null:{parent:Ft._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},s!==null&&Bd(o,null),tm(),l0(o),s!==null&&Ca(s,o,d,!0),o.childLanes=y,null}function nf(s,o){return o=rf({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function oT(s,o,u){return Eo(o,s.child,null,u),s=nf(o,o.pendingProps),s.flags|=2,On(o),o.memoizedState=null,s}function F1(s,o,u){var d=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(Je){if(d.mode==="hidden")return s=nf(o,d),o.lanes=536870912,ku(null,s);if(im(o),(s=mt)?(s=_E(s,ni),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:er!==null?{id:Qi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=zv(s),u.return=o,o.child=u,sn=o,mt=null)):s=null,s===null)throw nr(o);return o.lanes=536870912,null}return nf(o,d)}var v=s.memoizedState;if(v!==null){var A=v.dehydrated;if(im(o),y)if(o.flags&256)o.flags&=-257,o=oT(s,o,u);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(Gt||Ca(s,o,u,!1),y=(u&s.childLanes)!==0,Gt||y){if(d=ft,d!==null&&(A=nu(d,u),A!==0&&A!==v.retryLane))throw v.retryLane=A,ho(s,A),xn(d,s,A),Im;pf(),o=oT(s,o,u)}else s=v.treeContext,mt=si(A.nextSibling),sn=o,Je=!0,tr=null,ni=!1,s!==null&&Jv(o,s),o=nf(o,d),o.flags|=4096;return o}return s=ds(s.child,{mode:d.mode,children:d.children}),s.ref=o.ref,o.child=s,s.return=o,s}function sf(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function wm(s,o,u,d,y){return yo(o),u=rm(s,o,u,d,void 0,y),d=om(),s!==null&&!Gt?(am(s,o,y),ys(s,o,y)):(Je&&d&&Bp(o),o.flags|=1,on(s,o,u,y),o.child)}function aT(s,o,u,d,y,v){return yo(o),o.updateQueue=null,u=c0(o,d,u,y),u0(s),d=om(),s!==null&&!Gt?(am(s,o,v),ys(s,o,v)):(Je&&d&&Bp(o),o.flags|=1,on(s,o,u,v),o.child)}function lT(s,o,u,d,y){if(yo(o),o.stateNode===null){var v=Sa,A=u.contextType;typeof A=="object"&&A!==null&&(v=rn(A)),v=new u(d,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Sm,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=d,v.state=o.memoizedState,v.refs={},Xp(o),A=u.contextType,v.context=typeof A=="object"&&A!==null?rn(A):Sa,v.state=o.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Em(o,u,A,d),v.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(A=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),A!==v.state&&Sm.enqueueReplaceState(v,v.state,null),Nu(o,d,v,y),xu(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(s===null){v=o.stateNode;var b=o.memoizedProps,O=Ao(u,b);v.props=O;var Q=v.context,ne=u.contextType;A=Sa,typeof ne=="object"&&ne!==null&&(A=rn(ne));var re=u.getDerivedStateFromProps;ne=typeof re=="function"||typeof v.getSnapshotBeforeUpdate=="function",b=o.pendingProps!==b,ne||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b||Q!==A)&&Y0(o,v,d,A),sr=!1;var j=o.memoizedState;v.state=j,Nu(o,d,v,y),xu(),Q=o.memoizedState,b||j!==Q||sr?(typeof re=="function"&&(Em(o,u,re,d),Q=o.memoizedState),(O=sr||$0(o,u,O,d,j,Q,A))?(ne||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=Q),v.props=d,v.state=Q,v.context=A,d=O):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{v=o.stateNode,Wp(s,o),A=o.memoizedProps,ne=Ao(u,A),v.props=ne,re=o.pendingProps,j=v.context,Q=u.contextType,O=Sa,typeof Q=="object"&&Q!==null&&(O=rn(Q)),b=u.getDerivedStateFromProps,(Q=typeof b=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==re||j!==O)&&Y0(o,v,d,O),sr=!1,j=o.memoizedState,v.state=j,Nu(o,d,v,y),xu();var Z=o.memoizedState;A!==re||j!==Z||sr||s!==null&&s.dependencies!==null&&Od(s.dependencies)?(typeof b=="function"&&(Em(o,u,b,d),Z=o.memoizedState),(ne=sr||$0(o,u,ne,d,j,Z,O)||s!==null&&s.dependencies!==null&&Od(s.dependencies))?(Q||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,Z,O),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,Z,O)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===s.memoizedProps&&j===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&j===s.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=Z),v.props=d,v.state=Z,v.context=O,d=ne):(typeof v.componentDidUpdate!="function"||A===s.memoizedProps&&j===s.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===s.memoizedProps&&j===s.memoizedState||(o.flags|=1024),d=!1)}return v=d,sf(s,o),d=(o.flags&128)!==0,v||d?(v=o.stateNode,u=d&&typeof u.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,s!==null&&d?(o.child=Eo(o,s.child,null,y),o.child=Eo(o,null,u,y)):on(s,o,u,y),o.memoizedState=v.state,s=o.child):s=ys(s,o,y),s}function uT(s,o,u,d){return mo(),o.flags|=256,on(s,o,u,d),o.child}var Cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bm(s){return{baseLanes:s,cachePool:Wv()}}function Rm(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=Bn),s}function cT(s,o,u){var d=o.pendingProps,y=!1,v=(o.flags&128)!==0,A;if((A=v)||(A=s!==null&&s.memoizedState===null?!1:(xt.current&2)!==0),A&&(y=!0,o.flags&=-129),A=(o.flags&32)!==0,o.flags&=-33,s===null){if(Je){if(y?ar(o):lr(),(s=mt)?(s=_E(s,ni),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:er!==null?{id:Qi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=zv(s),u.return=o,o.child=u,sn=o,mt=null)):s=null,s===null)throw nr(o);return cg(s)?o.lanes=32:o.lanes=536870912,null}var b=d.children;return d=d.fallback,y?(lr(),y=o.mode,b=rf({mode:"hidden",children:b},y),d=po(d,y,u,null),b.return=o,d.return=o,b.sibling=d,o.child=b,d=o.child,d.memoizedState=bm(u),d.childLanes=Rm(s,A,u),o.memoizedState=Cm,ku(null,d)):(ar(o),xm(o,b))}var O=s.memoizedState;if(O!==null&&(b=O.dehydrated,b!==null)){if(v)o.flags&256?(ar(o),o.flags&=-257,o=Nm(s,o,u)):o.memoizedState!==null?(lr(),o.child=s.child,o.flags|=128,o=null):(lr(),b=d.fallback,y=o.mode,d=rf({mode:"visible",children:d.children},y),b=po(b,y,u,null),b.flags|=2,d.return=o,b.return=o,d.sibling=b,o.child=d,Eo(o,s.child,null,u),d=o.child,d.memoizedState=bm(u),d.childLanes=Rm(s,A,u),o.memoizedState=Cm,o=ku(null,d));else if(ar(o),cg(b)){if(A=b.nextSibling&&b.nextSibling.dataset,A)var Q=A.dgst;A=Q,d=Error(i(419)),d.stack="",d.digest=A,Au({value:d,source:null,stack:null}),o=Nm(s,o,u)}else if(Gt||Ca(s,o,u,!1),A=(u&s.childLanes)!==0,Gt||A){if(A=ft,A!==null&&(d=nu(A,u),d!==0&&d!==O.retryLane))throw O.retryLane=d,ho(s,d),xn(A,s,d),Im;ug(b)||pf(),o=Nm(s,o,u)}else ug(b)?(o.flags|=192,o.child=s.child,o=null):(s=O.treeContext,mt=si(b.nextSibling),sn=o,Je=!0,tr=null,ni=!1,s!==null&&Jv(o,s),o=xm(o,d.children),o.flags|=4096);return o}return y?(lr(),b=d.fallback,y=o.mode,O=s.child,Q=O.sibling,d=ds(O,{mode:"hidden",children:d.children}),d.subtreeFlags=O.subtreeFlags&65011712,Q!==null?b=ds(Q,b):(b=po(b,y,u,null),b.flags|=2),b.return=o,d.return=o,d.sibling=b,o.child=d,ku(null,d),d=o.child,b=s.child.memoizedState,b===null?b=bm(u):(y=b.cachePool,y!==null?(O=Ft._currentValue,y=y.parent!==O?{parent:O,pool:O}:y):y=Wv(),b={baseLanes:b.baseLanes|u,cachePool:y}),d.memoizedState=b,d.childLanes=Rm(s,A,u),o.memoizedState=Cm,ku(s.child,d)):(ar(o),u=s.child,s=u.sibling,u=ds(u,{mode:"visible",children:d.children}),u.return=o,u.sibling=null,s!==null&&(A=o.deletions,A===null?(o.deletions=[s],o.flags|=16):A.push(s)),o.child=u,o.memoizedState=null,u)}function xm(s,o){return o=rf({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function rf(s,o){return s=Ln(22,s,null,o),s.lanes=0,s}function Nm(s,o,u){return Eo(o,s.child,null,u),s=xm(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function dT(s,o,u){s.lanes|=o;var d=s.alternate;d!==null&&(d.lanes|=o),Kp(s.return,o,u)}function Mm(s,o,u,d,y,v){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:y,treeForkCount:v}:(A.isBackwards=o,A.rendering=null,A.renderingStartTime=0,A.last=d,A.tail=u,A.tailMode=y,A.treeForkCount=v)}function fT(s,o,u){var d=o.pendingProps,y=d.revealOrder,v=d.tail;d=d.children;var A=xt.current,b=(A&2)!==0;if(b?(A=A&1|2,o.flags|=128):A&=1,pe(xt,A),on(s,o,d,u),d=Je?Su:0,!b&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&dT(s,u,o);else if(s.tag===19)dT(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)s=u.alternate,s!==null&&Jd(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),Mm(o,!1,y,u,v,d);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&Jd(s)===null){o.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}Mm(o,!0,u,null,v,d);break;case"together":Mm(o,!1,null,null,void 0,d);break;default:o.memoizedState=null}return o.child}function ys(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),dr|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Ca(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,u=ds(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=ds(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function Dm(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Od(s)))}function B1(s,o,u){switch(o.tag){case 3:Kt(o,o.stateNode.containerInfo),ir(o,Ft,s.memoizedState.cache),mo();break;case 27:case 5:Yr(o);break;case 4:Kt(o,o.stateNode.containerInfo);break;case 10:ir(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,im(o),null;break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(ar(o),o.flags|=128,null):(u&o.child.childLanes)!==0?cT(s,o,u):(ar(o),s=ys(s,o,u),s!==null?s.sibling:null);ar(o);break;case 19:var y=(s.flags&128)!==0;if(d=(u&o.childLanes)!==0,d||(Ca(s,o,u,!1),d=(u&o.childLanes)!==0),y){if(d)return fT(s,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),pe(xt,xt.current),d)break;return null;case 22:return o.lanes=0,sT(s,o,u,o.pendingProps);case 24:ir(o,Ft,s.memoizedState.cache)}return ys(s,o,u)}function hT(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)Gt=!0;else{if(!Dm(s,u)&&(o.flags&128)===0)return Gt=!1,B1(s,o,u);Gt=(s.flags&131072)!==0}else Gt=!1,Je&&(o.flags&1048576)!==0&&Kv(o,Su,o.index);switch(o.lanes=0,o.tag){case 16:e:{var d=o.pendingProps;if(s=vo(o.elementType),o.type=s,typeof s=="function")Up(s)?(d=Ao(s,d),o.tag=1,o=lT(null,o,s,d,u)):(o.tag=0,o=wm(null,o,s,d,u));else{if(s!=null){var y=s.$$typeof;if(y===ee){o.tag=11,o=tT(null,o,s,d,u);break e}else if(y===N){o.tag=14,o=nT(null,o,s,d,u);break e}}throw o=ke(s)||s,Error(i(306,o,""))}}return o;case 0:return wm(s,o,o.type,o.pendingProps,u);case 1:return d=o.type,y=Ao(d,o.pendingProps),lT(s,o,d,y,u);case 3:e:{if(Kt(o,o.stateNode.containerInfo),s===null)throw Error(i(387));d=o.pendingProps;var v=o.memoizedState;y=v.element,Wp(s,o),Nu(o,d,null,u);var A=o.memoizedState;if(d=A.cache,ir(o,Ft,d),d!==v.cache&&Jp(o,[Ft],u,!0),xu(),d=A.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:A.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=uT(s,o,d,u);break e}else if(d!==y){y=Zn(Error(i(424)),o),Au(y),o=uT(s,o,d,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mt=si(s.firstChild),sn=o,Je=!0,tr=null,ni=!0,u=s0(o,null,d,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(mo(),d===y){o=ys(s,o,u);break e}on(s,o,d,u)}o=o.child}return o;case 26:return sf(s,o),s===null?(u=IE(o.type,null,o.pendingProps,null))?o.memoizedState=u:Je||(u=o.type,s=o.pendingProps,d=Ef(Le.current).createElement(u),d[Lt]=o,d[jt]=s,an(d,u,s),Ut(d),o.stateNode=d):o.memoizedState=IE(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Yr(o),s===null&&Je&&(d=o.stateNode=EE(o.type,o.pendingProps,Le.current),sn=o,ni=!0,y=mt,gr(o.type)?(dg=y,mt=si(d.firstChild)):mt=y),on(s,o,o.pendingProps.children,u),sf(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Je&&((y=d=mt)&&(d=gN(d,o.type,o.pendingProps,ni),d!==null?(o.stateNode=d,sn=o,mt=si(d.firstChild),ni=!1,y=!0):y=!1),y||nr(o)),Yr(o),y=o.type,v=o.pendingProps,A=s!==null?s.memoizedProps:null,d=v.children,og(y,v)?d=null:A!==null&&og(y,A)&&(o.flags|=32),o.memoizedState!==null&&(y=rm(s,o,M1,null,null,u),ju._currentValue=y),sf(s,o),on(s,o,d,u),o.child;case 6:return s===null&&Je&&((s=u=mt)&&(u=yN(u,o.pendingProps,ni),u!==null?(o.stateNode=u,sn=o,mt=null,s=!0):s=!1),s||nr(o)),null;case 13:return cT(s,o,u);case 4:return Kt(o,o.stateNode.containerInfo),d=o.pendingProps,s===null?o.child=Eo(o,null,d,u):on(s,o,d,u),o.child;case 11:return tT(s,o,o.type,o.pendingProps,u);case 7:return on(s,o,o.pendingProps,u),o.child;case 8:return on(s,o,o.pendingProps.children,u),o.child;case 12:return on(s,o,o.pendingProps.children,u),o.child;case 10:return d=o.pendingProps,ir(o,o.type,d.value),on(s,o,d.children,u),o.child;case 9:return y=o.type._context,d=o.pendingProps.children,yo(o),y=rn(y),d=d(y),o.flags|=1,on(s,o,d,u),o.child;case 14:return nT(s,o,o.type,o.pendingProps,u);case 15:return iT(s,o,o.type,o.pendingProps,u);case 19:return fT(s,o,u);case 31:return F1(s,o,u);case 22:return sT(s,o,u,o.pendingProps);case 24:return yo(o),d=rn(Ft),s===null?(y=Qp(),y===null&&(y=ft,v=$p(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=u),y=v),o.memoizedState={parent:d,cache:y},Xp(o),ir(o,Ft,y)):((s.lanes&u)!==0&&(Wp(s,o),Nu(o,null,null,u),xu()),y=s.memoizedState,v=o.memoizedState,y.parent!==d?(y={parent:d,cache:d},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),ir(o,Ft,d)):(d=v.cache,ir(o,Ft,d),d!==y.cache&&Jp(o,[Ft],u,!0))),on(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function _s(s){s.flags|=4}function Pm(s,o,u,d,y){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(BT())s.flags|=8192;else throw To=qd,jp}else s.flags&=-16777217}function pT(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!xE(o))if(BT())s.flags|=8192;else throw To=qd,jp}function of(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?dd():536870912,s.lanes|=o,Oa|=o)}function Lu(s,o){if(!Je)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function gt(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,d=0;if(o)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,d|=y.subtreeFlags&65011712,d|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,d|=y.subtreeFlags,d|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=d,s.childLanes=u,o}function G1(s,o,u){var d=o.pendingProps;switch(Gp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(o),null;case 1:return gt(o),null;case 3:return u=o.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),ps(Ft),_t(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(wa(o)?_s(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zp())),gt(o),null;case 26:var y=o.type,v=o.memoizedState;return s===null?(_s(o),v!==null?(gt(o),pT(o,v)):(gt(o),Pm(o,y,null,d,u))):v?v!==s.memoizedState?(_s(o),gt(o),pT(o,v)):(gt(o),o.flags&=-16777217):(s=s.memoizedProps,s!==d&&_s(o),gt(o),Pm(o,y,s,d,u)),null;case 27:if(ia(o),u=Le.current,y=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&_s(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return gt(o),null}s=ge.current,wa(o)?$v(o):(s=EE(y,d,u),o.stateNode=s,_s(o))}return gt(o),null;case 5:if(ia(o),y=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&_s(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return gt(o),null}if(v=ge.current,wa(o))$v(o);else{var A=Ef(Le.current);switch(v){case 1:v=A.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=A.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=A.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof d.is=="string"?A.createElement("select",{is:d.is}):A.createElement("select"),d.multiple?v.multiple=!0:d.size&&(v.size=d.size);break;default:v=typeof d.is=="string"?A.createElement(y,{is:d.is}):A.createElement(y)}}v[Lt]=o,v[jt]=d;e:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)v.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=v;e:switch(an(v,y,d),y){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&_s(o)}}return gt(o),Pm(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,u),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==d&&_s(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(i(166));if(s=Le.current,wa(o)){if(s=o.stateNode,u=o.memoizedProps,d=null,y=sn,y!==null)switch(y.tag){case 27:case 5:d=y.memoizedProps}s[Lt]=o,s=!!(s.nodeValue===u||d!==null&&d.suppressHydrationWarning===!0||cE(s.nodeValue,u)),s||nr(o,!0)}else s=Ef(s).createTextNode(d),s[Lt]=o,o.stateNode=s}return gt(o),null;case 31:if(u=o.memoizedState,s===null||s.memoizedState!==null){if(d=wa(o),u!==null){if(s===null){if(!d)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Lt]=o}else mo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;gt(o),s=!1}else u=zp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return o.flags&256?(On(o),o):(On(o),null);if((o.flags&128)!==0)throw Error(i(558))}return gt(o),null;case 13:if(d=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=wa(o),d!==null&&d.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Lt]=o}else mo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;gt(o),y=!1}else y=zp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(On(o),o):(On(o),null)}return On(o),(o.flags&128)!==0?(o.lanes=u,o):(u=d!==null,s=s!==null&&s.memoizedState!==null,u&&(d=o.child,y=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(y=d.alternate.memoizedState.cachePool.pool),v=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==y&&(d.flags|=2048)),u!==s&&u&&(o.child.flags|=8192),of(o,o.updateQueue),gt(o),null);case 4:return _t(),s===null&&tg(o.stateNode.containerInfo),gt(o),null;case 10:return ps(o.type),gt(o),null;case 19:if(oe(xt),d=o.memoizedState,d===null)return gt(o),null;if(y=(o.flags&128)!==0,v=d.rendering,v===null)if(y)Lu(d,!1);else{if(It!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(v=Jd(s),v!==null){for(o.flags|=128,Lu(d,!1),s=v.updateQueue,o.updateQueue=s,of(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)qv(u,s),u=u.sibling;return pe(xt,xt.current&1|2),Je&&fs(o,d.treeForkCount),o.child}s=s.sibling}d.tail!==null&&gn()>df&&(o.flags|=128,y=!0,Lu(d,!1),o.lanes=4194304)}else{if(!y)if(s=Jd(v),s!==null){if(o.flags|=128,y=!0,s=s.updateQueue,o.updateQueue=s,of(o,s),Lu(d,!0),d.tail===null&&d.tailMode==="hidden"&&!v.alternate&&!Je)return gt(o),null}else 2*gn()-d.renderingStartTime>df&&u!==536870912&&(o.flags|=128,y=!0,Lu(d,!1),o.lanes=4194304);d.isBackwards?(v.sibling=o.child,o.child=v):(s=d.last,s!==null?s.sibling=v:o.child=v,d.last=v)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=gn(),s.sibling=null,u=xt.current,pe(xt,y?u&1|2:u&1),Je&&fs(o,d.treeForkCount),s):(gt(o),null);case 22:case 23:return On(o),nm(),d=o.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(u&536870912)!==0&&(o.flags&128)===0&&(gt(o),o.subtreeFlags&6&&(o.flags|=8192)):gt(o),u=o.updateQueue,u!==null&&of(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==u&&(o.flags|=2048),s!==null&&oe(_o),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ps(Ft),gt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function q1(s,o){switch(Gp(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return ps(Ft),_t(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return ia(o),null;case 31:if(o.memoizedState!==null){if(On(o),o.alternate===null)throw Error(i(340));mo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(On(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));mo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return oe(xt),null;case 4:return _t(),null;case 10:return ps(o.type),null;case 22:case 23:return On(o),nm(),s!==null&&oe(_o),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return ps(Ft),null;case 25:return null;default:return null}}function mT(s,o){switch(Gp(o),o.tag){case 3:ps(Ft),_t();break;case 26:case 27:case 5:ia(o);break;case 4:_t();break;case 31:o.memoizedState!==null&&On(o);break;case 13:On(o);break;case 19:oe(xt);break;case 10:ps(o.type);break;case 22:case 23:On(o),nm(),s!==null&&oe(_o);break;case 24:ps(Ft)}}function Uu(s,o){try{var u=o.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var y=d.next;u=y;do{if((u.tag&s)===s){d=void 0;var v=u.create,A=u.inst;d=v(),A.destroy=d}u=u.next}while(u!==y)}}catch(b){st(o,o.return,b)}}function ur(s,o,u){try{var d=o.updateQueue,y=d!==null?d.lastEffect:null;if(y!==null){var v=y.next;d=v;do{if((d.tag&s)===s){var A=d.inst,b=A.destroy;if(b!==void 0){A.destroy=void 0,y=o;var O=u,Q=b;try{Q()}catch(ne){st(y,O,ne)}}}d=d.next}while(d!==v)}}catch(ne){st(o,o.return,ne)}}function gT(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{o0(o,u)}catch(d){st(s,s.return,d)}}}function yT(s,o,u){u.props=Ao(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(d){st(s,o,d)}}function Ou(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof u=="function"?s.refCleanup=u(d):u.current=d}}catch(y){st(s,o,y)}}function Xi(s,o){var u=s.ref,d=s.refCleanup;if(u!==null)if(typeof d=="function")try{d()}catch(y){st(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){st(s,o,y)}else u.current=null}function _T(s){var o=s.type,u=s.memoizedProps,d=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&d.focus();break e;case"img":u.src?d.src=u.src:u.srcSet&&(d.srcset=u.srcSet)}}catch(y){st(s,s.return,y)}}function Vm(s,o,u){try{var d=s.stateNode;cN(d,s.type,u,o),d[jt]=o}catch(y){st(s,s.return,y)}}function vT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&gr(s.type)||s.tag===4}function km(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||vT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&gr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lm(s,o,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=mi));else if(d!==4&&(d===27&&gr(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(Lm(s,o,u),s=s.sibling;s!==null;)Lm(s,o,u),s=s.sibling}function af(s,o,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(d!==4&&(d===27&&gr(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(af(s,o,u),s=s.sibling;s!==null;)af(s,o,u),s=s.sibling}function TT(s){var o=s.stateNode,u=s.memoizedProps;try{for(var d=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);an(o,d,u),o[Lt]=s,o[jt]=u}catch(v){st(s,s.return,v)}}var vs=!1,qt=!1,Um=!1,ET=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function z1(s,o){if(s=s.containerInfo,sg=Rf,s=Pv(s),Np(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var y=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var A=0,b=-1,O=-1,Q=0,ne=0,re=s,j=null;t:for(;;){for(var Z;re!==u||y!==0&&re.nodeType!==3||(b=A+y),re!==v||d!==0&&re.nodeType!==3||(O=A+d),re.nodeType===3&&(A+=re.nodeValue.length),(Z=re.firstChild)!==null;)j=re,re=Z;for(;;){if(re===s)break t;if(j===u&&++Q===y&&(b=A),j===v&&++ne===d&&(O=A),(Z=re.nextSibling)!==null)break;re=j,j=re.parentNode}re=Z}u=b===-1||O===-1?null:{start:b,end:O}}else u=null}u=u||{start:0,end:0}}else u=null;for(rg={focusedElem:s,selectionRange:u},Rf=!1,Wt=o;Wt!==null;)if(o=Wt,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Wt=s;else for(;Wt!==null;){switch(o=Wt,v=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)y=s[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,u=o,y=v.memoizedProps,v=v.memoizedState,d=u.stateNode;try{var ve=Ao(u.type,y);s=d.getSnapshotBeforeUpdate(ve,v),d.__reactInternalSnapshotBeforeUpdate=s}catch(Ce){st(u,u.return,Ce)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)lg(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,Wt=s;break}Wt=o.return}}function ST(s,o,u){var d=u.flags;switch(u.tag){case 0:case 11:case 15:Es(s,u),d&4&&Uu(5,u);break;case 1:if(Es(s,u),d&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(A){st(u,u.return,A)}else{var y=Ao(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(A){st(u,u.return,A)}}d&64&&gT(u),d&512&&Ou(u,u.return);break;case 3:if(Es(s,u),d&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{o0(s,o)}catch(A){st(u,u.return,A)}}break;case 27:o===null&&d&4&&TT(u);case 26:case 5:Es(s,u),o===null&&d&4&&_T(u),d&512&&Ou(u,u.return);break;case 12:Es(s,u);break;case 31:Es(s,u),d&4&&wT(s,u);break;case 13:Es(s,u),d&4&&CT(s,u),d&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=W1.bind(null,u),_N(s,u))));break;case 22:if(d=u.memoizedState!==null||vs,!d){o=o!==null&&o.memoizedState!==null||qt,y=vs;var v=qt;vs=d,(qt=o)&&!v?Ss(s,u,(u.subtreeFlags&8772)!==0):Es(s,u),vs=y,qt=v}break;case 30:break;default:Es(s,u)}}function AT(s){var o=s.alternate;o!==null&&(s.alternate=null,AT(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&la(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Tt=null,wn=!1;function Ts(s,o,u){for(u=u.child;u!==null;)IT(s,o,u),u=u.sibling}function IT(s,o,u){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(di,u)}catch{}switch(u.tag){case 26:qt||Xi(u,o),Ts(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:qt||Xi(u,o);var d=Tt,y=wn;gr(u.type)&&(Tt=u.stateNode,wn=!1),Ts(s,o,u),$u(u.stateNode),Tt=d,wn=y;break;case 5:qt||Xi(u,o);case 6:if(d=Tt,y=wn,Tt=null,Ts(s,o,u),Tt=d,wn=y,Tt!==null)if(wn)try{(Tt.nodeType===9?Tt.body:Tt.nodeName==="HTML"?Tt.ownerDocument.body:Tt).removeChild(u.stateNode)}catch(v){st(u,o,v)}else try{Tt.removeChild(u.stateNode)}catch(v){st(u,o,v)}break;case 18:Tt!==null&&(wn?(s=Tt,gE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Ja(s)):gE(Tt,u.stateNode));break;case 4:d=Tt,y=wn,Tt=u.stateNode.containerInfo,wn=!0,Ts(s,o,u),Tt=d,wn=y;break;case 0:case 11:case 14:case 15:ur(2,u,o),qt||ur(4,u,o),Ts(s,o,u);break;case 1:qt||(Xi(u,o),d=u.stateNode,typeof d.componentWillUnmount=="function"&&yT(u,o,d)),Ts(s,o,u);break;case 21:Ts(s,o,u);break;case 22:qt=(d=qt)||u.memoizedState!==null,Ts(s,o,u),qt=d;break;default:Ts(s,o,u)}}function wT(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ja(s)}catch(u){st(o,o.return,u)}}}function CT(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ja(s)}catch(u){st(o,o.return,u)}}function H1(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new ET),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new ET),o;default:throw Error(i(435,s.tag))}}function lf(s,o){var u=H1(s);o.forEach(function(d){if(!u.has(d)){u.add(d);var y=Z1.bind(null,s,d);d.then(y,y)}})}function Cn(s,o){var u=o.deletions;if(u!==null)for(var d=0;d<u.length;d++){var y=u[d],v=s,A=o,b=A;e:for(;b!==null;){switch(b.tag){case 27:if(gr(b.type)){Tt=b.stateNode,wn=!1;break e}break;case 5:Tt=b.stateNode,wn=!1;break e;case 3:case 4:Tt=b.stateNode.containerInfo,wn=!0;break e}b=b.return}if(Tt===null)throw Error(i(160));IT(v,A,y),Tt=null,wn=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)bT(o,s),o=o.sibling}var Ei=null;function bT(s,o){var u=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Cn(o,s),bn(s),d&4&&(ur(3,s,s.return),Uu(3,s),ur(5,s,s.return));break;case 1:Cn(o,s),bn(s),d&512&&(qt||u===null||Xi(u,u.return)),d&64&&vs&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?d:u.concat(d))));break;case 26:var y=Ei;if(Cn(o,s),bn(s),d&512&&(qt||u===null||Xi(u,u.return)),d&4){var v=u!==null?u.memoizedState:null;if(d=s.memoizedState,u===null)if(d===null)if(s.stateNode===null){e:{d=s.type,u=s.memoizedProps,y=y.ownerDocument||y;t:switch(d){case"title":v=y.getElementsByTagName("title")[0],(!v||v[Ui]||v[Lt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(d),y.head.insertBefore(v,y.querySelector("head > title"))),an(v,d,u),v[Lt]=s,Ut(v),d=v;break e;case"link":var A=bE("link","href",y).get(d+(u.href||""));if(A){for(var b=0;b<A.length;b++)if(v=A[b],v.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&v.getAttribute("rel")===(u.rel==null?null:u.rel)&&v.getAttribute("title")===(u.title==null?null:u.title)&&v.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(b,1);break t}}v=y.createElement(d),an(v,d,u),y.head.appendChild(v);break;case"meta":if(A=bE("meta","content",y).get(d+(u.content||""))){for(b=0;b<A.length;b++)if(v=A[b],v.getAttribute("content")===(u.content==null?null:""+u.content)&&v.getAttribute("name")===(u.name==null?null:u.name)&&v.getAttribute("property")===(u.property==null?null:u.property)&&v.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&v.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(b,1);break t}}v=y.createElement(d),an(v,d,u),y.head.appendChild(v);break;default:throw Error(i(468,d))}v[Lt]=s,Ut(v),d=v}s.stateNode=d}else RE(y,s.type,s.stateNode);else s.stateNode=CE(y,d,s.memoizedProps);else v!==d?(v===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):v.count--,d===null?RE(y,s.type,s.stateNode):CE(y,d,s.memoizedProps)):d===null&&s.stateNode!==null&&Vm(s,s.memoizedProps,u.memoizedProps)}break;case 27:Cn(o,s),bn(s),d&512&&(qt||u===null||Xi(u,u.return)),u!==null&&d&4&&Vm(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Cn(o,s),bn(s),d&512&&(qt||u===null||Xi(u,u.return)),s.flags&32){y=s.stateNode;try{In(y,"")}catch(ve){st(s,s.return,ve)}}d&4&&s.stateNode!=null&&(y=s.memoizedProps,Vm(s,y,u!==null?u.memoizedProps:y)),d&1024&&(Um=!0);break;case 6:if(Cn(o,s),bn(s),d&4){if(s.stateNode===null)throw Error(i(162));d=s.memoizedProps,u=s.stateNode;try{u.nodeValue=d}catch(ve){st(s,s.return,ve)}}break;case 3:if(If=null,y=Ei,Ei=Sf(o.containerInfo),Cn(o,s),Ei=y,bn(s),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Ja(o.containerInfo)}catch(ve){st(s,s.return,ve)}Um&&(Um=!1,RT(s));break;case 4:d=Ei,Ei=Sf(s.stateNode.containerInfo),Cn(o,s),bn(s),Ei=d;break;case 12:Cn(o,s),bn(s);break;case 31:Cn(o,s),bn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,lf(s,d)));break;case 13:Cn(o,s),bn(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(cf=gn()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,lf(s,d)));break;case 22:y=s.memoizedState!==null;var O=u!==null&&u.memoizedState!==null,Q=vs,ne=qt;if(vs=Q||y,qt=ne||O,Cn(o,s),qt=ne,vs=Q,bn(s),d&8192)e:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||O||vs||qt||Io(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){O=u=o;try{if(v=O.stateNode,y)A=v.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{b=O.stateNode;var re=O.memoizedProps.style,j=re!=null&&re.hasOwnProperty("display")?re.display:null;b.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(ve){st(O,O.return,ve)}}}else if(o.tag===6){if(u===null){O=o;try{O.stateNode.nodeValue=y?"":O.memoizedProps}catch(ve){st(O,O.return,ve)}}}else if(o.tag===18){if(u===null){O=o;try{var Z=O.stateNode;y?yE(Z,!0):yE(O.stateNode,!1)}catch(ve){st(O,O.return,ve)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=s.updateQueue,d!==null&&(u=d.retryQueue,u!==null&&(d.retryQueue=null,lf(s,u))));break;case 19:Cn(o,s),bn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,lf(s,d)));break;case 30:break;case 21:break;default:Cn(o,s),bn(s)}}function bn(s){var o=s.flags;if(o&2){try{for(var u,d=s.return;d!==null;){if(vT(d)){u=d;break}d=d.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var y=u.stateNode,v=km(s);af(s,v,y);break;case 5:var A=u.stateNode;u.flags&32&&(In(A,""),u.flags&=-33);var b=km(s);af(s,b,A);break;case 3:case 4:var O=u.stateNode.containerInfo,Q=km(s);Lm(s,Q,O);break;default:throw Error(i(161))}}catch(ne){st(s,s.return,ne)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function RT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;RT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Es(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)ST(s,o.alternate,o),o=o.sibling}function Io(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:ur(4,o,o.return),Io(o);break;case 1:Xi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&yT(o,o.return,u),Io(o);break;case 27:$u(o.stateNode);case 26:case 5:Xi(o,o.return),Io(o);break;case 22:o.memoizedState===null&&Io(o);break;case 30:Io(o);break;default:Io(o)}s=s.sibling}}function Ss(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,y=s,v=o,A=v.flags;switch(v.tag){case 0:case 11:case 15:Ss(y,v,u),Uu(4,v);break;case 1:if(Ss(y,v,u),d=v,y=d.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Q){st(d,d.return,Q)}if(d=v,y=d.updateQueue,y!==null){var b=d.stateNode;try{var O=y.shared.hiddenCallbacks;if(O!==null)for(y.shared.hiddenCallbacks=null,y=0;y<O.length;y++)r0(O[y],b)}catch(Q){st(d,d.return,Q)}}u&&A&64&&gT(v),Ou(v,v.return);break;case 27:TT(v);case 26:case 5:Ss(y,v,u),u&&d===null&&A&4&&_T(v),Ou(v,v.return);break;case 12:Ss(y,v,u);break;case 31:Ss(y,v,u),u&&A&4&&wT(y,v);break;case 13:Ss(y,v,u),u&&A&4&&CT(y,v);break;case 22:v.memoizedState===null&&Ss(y,v,u),Ou(v,v.return);break;case 30:break;default:Ss(y,v,u)}o=o.sibling}}function Om(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Iu(u))}function Fm(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Iu(s))}function Si(s,o,u,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)xT(s,o,u,d),o=o.sibling}function xT(s,o,u,d){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Si(s,o,u,d),y&2048&&Uu(9,o);break;case 1:Si(s,o,u,d);break;case 3:Si(s,o,u,d),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Iu(s)));break;case 12:if(y&2048){Si(s,o,u,d),s=o.stateNode;try{var v=o.memoizedProps,A=v.id,b=v.onPostCommit;typeof b=="function"&&b(A,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(O){st(o,o.return,O)}}else Si(s,o,u,d);break;case 31:Si(s,o,u,d);break;case 13:Si(s,o,u,d);break;case 23:break;case 22:v=o.stateNode,A=o.alternate,o.memoizedState!==null?v._visibility&2?Si(s,o,u,d):Fu(s,o):v._visibility&2?Si(s,o,u,d):(v._visibility|=2,ka(s,o,u,d,(o.subtreeFlags&10256)!==0||!1)),y&2048&&Om(A,o);break;case 24:Si(s,o,u,d),y&2048&&Fm(o.alternate,o);break;default:Si(s,o,u,d)}}function ka(s,o,u,d,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var v=s,A=o,b=u,O=d,Q=A.flags;switch(A.tag){case 0:case 11:case 15:ka(v,A,b,O,y),Uu(8,A);break;case 23:break;case 22:var ne=A.stateNode;A.memoizedState!==null?ne._visibility&2?ka(v,A,b,O,y):Fu(v,A):(ne._visibility|=2,ka(v,A,b,O,y)),y&&Q&2048&&Om(A.alternate,A);break;case 24:ka(v,A,b,O,y),y&&Q&2048&&Fm(A.alternate,A);break;default:ka(v,A,b,O,y)}o=o.sibling}}function Fu(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,d=o,y=d.flags;switch(d.tag){case 22:Fu(u,d),y&2048&&Om(d.alternate,d);break;case 24:Fu(u,d),y&2048&&Fm(d.alternate,d);break;default:Fu(u,d)}o=o.sibling}}var Bu=8192;function La(s,o,u){if(s.subtreeFlags&Bu)for(s=s.child;s!==null;)NT(s,o,u),s=s.sibling}function NT(s,o,u){switch(s.tag){case 26:La(s,o,u),s.flags&Bu&&s.memoizedState!==null&&NN(u,Ei,s.memoizedState,s.memoizedProps);break;case 5:La(s,o,u);break;case 3:case 4:var d=Ei;Ei=Sf(s.stateNode.containerInfo),La(s,o,u),Ei=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=Bu,Bu=16777216,La(s,o,u),Bu=d):La(s,o,u));break;default:La(s,o,u)}}function MT(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function Gu(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];Wt=d,PT(d,s)}MT(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)DT(s),s=s.sibling}function DT(s){switch(s.tag){case 0:case 11:case 15:Gu(s),s.flags&2048&&ur(9,s,s.return);break;case 3:Gu(s);break;case 12:Gu(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,uf(s)):Gu(s);break;default:Gu(s)}}function uf(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];Wt=d,PT(d,s)}MT(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:ur(8,o,o.return),uf(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,uf(o));break;default:uf(o)}s=s.sibling}}function PT(s,o){for(;Wt!==null;){var u=Wt;switch(u.tag){case 0:case 11:case 15:ur(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var d=u.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Iu(u.memoizedState.cache)}if(d=u.child,d!==null)d.return=u,Wt=d;else e:for(u=s;Wt!==null;){d=Wt;var y=d.sibling,v=d.return;if(AT(d),d===u){Wt=null;break e}if(y!==null){y.return=v,Wt=y;break e}Wt=v}}}var K1={getCacheForType:function(s){var o=rn(Ft),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u},cacheSignal:function(){return rn(Ft).controller.signal}},J1=typeof WeakMap=="function"?WeakMap:Map,Ze=0,ft=null,Be=null,qe=0,it=0,Fn=null,cr=!1,Ua=!1,Bm=!1,As=0,It=0,dr=0,wo=0,Gm=0,Bn=0,Oa=0,qu=null,Rn=null,qm=!1,cf=0,VT=0,df=1/0,ff=null,fr=null,$t=0,hr=null,Fa=null,Is=0,zm=0,Hm=null,kT=null,zu=0,Km=null;function Gn(){return(Ze&2)!==0&&qe!==0?qe&-qe:te.T!==null?Xm():fd()}function LT(){if(Bn===0)if((qe&536870912)===0||Je){var s=Xr;Xr<<=1,(Xr&3932160)===0&&(Xr=262144),Bn=s}else Bn=536870912;return s=Un.current,s!==null&&(s.flags|=32),Bn}function xn(s,o,u){(s===ft&&(it===2||it===9)||s.cancelPendingCommit!==null)&&(Ba(s,0),pr(s,qe,Bn,!1)),Wr(s,u),((Ze&2)===0||s!==ft)&&(s===ft&&((Ze&2)===0&&(wo|=u),It===4&&pr(s,qe,Bn,!1)),Wi(s))}function UT(s,o,u){if((Ze&6)!==0)throw Error(i(327));var d=!u&&(o&127)===0&&(o&s.expiredLanes)===0||fi(s,o),y=d?Q1(s,o):$m(s,o,!0),v=d;do{if(y===0){Ua&&!d&&pr(s,o,0,!1);break}else{if(u=s.current.alternate,v&&!$1(u)){y=$m(s,o,!1),v=!1;continue}if(y===2){if(v=o,s.errorRecoveryDisabledLanes&v)var A=0;else A=s.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){o=A;e:{var b=s;y=qu;var O=b.current.memoizedState.isDehydrated;if(O&&(Ba(b,A).flags|=256),A=$m(b,A,!1),A!==2){if(Bm&&!O){b.errorRecoveryDisabledLanes|=v,wo|=v,y=4;break e}v=Rn,Rn=y,v!==null&&(Rn===null?Rn=v:Rn.push.apply(Rn,v))}y=A}if(v=!1,y!==2)continue}}if(y===1){Ba(s,0),pr(s,o,0,!0);break}e:{switch(d=s,v=y,v){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:pr(d,o,Bn,!cr);break e;case 2:Rn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(y=cf+300-gn(),10<y)){if(pr(d,o,Bn,!cr),Vi(d,0,!0)!==0)break e;Is=o,d.timeoutHandle=pE(OT.bind(null,d,u,Rn,ff,qm,o,Bn,wo,Oa,cr,v,"Throttled",-0,0),y);break e}OT(d,u,Rn,ff,qm,o,Bn,wo,Oa,cr,v,null,-0,0)}}break}while(!0);Wi(s)}function OT(s,o,u,d,y,v,A,b,O,Q,ne,re,j,Z){if(s.timeoutHandle=-1,re=o.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:mi},NT(o,v,re);var ve=(v&62914560)===v?cf-gn():(v&4194048)===v?VT-gn():0;if(ve=MN(re,ve),ve!==null){Is=v,s.cancelPendingCommit=ve(JT.bind(null,s,o,v,u,d,y,A,b,O,ne,re,null,j,Z)),pr(s,v,A,!Q);return}}JT(s,o,v,u,d,y,A,b,O)}function $1(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var d=0;d<u.length;d++){var y=u[d],v=y.getSnapshot;y=y.value;try{if(!kn(v(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function pr(s,o,u,d){o&=~Gm,o&=~wo,s.suspendedLanes|=o,s.pingedLanes&=~o,d&&(s.warmLanes|=o),d=s.expirationTimes;for(var y=o;0<y;){var v=31-bt(y),A=1<<v;d[v]=-1,y&=~A}u!==0&&Zr(s,u,o)}function hf(){return(Ze&6)===0?(Hu(0),!1):!0}function Jm(){if(Be!==null){if(it===0)var s=Be.return;else s=Be,hs=go=null,lm(s),Na=null,Cu=0,s=Be;for(;s!==null;)mT(s.alternate,s),s=s.return;Be=null}}function Ba(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,hN(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Is=0,Jm(),ft=s,Be=u=ds(s.current,null),qe=o,it=0,Fn=null,cr=!1,Ua=fi(s,o),Bm=!1,Oa=Bn=Gm=wo=dr=It=0,Rn=qu=null,qm=!1,(o&8)!==0&&(o|=o&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=o;0<d;){var y=31-bt(d),v=1<<y;o|=s[y],d&=~v}return As=o,Pd(),u}function FT(s,o){Ve=null,te.H=Vu,o===xa||o===Gd?(o=t0(),it=3):o===jp?(o=t0(),it=4):it=o===Im?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Fn=o,Be===null&&(It=1,tf(s,Zn(o,s.current)))}function BT(){var s=Un.current;return s===null?!0:(qe&4194048)===qe?ii===null:(qe&62914560)===qe||(qe&536870912)!==0?s===ii:!1}function GT(){var s=te.H;return te.H=Vu,s===null?Vu:s}function qT(){var s=te.A;return te.A=K1,s}function pf(){It=4,cr||(qe&4194048)!==qe&&Un.current!==null||(Ua=!0),(dr&134217727)===0&&(wo&134217727)===0||ft===null||pr(ft,qe,Bn,!1)}function $m(s,o,u){var d=Ze;Ze|=2;var y=GT(),v=qT();(ft!==s||qe!==o)&&(ff=null,Ba(s,o)),o=!1;var A=It;e:do try{if(it!==0&&Be!==null){var b=Be,O=Fn;switch(it){case 8:Jm(),A=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(o=!0);var Q=it;if(it=0,Fn=null,Ga(s,b,O,Q),u&&Ua){A=0;break e}break;default:Q=it,it=0,Fn=null,Ga(s,b,O,Q)}}Y1(),A=It;break}catch(ne){FT(s,ne)}while(!0);return o&&s.shellSuspendCounter++,hs=go=null,Ze=d,te.H=y,te.A=v,Be===null&&(ft=null,qe=0,Pd()),A}function Y1(){for(;Be!==null;)zT(Be)}function Q1(s,o){var u=Ze;Ze|=2;var d=GT(),y=qT();ft!==s||qe!==o?(ff=null,df=gn()+500,Ba(s,o)):Ua=fi(s,o);e:do try{if(it!==0&&Be!==null){o=Be;var v=Fn;t:switch(it){case 1:it=0,Fn=null,Ga(s,o,v,1);break;case 2:case 9:if(Zv(v)){it=0,Fn=null,HT(o);break}o=function(){it!==2&&it!==9||ft!==s||(it=7),Wi(s)},v.then(o,o);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Zv(v)?(it=0,Fn=null,HT(o)):(it=0,Fn=null,Ga(s,o,v,7));break;case 5:var A=null;switch(Be.tag){case 26:A=Be.memoizedState;case 5:case 27:var b=Be;if(A?xE(A):b.stateNode.complete){it=0,Fn=null;var O=b.sibling;if(O!==null)Be=O;else{var Q=b.return;Q!==null?(Be=Q,mf(Q)):Be=null}break t}}it=0,Fn=null,Ga(s,o,v,5);break;case 6:it=0,Fn=null,Ga(s,o,v,6);break;case 8:Jm(),It=6;break e;default:throw Error(i(462))}}j1();break}catch(ne){FT(s,ne)}while(!0);return hs=go=null,te.H=d,te.A=y,Ze=u,Be!==null?0:(ft=null,qe=0,Pd(),It)}function j1(){for(;Be!==null&&!Ap();)zT(Be)}function zT(s){var o=hT(s.alternate,s,As);s.memoizedProps=s.pendingProps,o===null?mf(s):Be=o}function HT(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=aT(u,o,o.pendingProps,o.type,void 0,qe);break;case 11:o=aT(u,o,o.pendingProps,o.type.render,o.ref,qe);break;case 5:lm(o);default:mT(u,o),o=Be=qv(o,As),o=hT(u,o,As)}s.memoizedProps=s.pendingProps,o===null?mf(s):Be=o}function Ga(s,o,u,d){hs=go=null,lm(o),Na=null,Cu=0;var y=o.return;try{if(O1(s,y,o,u,qe)){It=1,tf(s,Zn(u,s.current)),Be=null;return}}catch(v){if(y!==null)throw Be=y,v;It=1,tf(s,Zn(u,s.current)),Be=null;return}o.flags&32768?(Je||d===1?s=!0:Ua||(qe&536870912)!==0?s=!1:(cr=s=!0,(d===2||d===9||d===3||d===6)&&(d=Un.current,d!==null&&d.tag===13&&(d.flags|=16384))),KT(o,s)):mf(o)}function mf(s){var o=s;do{if((o.flags&32768)!==0){KT(o,cr);return}s=o.return;var u=G1(o.alternate,o,As);if(u!==null){Be=u;return}if(o=o.sibling,o!==null){Be=o;return}Be=o=s}while(o!==null);It===0&&(It=5)}function KT(s,o){do{var u=q1(s.alternate,s);if(u!==null){u.flags&=32767,Be=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){Be=s;return}Be=s=u}while(s!==null);It=6,Be=null}function JT(s,o,u,d,y,v,A,b,O){s.cancelPendingCommit=null;do gf();while($t!==0);if((Ze&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(v=o.lanes|o.childLanes,v|=kp,Cp(s,u,v,A,b,O),s===ft&&(Be=ft=null,qe=0),Fa=o,hr=s,Is=u,zm=v,Hm=y,kT=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,eN(Hs,function(){return XT(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=te.T,te.T=null,y=fe.p,fe.p=2,A=Ze,Ze|=4;try{z1(s,o,u)}finally{Ze=A,fe.p=y,te.T=d}}$t=1,$T(),YT(),QT()}}function $T(){if($t===1){$t=0;var s=hr,o=Fa,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=te.T,te.T=null;var d=fe.p;fe.p=2;var y=Ze;Ze|=4;try{bT(o,s);var v=rg,A=Pv(s.containerInfo),b=v.focusedElem,O=v.selectionRange;if(A!==b&&b&&b.ownerDocument&&Dv(b.ownerDocument.documentElement,b)){if(O!==null&&Np(b)){var Q=O.start,ne=O.end;if(ne===void 0&&(ne=Q),"selectionStart"in b)b.selectionStart=Q,b.selectionEnd=Math.min(ne,b.value.length);else{var re=b.ownerDocument||document,j=re&&re.defaultView||window;if(j.getSelection){var Z=j.getSelection(),ve=b.textContent.length,Ce=Math.min(O.start,ve),dt=O.end===void 0?Ce:Math.min(O.end,ve);!Z.extend&&Ce>dt&&(A=dt,dt=Ce,Ce=A);var H=Mv(b,Ce),F=Mv(b,dt);if(H&&F&&(Z.rangeCount!==1||Z.anchorNode!==H.node||Z.anchorOffset!==H.offset||Z.focusNode!==F.node||Z.focusOffset!==F.offset)){var Y=re.createRange();Y.setStart(H.node,H.offset),Z.removeAllRanges(),Ce>dt?(Z.addRange(Y),Z.extend(F.node,F.offset)):(Y.setEnd(F.node,F.offset),Z.addRange(Y))}}}}for(re=[],Z=b;Z=Z.parentNode;)Z.nodeType===1&&re.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<re.length;b++){var se=re[b];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}Rf=!!sg,rg=sg=null}finally{Ze=y,fe.p=d,te.T=u}}s.current=o,$t=2}}function YT(){if($t===2){$t=0;var s=hr,o=Fa,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=te.T,te.T=null;var d=fe.p;fe.p=2;var y=Ze;Ze|=4;try{ST(s,o.alternate,o)}finally{Ze=y,fe.p=d,te.T=u}}$t=3}}function QT(){if($t===4||$t===3){$t=0,rd();var s=hr,o=Fa,u=Is,d=kT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?$t=5:($t=0,Fa=hr=null,jT(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(fr=null),as(u),o=o.stateNode,tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(di,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=te.T,y=fe.p,fe.p=2,te.T=null;try{for(var v=s.onRecoverableError,A=0;A<d.length;A++){var b=d[A];v(b.value,{componentStack:b.stack})}}finally{te.T=o,fe.p=y}}(Is&3)!==0&&gf(),Wi(s),y=s.pendingLanes,(u&261930)!==0&&(y&42)!==0?s===Km?zu++:(zu=0,Km=s):zu=0,Hu(0)}}function jT(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Iu(o)))}function gf(){return $T(),YT(),QT(),XT()}function XT(){if($t!==5)return!1;var s=hr,o=zm;zm=0;var u=as(Is),d=te.T,y=fe.p;try{fe.p=32>u?32:u,te.T=null,u=Hm,Hm=null;var v=hr,A=Is;if($t=0,Fa=hr=null,Is=0,(Ze&6)!==0)throw Error(i(331));var b=Ze;if(Ze|=4,DT(v.current),xT(v,v.current,A,u),Ze=b,Hu(0,!1),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(di,v)}catch{}return!0}finally{fe.p=y,te.T=d,jT(s,o)}}function WT(s,o,u){o=Zn(u,o),o=Am(s.stateNode,o,2),s=or(s,o,2),s!==null&&(Wr(s,2),Wi(s))}function st(s,o,u){if(s.tag===3)WT(s,s,u);else for(;o!==null;){if(o.tag===3){WT(o,s,u);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(fr===null||!fr.has(d))){s=Zn(u,s),u=Z0(2),d=or(o,u,2),d!==null&&(eT(u,d,o,s),Wr(d,2),Wi(d));break}}o=o.return}}function Ym(s,o,u){var d=s.pingCache;if(d===null){d=s.pingCache=new J1;var y=new Set;d.set(o,y)}else y=d.get(o),y===void 0&&(y=new Set,d.set(o,y));y.has(u)||(Bm=!0,y.add(u),s=X1.bind(null,s,o,u),o.then(s,s))}function X1(s,o,u){var d=s.pingCache;d!==null&&d.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,ft===s&&(qe&u)===u&&(It===4||It===3&&(qe&62914560)===qe&&300>gn()-cf?(Ze&2)===0&&Ba(s,0):Gm|=u,Oa===qe&&(Oa=0)),Wi(s)}function ZT(s,o){o===0&&(o=dd()),s=ho(s,o),s!==null&&(Wr(s,o),Wi(s))}function W1(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),ZT(s,u)}function Z1(s,o){var u=0;switch(s.tag){case 31:case 13:var d=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(o),ZT(s,u)}function eN(s,o){return Jt(s,o)}var yf=null,qa=null,Qm=!1,_f=!1,jm=!1,mr=0;function Wi(s){s!==qa&&s.next===null&&(qa===null?yf=qa=s:qa=qa.next=s),_f=!0,Qm||(Qm=!0,nN())}function Hu(s,o){if(!jm&&_f){jm=!0;do for(var u=!1,d=yf;d!==null;){if(s!==0){var y=d.pendingLanes;if(y===0)var v=0;else{var A=d.suspendedLanes,b=d.pingedLanes;v=(1<<31-bt(42|s)+1)-1,v&=y&~(A&~b),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(u=!0,iE(d,v))}else v=qe,v=Vi(d,d===ft?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||fi(d,v)||(u=!0,iE(d,v));d=d.next}while(u);jm=!1}}function tN(){eE()}function eE(){_f=Qm=!1;var s=0;mr!==0&&fN()&&(s=mr);for(var o=gn(),u=null,d=yf;d!==null;){var y=d.next,v=tE(d,o);v===0?(d.next=null,u===null?yf=y:u.next=y,y===null&&(qa=u)):(u=d,(s!==0||(v&3)!==0)&&(_f=!0)),d=y}$t!==0&&$t!==5||Hu(s),mr!==0&&(mr=0)}function tE(s,o){for(var u=s.suspendedLanes,d=s.pingedLanes,y=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var A=31-bt(v),b=1<<A,O=y[A];O===-1?((b&u)===0||(b&d)!==0)&&(y[A]=wp(b,o)):O<=o&&(s.expiredLanes|=b),v&=~b}if(o=ft,u=qe,u=Vi(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,u===0||s===o&&(it===2||it===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&zs(d),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||fi(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(d!==null&&zs(d),as(u)){case 2:case 8:u=eu;break;case 32:u=Hs;break;case 268435456:u=od;break;default:u=Hs}return d=nE.bind(null,s),u=Jt(u,d),s.callbackPriority=o,s.callbackNode=u,o}return d!==null&&d!==null&&zs(d),s.callbackPriority=2,s.callbackNode=null,2}function nE(s,o){if($t!==0&&$t!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(gf()&&s.callbackNode!==u)return null;var d=qe;return d=Vi(s,s===ft?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(UT(s,d,o),tE(s,gn()),s.callbackNode!=null&&s.callbackNode===u?nE.bind(null,s):null)}function iE(s,o){if(gf())return null;UT(s,o,!0)}function nN(){pN(function(){(Ze&6)!==0?Jt(Zl,tN):eE()})}function Xm(){if(mr===0){var s=ba;s===0&&(s=Di,Di<<=1,(Di&261888)===0&&(Di=256)),mr=s}return mr}function sE(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:fa(""+s)}function rE(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function iN(s,o,u,d,y){if(o==="submit"&&u&&u.stateNode===y){var v=sE((y[jt]||null).action),A=d.submitter;A&&(o=(o=A[jt]||null)?sE(o.formAction):A.getAttribute("formAction"),o!==null&&(v=o,A=null));var b=new Ki("action","action",null,d,y);s.push({event:b,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(mr!==0){var O=A?rE(y,A):new FormData(y);ym(u,{pending:!0,data:O,method:y.method,action:v},null,O)}}else typeof v=="function"&&(b.preventDefault(),O=A?rE(y,A):new FormData(y),ym(u,{pending:!0,data:O,method:y.method,action:v},v,O))},currentTarget:y}]})}}for(var Wm=0;Wm<Vp.length;Wm++){var Zm=Vp[Wm],sN=Zm.toLowerCase(),rN=Zm[0].toUpperCase()+Zm.slice(1);Ti(sN,"on"+rN)}Ti(Lv,"onAnimationEnd"),Ti(Uv,"onAnimationIteration"),Ti(Ov,"onAnimationStart"),Ti("dblclick","onDoubleClick"),Ti("focusin","onFocus"),Ti("focusout","onBlur"),Ti(E1,"onTransitionRun"),Ti(S1,"onTransitionStart"),Ti(A1,"onTransitionCancel"),Ti(Fv,"onTransitionEnd"),Gi("onMouseEnter",["mouseout","mouseover"]),Gi("onMouseLeave",["mouseout","mouseover"]),Gi("onPointerEnter",["pointerout","pointerover"]),Gi("onPointerLeave",["pointerout","pointerover"]),Bi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Bi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Bi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Bi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Bi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Bi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function oE(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var d=s[u],y=d.event;d=d.listeners;e:{var v=void 0;if(o)for(var A=d.length-1;0<=A;A--){var b=d[A],O=b.instance,Q=b.currentTarget;if(b=b.listener,O!==v&&y.isPropagationStopped())break e;v=b,y.currentTarget=Q;try{v(y)}catch(ne){Dd(ne)}y.currentTarget=null,v=O}else for(A=0;A<d.length;A++){if(b=d[A],O=b.instance,Q=b.currentTarget,b=b.listener,O!==v&&y.isPropagationStopped())break e;v=b,y.currentTarget=Q;try{v(y)}catch(ne){Dd(ne)}y.currentTarget=null,v=O}}}}function Ge(s,o){var u=o[aa];u===void 0&&(u=o[aa]=new Set);var d=s+"__bubble";u.has(d)||(aE(o,s,2,!1),u.add(d))}function eg(s,o,u){var d=0;o&&(d|=4),aE(u,s,d,o)}var vf="_reactListening"+Math.random().toString(36).slice(2);function tg(s){if(!s[vf]){s[vf]=!0,iu.forEach(function(u){u!=="selectionchange"&&(oN.has(u)||eg(u,!1,s),eg(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[vf]||(o[vf]=!0,eg("selectionchange",!1,o))}}function aE(s,o,u,d){switch(LE(o)){case 2:var y=VN;break;case 8:y=kN;break;default:y=gg}u=y.bind(null,o,u,s),y=void 0,!so||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),d?y!==void 0?s.addEventListener(o,u,{capture:!0,passive:y}):s.addEventListener(o,u,!0):y!==void 0?s.addEventListener(o,u,{passive:y}):s.addEventListener(o,u,!1)}function ng(s,o,u,d,y){var v=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var A=d.tag;if(A===3||A===4){var b=d.stateNode.containerInfo;if(b===y)break;if(A===4)for(A=d.return;A!==null;){var O=A.tag;if((O===3||O===4)&&A.stateNode.containerInfo===y)return;A=A.return}for(;b!==null;){if(A=Oi(b),A===null)return;if(O=A.tag,O===5||O===6||O===26||O===27){d=v=A;continue e}b=b.parentNode}}d=d.return}js(function(){var Q=v,ne=Qn(u),re=[];e:{var j=Bv.get(s);if(j!==void 0){var Z=Ki,ve=s;switch(s){case"keypress":if(oo(u)===0)break e;case"keydown":case"keyup":Z=xd;break;case"focusin":ve="focus",Z=lo;break;case"focusout":ve="blur",Z=lo;break;case"beforeblur":case"afterblur":Z=lo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=gu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=Td;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=S;break;case Lv:case Uv:case Ov:Z=Sd;break;case Fv:Z=R;break;case"scroll":case"scrollend":Z=mu;break;case"wheel":Z=X;break;case"copy":case"cut":case"paste":Z=Ad;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=cs;break;case"toggle":case"beforetoggle":Z=Pe}var Ce=(o&4)!==0,dt=!Ce&&(s==="scroll"||s==="scrollend"),H=Ce?j!==null?j+"Capture":null:j;Ce=[];for(var F=Q,Y;F!==null;){var se=F;if(Y=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||Y===null||H===null||(se=gi(F,H),se!=null&&Ce.push(Ju(F,se,Y))),dt)break;F=F.return}0<Ce.length&&(j=new Z(j,ve,null,u,ne),re.push({event:j,listeners:Ce}))}}if((o&7)===0){e:{if(j=s==="mouseover"||s==="pointerover",Z=s==="mouseout"||s==="pointerout",j&&u!==fu&&(ve=u.relatedTarget||u.fromElement)&&(Oi(ve)||ve[Li]))break e;if((Z||j)&&(j=ne.window===ne?ne:(j=ne.ownerDocument)?j.defaultView||j.parentWindow:window,Z?(ve=u.relatedTarget||u.toElement,Z=Q,ve=ve?Oi(ve):null,ve!==null&&(dt=a(ve),Ce=ve.tag,ve!==dt||Ce!==5&&Ce!==27&&Ce!==6)&&(ve=null)):(Z=null,ve=Q),Z!==ve)){if(Ce=gu,se="onMouseLeave",H="onMouseEnter",F="mouse",(s==="pointerout"||s==="pointerover")&&(Ce=cs,se="onPointerLeave",H="onPointerEnter",F="pointer"),dt=Z==null?j:Pn(Z),Y=ve==null?j:Pn(ve),j=new Ce(se,F+"leave",Z,u,ne),j.target=dt,j.relatedTarget=Y,se=null,Oi(ne)===Q&&(Ce=new Ce(H,F+"enter",ve,u,ne),Ce.target=Y,Ce.relatedTarget=dt,se=Ce),dt=se,Z&&ve)t:{for(Ce=aN,H=Z,F=ve,Y=0,se=H;se;se=Ce(se))Y++;se=0;for(var Ie=F;Ie;Ie=Ce(Ie))se++;for(;0<Y-se;)H=Ce(H),Y--;for(;0<se-Y;)F=Ce(F),se--;for(;Y--;){if(H===F||F!==null&&H===F.alternate){Ce=H;break t}H=Ce(H),F=Ce(F)}Ce=null}else Ce=null;Z!==null&&lE(re,j,Z,Ce,!1),ve!==null&&dt!==null&&lE(re,dt,ve,Ce,!0)}}e:{if(j=Q?Pn(Q):window,Z=j.nodeName&&j.nodeName.toLowerCase(),Z==="select"||Z==="input"&&j.type==="file")var Qe=wv;else if(Av(j))if(Cv)Qe=_1;else{Qe=g1;var Se=m1}else Z=j.nodeName,!Z||Z.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?Q&&da(Q.elementType)&&(Qe=wv):Qe=y1;if(Qe&&(Qe=Qe(s,Q))){Iv(re,Qe,u,ne);break e}Se&&Se(s,j,Q),s==="focusout"&&Q&&j.type==="number"&&Q.memoizedProps.value!=null&&uu(j,"number",j.value)}switch(Se=Q?Pn(Q):window,s){case"focusin":(Av(Se)||Se.contentEditable==="true")&&(va=Se,Mp=Q,Eu=null);break;case"focusout":Eu=Mp=va=null;break;case"mousedown":Dp=!0;break;case"contextmenu":case"mouseup":case"dragend":Dp=!1,Vv(re,u,ne);break;case"selectionchange":if(T1)break;case"keydown":case"keyup":Vv(re,u,ne)}var Ue;if(We)e:{switch(s){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else _a?uo(s,u)&&(ze="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(ze="onCompositionStart");ze&&(Yi&&u.locale!=="ko"&&(_a||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&_a&&(Ue=pu()):(Hi=ne,hu="value"in Hi?Hi.value:Hi.textContent,_a=!0)),Se=Tf(Q,ze),0<Se.length&&(ze=new $i(ze,s,null,u,ne),re.push({event:ze,listeners:Se}),Ue?ze.data=Ue:(Ue=ya(u),Ue!==null&&(ze.data=Ue)))),(Ue=Xn?d1(s,u):f1(s,u))&&(ze=Tf(Q,"onBeforeInput"),0<ze.length&&(Se=new $i("onBeforeInput","beforeinput",null,u,ne),re.push({event:Se,listeners:ze}),Se.data=Ue)),iN(re,s,Q,u,ne)}oE(re,o)})}function Ju(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Tf(s,o){for(var u=o+"Capture",d=[];s!==null;){var y=s,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=gi(s,u),y!=null&&d.unshift(Ju(s,y,v)),y=gi(s,o),y!=null&&d.push(Ju(s,y,v))),s.tag===3)return d;s=s.return}return[]}function aN(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function lE(s,o,u,d,y){for(var v=o._reactName,A=[];u!==null&&u!==d;){var b=u,O=b.alternate,Q=b.stateNode;if(b=b.tag,O!==null&&O===d)break;b!==5&&b!==26&&b!==27||Q===null||(O=Q,y?(Q=gi(u,v),Q!=null&&A.unshift(Ju(u,Q,O))):y||(Q=gi(u,v),Q!=null&&A.push(Ju(u,Q,O)))),u=u.return}A.length!==0&&s.push({event:o,listeners:A})}var lN=/\r\n?/g,uN=/\u0000|\uFFFD/g;function uE(s){return(typeof s=="string"?s:""+s).replace(lN,`
`).replace(uN,"")}function cE(s,o){return o=uE(o),uE(s)===o}function ct(s,o,u,d,y,v){switch(u){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||In(s,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&In(s,""+d);break;case"className":Vn(s,"class",d);break;case"tabIndex":Vn(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Vn(s,u,d);break;case"style":du(s,d,v);break;case"data":if(o!=="object"){Vn(s,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=fa(""+d),s.setAttribute(u,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(u==="formAction"?(o!=="input"&&ct(s,o,"name",y.name,y,null),ct(s,o,"formEncType",y.formEncType,y,null),ct(s,o,"formMethod",y.formMethod,y,null),ct(s,o,"formTarget",y.formTarget,y,null)):(ct(s,o,"encType",y.encType,y,null),ct(s,o,"method",y.method,y,null),ct(s,o,"target",y.target,y,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=fa(""+d),s.setAttribute(u,d);break;case"onClick":d!=null&&(s.onclick=mi);break;case"onScroll":d!=null&&Ge("scroll",s);break;case"onScrollEnd":d!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}u=fa(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""+d):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":d===!0?s.setAttribute(u,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,d):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(u,d):s.removeAttribute(u);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(u):s.setAttribute(u,d);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),ua(s,"popover",d);break;case"xlinkActuate":Ot(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Ot(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Ot(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Ot(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Ot(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Ot(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":ua(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=vd.get(u)||u,ua(s,u,d))}}function ig(s,o,u,d,y,v){switch(u){case"style":du(s,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof d=="string"?In(s,d):(typeof d=="number"||typeof d=="bigint")&&In(s,""+d);break;case"onScroll":d!=null&&Ge("scroll",s);break;case"onScrollEnd":d!=null&&Ge("scrollend",s);break;case"onClick":d!=null&&(s.onclick=mi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!su.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),v=s[jt]||null,v=v!=null?v[u]:null,typeof v=="function"&&s.removeEventListener(o,v,y),typeof d=="function")){typeof v!="function"&&v!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,d,y);break e}u in s?s[u]=d:d===!0?s.setAttribute(u,""):ua(s,u,d)}}}function an(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var d=!1,y=!1,v;for(v in u)if(u.hasOwnProperty(v)){var A=u[v];if(A!=null)switch(v){case"src":d=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(s,o,v,A,u,null)}}y&&ct(s,o,"srcSet",u.srcSet,u,null),d&&ct(s,o,"src",u.src,u,null);return;case"input":Ge("invalid",s);var b=v=A=y=null,O=null,Q=null;for(d in u)if(u.hasOwnProperty(d)){var ne=u[d];if(ne!=null)switch(d){case"name":y=ne;break;case"type":A=ne;break;case"checked":O=ne;break;case"defaultChecked":Q=ne;break;case"value":v=ne;break;case"defaultValue":b=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,o));break;default:ct(s,o,d,ne,u,null)}}gd(s,v,b,O,Q,A,y,!1);return;case"select":Ge("invalid",s),d=A=v=null;for(y in u)if(u.hasOwnProperty(y)&&(b=u[y],b!=null))switch(y){case"value":v=b;break;case"defaultValue":A=b;break;case"multiple":d=b;default:ct(s,o,y,b,u,null)}o=v,u=A,s.multiple=!!d,o!=null?Js(s,!!d,o,!1):u!=null&&Js(s,!!d,u,!0);return;case"textarea":Ge("invalid",s),v=y=d=null;for(A in u)if(u.hasOwnProperty(A)&&(b=u[A],b!=null))switch(A){case"value":d=b;break;case"defaultValue":y=b;break;case"children":v=b;break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:ct(s,o,A,b,u,null)}$s(s,d,y,v);return;case"option":for(O in u)if(u.hasOwnProperty(O)&&(d=u[O],d!=null))switch(O){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:ct(s,o,O,d,u,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(d=0;d<Ku.length;d++)Ge(Ku[d],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in u)if(u.hasOwnProperty(Q)&&(d=u[Q],d!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(s,o,Q,d,u,null)}return;default:if(da(o)){for(ne in u)u.hasOwnProperty(ne)&&(d=u[ne],d!==void 0&&ig(s,o,ne,d,u,void 0));return}}for(b in u)u.hasOwnProperty(b)&&(d=u[b],d!=null&&ct(s,o,b,d,u,null))}function cN(s,o,u,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,A=null,b=null,O=null,Q=null,ne=null;for(Z in u){var re=u[Z];if(u.hasOwnProperty(Z)&&re!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":O=re;default:d.hasOwnProperty(Z)||ct(s,o,Z,null,d,re)}}for(var j in d){var Z=d[j];if(re=u[j],d.hasOwnProperty(j)&&(Z!=null||re!=null))switch(j){case"type":v=Z;break;case"name":y=Z;break;case"checked":Q=Z;break;case"defaultChecked":ne=Z;break;case"value":A=Z;break;case"defaultValue":b=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,o));break;default:Z!==re&&ct(s,o,j,Z,d,re)}}ca(s,A,b,O,Q,ne,v,y);return;case"select":Z=A=b=j=null;for(v in u)if(O=u[v],u.hasOwnProperty(v)&&O!=null)switch(v){case"value":break;case"multiple":Z=O;default:d.hasOwnProperty(v)||ct(s,o,v,null,d,O)}for(y in d)if(v=d[y],O=u[y],d.hasOwnProperty(y)&&(v!=null||O!=null))switch(y){case"value":j=v;break;case"defaultValue":b=v;break;case"multiple":A=v;default:v!==O&&ct(s,o,y,v,d,O)}o=b,u=A,d=Z,j!=null?Js(s,!!u,j,!1):!!d!=!!u&&(o!=null?Js(s,!!u,o,!0):Js(s,!!u,u?[]:"",!1));return;case"textarea":Z=j=null;for(b in u)if(y=u[b],u.hasOwnProperty(b)&&y!=null&&!d.hasOwnProperty(b))switch(b){case"value":break;case"children":break;default:ct(s,o,b,null,d,y)}for(A in d)if(y=d[A],v=u[A],d.hasOwnProperty(A)&&(y!=null||v!=null))switch(A){case"value":j=y;break;case"defaultValue":Z=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==v&&ct(s,o,A,y,d,v)}yd(s,j,Z);return;case"option":for(var ve in u)if(j=u[ve],u.hasOwnProperty(ve)&&j!=null&&!d.hasOwnProperty(ve))switch(ve){case"selected":s.selected=!1;break;default:ct(s,o,ve,null,d,j)}for(O in d)if(j=d[O],Z=u[O],d.hasOwnProperty(O)&&j!==Z&&(j!=null||Z!=null))switch(O){case"selected":s.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:ct(s,o,O,j,d,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in u)j=u[Ce],u.hasOwnProperty(Ce)&&j!=null&&!d.hasOwnProperty(Ce)&&ct(s,o,Ce,null,d,j);for(Q in d)if(j=d[Q],Z=u[Q],d.hasOwnProperty(Q)&&j!==Z&&(j!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(137,o));break;default:ct(s,o,Q,j,d,Z)}return;default:if(da(o)){for(var dt in u)j=u[dt],u.hasOwnProperty(dt)&&j!==void 0&&!d.hasOwnProperty(dt)&&ig(s,o,dt,void 0,d,j);for(ne in d)j=d[ne],Z=u[ne],!d.hasOwnProperty(ne)||j===Z||j===void 0&&Z===void 0||ig(s,o,ne,j,d,Z);return}}for(var H in u)j=u[H],u.hasOwnProperty(H)&&j!=null&&!d.hasOwnProperty(H)&&ct(s,o,H,null,d,j);for(re in d)j=d[re],Z=u[re],!d.hasOwnProperty(re)||j===Z||j==null&&Z==null||ct(s,o,re,j,d,Z)}function dE(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dN(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,u=performance.getEntriesByType("resource"),d=0;d<u.length;d++){var y=u[d],v=y.transferSize,A=y.initiatorType,b=y.duration;if(v&&b&&dE(A)){for(A=0,b=y.responseEnd,d+=1;d<u.length;d++){var O=u[d],Q=O.startTime;if(Q>b)break;var ne=O.transferSize,re=O.initiatorType;ne&&dE(re)&&(O=O.responseEnd,A+=ne*(O<b?1:(b-Q)/(O-Q)))}if(--d,o+=8*(v+A)/(y.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var sg=null,rg=null;function Ef(s){return s.nodeType===9?s:s.ownerDocument}function fE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hE(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function og(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ag=null;function fN(){var s=window.event;return s&&s.type==="popstate"?s===ag?!1:(ag=s,!0):(ag=null,!1)}var pE=typeof setTimeout=="function"?setTimeout:void 0,hN=typeof clearTimeout=="function"?clearTimeout:void 0,mE=typeof Promise=="function"?Promise:void 0,pN=typeof queueMicrotask=="function"?queueMicrotask:typeof mE<"u"?function(s){return mE.resolve(null).then(s).catch(mN)}:pE;function mN(s){setTimeout(function(){throw s})}function gr(s){return s==="head"}function gE(s,o){var u=o,d=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(d===0){s.removeChild(y),Ja(o);return}d--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")d++;else if(u==="html")$u(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,$u(u);for(var v=u.firstChild;v;){var A=v.nextSibling,b=v.nodeName;v[Ui]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&v.rel.toLowerCase()==="stylesheet"||u.removeChild(v),v=A}}else u==="body"&&$u(s.ownerDocument.body);u=y}while(u);Ja(o)}function yE(s,o){var u=s;s=0;do{var d=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),d&&d.nodeType===8)if(u=d.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=d}while(u)}function lg(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":lg(u),la(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function gN(s,o,u,d){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[Ui])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=si(s.nextSibling),s===null)break}return null}function yN(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=si(s.nextSibling),s===null))return null;return s}function _E(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=si(s.nextSibling),s===null))return null;return s}function ug(s){return s.data==="$?"||s.data==="$~"}function cg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function _N(s,o){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||u.readyState!=="loading")o();else{var d=function(){o(),u.removeEventListener("DOMContentLoaded",d)};u.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function si(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var dg=null;function vE(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(o===0)return si(s.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}s=s.nextSibling}return null}function TE(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return s;o--}else u!=="/$"&&u!=="/&"||o++}s=s.previousSibling}return null}function EE(s,o,u){switch(o=Ef(u),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function $u(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);la(s)}var ri=new Map,SE=new Set;function Sf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ws=fe.d;fe.d={f:vN,r:TN,D:EN,C:SN,L:AN,m:IN,X:CN,S:wN,M:bN};function vN(){var s=ws.f(),o=hf();return s||o}function TN(s){var o=Yn(s);o!==null&&o.tag===5&&o.type==="form"?F0(o):ws.r(s)}var za=typeof document>"u"?null:document;function AE(s,o,u){var d=za;if(d&&typeof o=="string"&&o){var y=An(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),SE.has(y)||(SE.add(y),s={rel:s,crossOrigin:u,href:o},d.querySelector(y)===null&&(o=d.createElement("link"),an(o,"link",s),Ut(o),d.head.appendChild(o)))}}function EN(s){ws.D(s),AE("dns-prefetch",s,null)}function SN(s,o){ws.C(s,o),AE("preconnect",s,o)}function AN(s,o,u){ws.L(s,o,u);var d=za;if(d&&s&&o){var y='link[rel="preload"][as="'+An(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+An(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+An(u.imageSizes)+'"]')):y+='[href="'+An(s)+'"]';var v=y;switch(o){case"style":v=Ha(s);break;case"script":v=Ka(s)}ri.has(v)||(s=T({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),ri.set(v,s),d.querySelector(y)!==null||o==="style"&&d.querySelector(Yu(v))||o==="script"&&d.querySelector(Qu(v))||(o=d.createElement("link"),an(o,"link",s),Ut(o),d.head.appendChild(o)))}}function IN(s,o){ws.m(s,o);var u=za;if(u&&s){var d=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+An(d)+'"][href="'+An(s)+'"]',v=y;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ka(s)}if(!ri.has(v)&&(s=T({rel:"modulepreload",href:s},o),ri.set(v,s),u.querySelector(y)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Qu(v)))return}d=u.createElement("link"),an(d,"link",s),Ut(d),u.head.appendChild(d)}}}function wN(s,o,u){ws.S(s,o,u);var d=za;if(d&&s){var y=Fi(d).hoistableStyles,v=Ha(s);o=o||"default";var A=y.get(v);if(!A){var b={loading:0,preload:null};if(A=d.querySelector(Yu(v)))b.loading=5;else{s=T({rel:"stylesheet",href:s,"data-precedence":o},u),(u=ri.get(v))&&fg(s,u);var O=A=d.createElement("link");Ut(O),an(O,"link",s),O._p=new Promise(function(Q,ne){O.onload=Q,O.onerror=ne}),O.addEventListener("load",function(){b.loading|=1}),O.addEventListener("error",function(){b.loading|=2}),b.loading|=4,Af(A,o,d)}A={type:"stylesheet",instance:A,count:1,state:b},y.set(v,A)}}}function CN(s,o){ws.X(s,o);var u=za;if(u&&s){var d=Fi(u).hoistableScripts,y=Ka(s),v=d.get(y);v||(v=u.querySelector(Qu(y)),v||(s=T({src:s,async:!0},o),(o=ri.get(y))&&hg(s,o),v=u.createElement("script"),Ut(v),an(v,"link",s),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(y,v))}}function bN(s,o){ws.M(s,o);var u=za;if(u&&s){var d=Fi(u).hoistableScripts,y=Ka(s),v=d.get(y);v||(v=u.querySelector(Qu(y)),v||(s=T({src:s,async:!0,type:"module"},o),(o=ri.get(y))&&hg(s,o),v=u.createElement("script"),Ut(v),an(v,"link",s),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(y,v))}}function IE(s,o,u,d){var y=(y=Le.current)?Sf(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Ha(u.href),u=Fi(y).hoistableStyles,d=u.get(o),d||(d={type:"style",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Ha(u.href);var v=Fi(y).hoistableStyles,A=v.get(s);if(A||(y=y.ownerDocument||y,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,A),(v=y.querySelector(Yu(s)))&&!v._p&&(A.instance=v,A.state.loading=5),ri.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ri.set(s,u),v||RN(y,s,u,A.state))),o&&d===null)throw Error(i(528,""));return A}if(o&&d!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Ka(u),u=Fi(y).hoistableScripts,d=u.get(o),d||(d={type:"script",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ha(s){return'href="'+An(s)+'"'}function Yu(s){return'link[rel="stylesheet"]['+s+"]"}function wE(s){return T({},s,{"data-precedence":s.precedence,precedence:null})}function RN(s,o,u,d){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=s.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),an(o,"link",u),Ut(o),s.head.appendChild(o))}function Ka(s){return'[src="'+An(s)+'"]'}function Qu(s){return"script[async]"+s}function CE(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var d=s.querySelector('style[data-href~="'+An(u.href)+'"]');if(d)return o.instance=d,Ut(d),d;var y=T({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Ut(d),an(d,"style",y),Af(d,u.precedence,s),o.instance=d;case"stylesheet":y=Ha(u.href);var v=s.querySelector(Yu(y));if(v)return o.state.loading|=4,o.instance=v,Ut(v),v;d=wE(u),(y=ri.get(y))&&fg(d,y),v=(s.ownerDocument||s).createElement("link"),Ut(v);var A=v;return A._p=new Promise(function(b,O){A.onload=b,A.onerror=O}),an(v,"link",d),o.state.loading|=4,Af(v,u.precedence,s),o.instance=v;case"script":return v=Ka(u.src),(y=s.querySelector(Qu(v)))?(o.instance=y,Ut(y),y):(d=u,(y=ri.get(v))&&(d=T({},u),hg(d,y)),s=s.ownerDocument||s,y=s.createElement("script"),Ut(y),an(y,"link",d),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Af(d,u.precedence,s));return o.instance}function Af(s,o,u){for(var d=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=d.length?d[d.length-1]:null,v=y,A=0;A<d.length;A++){var b=d[A];if(b.dataset.precedence===o)v=b;else if(v!==y)break}v?v.parentNode.insertBefore(s,v.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function fg(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function hg(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var If=null;function bE(s,o,u){if(If===null){var d=new Map,y=If=new Map;y.set(u,d)}else y=If,d=y.get(u),d||(d=new Map,y.set(u,d));if(d.has(s))return d;for(d.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var v=u[y];if(!(v[Ui]||v[Lt]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var A=v.getAttribute(o)||"";A=s+A;var b=d.get(A);b?b.push(v):d.set(A,[v])}}return d}function RE(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function xN(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function xE(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function NN(s,o,u,d){if(u.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Ha(d.href),v=o.querySelector(Yu(y));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=wf.bind(s),o.then(s,s)),u.state.loading|=4,u.instance=v,Ut(v);return}v=o.ownerDocument||o,d=wE(d),(y=ri.get(y))&&fg(d,y),v=v.createElement("link"),Ut(v);var A=v;A._p=new Promise(function(b,O){A.onload=b,A.onerror=O}),an(v,"link",d),u.instance=v}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=wf.bind(s),o.addEventListener("load",u),o.addEventListener("error",u))}}var pg=0;function MN(s,o){return s.stylesheets&&s.count===0&&bf(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var d=setTimeout(function(){if(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend){var v=s.unsuspend;s.unsuspend=null,v()}},6e4+o);0<s.imgBytes&&pg===0&&(pg=62500*dN());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend)){var v=s.unsuspend;s.unsuspend=null,v()}},(s.imgBytes>pg?50:800)+o);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(y)}}:null}function wf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Cf=null;function bf(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Cf=new Map,o.forEach(DN,s),Cf=null,wf.call(s))}function DN(s,o){if(!(o.state.loading&4)){var u=Cf.get(s);if(u)var d=u.get(null);else{u=new Map,Cf.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var A=y[v];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),d=A)}d&&u.set(null,d)}y=o.instance,A=y.getAttribute("data-precedence"),v=u.get(A)||d,v===d&&u.set(null,y),u.set(A,y),this.count++,d=wf.bind(this),y.addEventListener("load",d),y.addEventListener("error",d),v?v.parentNode.insertBefore(y,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var ju={$$typeof:q,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function PN(s,o,u,d,y,v,A,b,O){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ki(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ki(0),this.hiddenUpdates=ki(null),this.identifierPrefix=d,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function NE(s,o,u,d,y,v,A,b,O,Q,ne,re){return s=new PN(s,o,u,A,O,Q,ne,re,b),o=1,v===!0&&(o|=24),v=Ln(3,null,null,o),s.current=v,v.stateNode=s,o=$p(),o.refCount++,s.pooledCache=o,o.refCount++,v.memoizedState={element:d,isDehydrated:u,cache:o},Xp(v),s}function ME(s){return s?(s=Sa,s):Sa}function DE(s,o,u,d,y,v){y=ME(y),d.context===null?d.context=y:d.pendingContext=y,d=rr(o),d.payload={element:u},v=v===void 0?null:v,v!==null&&(d.callback=v),u=or(s,d,o),u!==null&&(xn(u,s,o),Ru(u,s,o))}function PE(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function mg(s,o){PE(s,o),(s=s.alternate)&&PE(s,o)}function VE(s){if(s.tag===13||s.tag===31){var o=ho(s,67108864);o!==null&&xn(o,s,67108864),mg(s,67108864)}}function kE(s){if(s.tag===13||s.tag===31){var o=Gn();o=eo(o);var u=ho(s,o);u!==null&&xn(u,s,o),mg(s,o)}}var Rf=!0;function VN(s,o,u,d){var y=te.T;te.T=null;var v=fe.p;try{fe.p=2,gg(s,o,u,d)}finally{fe.p=v,te.T=y}}function kN(s,o,u,d){var y=te.T;te.T=null;var v=fe.p;try{fe.p=8,gg(s,o,u,d)}finally{fe.p=v,te.T=y}}function gg(s,o,u,d){if(Rf){var y=yg(d);if(y===null)ng(s,o,d,xf,u),UE(s,d);else if(UN(y,s,o,u,d))d.stopPropagation();else if(UE(s,d),o&4&&-1<LN.indexOf(s)){for(;y!==null;){var v=Yn(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var A=Pi(v.pendingLanes);if(A!==0){var b=v;for(b.pendingLanes|=2,b.entangledLanes|=2;A;){var O=1<<31-bt(A);b.entanglements[1]|=O,A&=~O}Wi(v),(Ze&6)===0&&(df=gn()+500,Hu(0))}}break;case 31:case 13:b=ho(v,2),b!==null&&xn(b,v,2),hf(),mg(v,2)}if(v=yg(d),v===null&&ng(s,o,d,xf,u),v===y)break;y=v}y!==null&&d.stopPropagation()}else ng(s,o,d,null,u)}}function yg(s){return s=Qn(s),_g(s)}var xf=null;function _g(s){if(xf=null,s=Oi(s),s!==null){var o=a(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===31){if(s=c(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return xf=s,null}function LE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jr()){case Zl:return 2;case eu:return 8;case Hs:case Ip:return 32;case od:return 268435456;default:return 32}default:return 32}}var vg=!1,yr=null,_r=null,vr=null,Xu=new Map,Wu=new Map,Tr=[],LN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function UE(s,o){switch(s){case"focusin":case"focusout":yr=null;break;case"dragenter":case"dragleave":_r=null;break;case"mouseover":case"mouseout":vr=null;break;case"pointerover":case"pointerout":Xu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wu.delete(o.pointerId)}}function Zu(s,o,u,d,y,v){return s===null||s.nativeEvent!==v?(s={blockedOn:o,domEventName:u,eventSystemFlags:d,nativeEvent:v,targetContainers:[y]},o!==null&&(o=Yn(o),o!==null&&VE(o)),s):(s.eventSystemFlags|=d,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function UN(s,o,u,d,y){switch(o){case"focusin":return yr=Zu(yr,s,o,u,d,y),!0;case"dragenter":return _r=Zu(_r,s,o,u,d,y),!0;case"mouseover":return vr=Zu(vr,s,o,u,d,y),!0;case"pointerover":var v=y.pointerId;return Xu.set(v,Zu(Xu.get(v)||null,s,o,u,d,y)),!0;case"gotpointercapture":return v=y.pointerId,Wu.set(v,Zu(Wu.get(v)||null,s,o,u,d,y)),!0}return!1}function OE(s){var o=Oi(s.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,hi(s.priority,function(){kE(u)});return}}else if(o===31){if(o=c(u),o!==null){s.blockedOn=o,hi(s.priority,function(){kE(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Nf(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=yg(s.nativeEvent);if(u===null){u=s.nativeEvent;var d=new u.constructor(u.type,u);fu=d,u.target.dispatchEvent(d),fu=null}else return o=Yn(u),o!==null&&VE(o),s.blockedOn=u,!1;o.shift()}return!0}function FE(s,o,u){Nf(s)&&u.delete(o)}function ON(){vg=!1,yr!==null&&Nf(yr)&&(yr=null),_r!==null&&Nf(_r)&&(_r=null),vr!==null&&Nf(vr)&&(vr=null),Xu.forEach(FE),Wu.forEach(FE)}function Mf(s,o){s.blockedOn===o&&(s.blockedOn=null,vg||(vg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ON)))}var Df=null;function BE(s){Df!==s&&(Df=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Df===s&&(Df=null);for(var o=0;o<s.length;o+=3){var u=s[o],d=s[o+1],y=s[o+2];if(typeof d!="function"){if(_g(d||u)===null)continue;break}var v=Yn(u);v!==null&&(s.splice(o,3),o-=3,ym(v,{pending:!0,data:y,method:u.method,action:d},d,y))}}))}function Ja(s){function o(O){return Mf(O,s)}yr!==null&&Mf(yr,s),_r!==null&&Mf(_r,s),vr!==null&&Mf(vr,s),Xu.forEach(o),Wu.forEach(o);for(var u=0;u<Tr.length;u++){var d=Tr[u];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Tr.length&&(u=Tr[0],u.blockedOn===null);)OE(u),u.blockedOn===null&&Tr.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(d=0;d<u.length;d+=3){var y=u[d],v=u[d+1],A=y[jt]||null;if(typeof v=="function")A||BE(u);else if(A){var b=null;if(v&&v.hasAttribute("formAction")){if(y=v,A=v[jt]||null)b=A.formAction;else if(_g(y)!==null)continue}else b=A.action;typeof b=="function"?u[d+1]=b:(u.splice(d,3),d-=3),BE(u)}}}function GE(){function s(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(A){return y=A})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),d||setTimeout(u,20)}function u(){if(!d&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function Tg(s){this._internalRoot=s}Pf.prototype.render=Tg.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,d=Gn();DE(u,d,s,o,null,null)},Pf.prototype.unmount=Tg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;DE(s.current,2,null,s,null,null),hf(),o[Li]=null}};function Pf(s){this._internalRoot=s}Pf.prototype.unstable_scheduleHydration=function(s){if(s){var o=fd();s={blockedOn:null,target:s,priority:o};for(var u=0;u<Tr.length&&o!==0&&o<Tr[u].priority;u++);Tr.splice(u,0,s),u===0&&OE(s)}};var qE=e.version;if(qE!=="19.2.4")throw Error(i(527,qE,"19.2.4"));fe.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(o),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var FN={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vf.isDisabled&&Vf.supportsFiber)try{di=Vf.inject(FN),tn=Vf}catch{}}return tc.createRoot=function(s,o){if(!r(s))throw Error(i(299));var u=!1,d="",y=Q0,v=j0,A=X0;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(A=o.onRecoverableError)),o=NE(s,1,!1,null,null,u,d,null,y,v,A,GE),s[Li]=o.current,tg(s),new Tg(o)},tc.hydrateRoot=function(s,o,u){if(!r(s))throw Error(i(299));var d=!1,y="",v=Q0,A=j0,b=X0,O=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(v=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(b=u.onRecoverableError),u.formState!==void 0&&(O=u.formState)),o=NE(s,1,!0,o,u??null,d,y,O,v,A,b,GE),o.context=ME(null),u=o.current,d=Gn(),d=eo(d),y=rr(d),y.callback=null,or(u,y,d),u=d,o.current.lanes=u,Wr(o,u),Wi(o),s[Li]=o.current,tg(s),new Pf(o)},tc.version="19.2.4",tc}var WE;function jN(){if(WE)return Ag.exports;WE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ag.exports=QN(),Ag.exports}var XN=jN();const WN=Ow(XN),ZN="modulepreload",eM=function(n){return"/"+n},ZE={},tM=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let l=function(p){return Promise.all(p.map(_=>Promise.resolve(_).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=l(t.map(p=>{if(p=eM(p),p in ZE)return;ZE[p]=!0;const _=p.endsWith(".css"),T=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${T}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":ZN,_||(E.as="script"),E.crossOrigin="",E.href=p,f&&E.setAttribute("nonce",f),document.head.appendChild(E),_)return new Promise((C,x)=>{E.addEventListener("load",C),E.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},ln=[];for(let n=0;n<256;++n)ln.push((n+256).toString(16).slice(1));function nM(n,e=0){return(ln[n[e+0]]+ln[n[e+1]]+ln[n[e+2]]+ln[n[e+3]]+"-"+ln[n[e+4]]+ln[n[e+5]]+"-"+ln[n[e+6]]+ln[n[e+7]]+"-"+ln[n[e+8]]+ln[n[e+9]]+"-"+ln[n[e+10]]+ln[n[e+11]]+ln[n[e+12]]+ln[n[e+13]]+ln[n[e+14]]+ln[n[e+15]]).toLowerCase()}let bg;const iM=new Uint8Array(16);function sM(){if(!bg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");bg=crypto.getRandomValues.bind(crypto)}return bg(iM)}const rM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),eS={randomUUID:rM};function oM(n,e,t){var r;n=n||{};const i=n.random??((r=n.rng)==null?void 0:r.call(n))??sM();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,nM(i)}function Co(n,e,t){return eS.randomUUID&&!n?eS.randomUUID():oM(n)}var bs=(n=>(n.PENDING="pending",n.PARSED="parsed",n.SAVED_RAW="saved_raw",n.ERROR="error",n))(bs||{}),oi=(n=>(n.HABITAT="HABITAT",n.PLANT="PLANT",n.PLANT_GROUP="PLANT_GROUP",n.ORGANISM="ORGANISM",n.COLONY="COLONY",n))(oi||{});const aM=Object.prototype.toString,lM=n=>aM.call(n)==="[object Error]",uM=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function cM(n){if(!(n&&lM(n)&&n.name==="TypeError"&&typeof n.message=="string"))return!1;const{message:t,stack:i}=n;return t==="Load failed"?i===void 0||"__sentry_captured__"in n:t.startsWith("error sending request for url")?!0:uM.has(t)}function dM(n){if(typeof n=="number"){if(n<0)throw new TypeError("Expected `retries` to be a non-negative number.");if(Number.isNaN(n))throw new TypeError("Expected `retries` to be a valid number or Infinity, got NaN.")}else if(n!==void 0)throw new TypeError("Expected `retries` to be a number or Infinity.")}function kf(n,e,{min:t=0,allowInfinity:i=!1}={}){if(e!==void 0){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected \`${n}\` to be a number${i?" or Infinity":""}.`);if(!i&&!Number.isFinite(e))throw new TypeError(`Expected \`${n}\` to be a finite number.`);if(e<t)throw new TypeError(`Expected \`${n}\` to be  ${t}.`)}}class Fw extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}function fM(n,e){const t=Math.max(1,n+1),i=e.randomize?Math.random()+1:1;let r=Math.round(i*e.minTimeout*e.factor**(t-1));return r=Math.min(r,e.maxTimeout),r}function tS(n,e){return Number.isFinite(e)?e-(performance.now()-n):e}async function hM({error:n,attemptNumber:e,retriesConsumed:t,startTime:i,options:r}){var C,x,P,k;const a=n instanceof Error?n:new TypeError(`Non-error was thrown: "${n}". You should only throw errors.`);if(a instanceof Fw)throw a.originalError;const l=Number.isFinite(r.retries)?Math.max(0,r.retries-t):r.retries,c=r.maxRetryTime??Number.POSITIVE_INFINITY,f=Object.freeze({error:a,attemptNumber:e,retriesLeft:l,retriesConsumed:t});if(await r.onFailedAttempt(f),tS(i,c)<=0)throw a;const p=await r.shouldConsumeRetry(f),_=tS(i,c);if(_<=0||l<=0)throw a;if(a instanceof TypeError&&!cM(a)){if(p)throw a;return(C=r.signal)==null||C.throwIfAborted(),!1}if(!await r.shouldRetry(f))throw a;if(!p)return(x=r.signal)==null||x.throwIfAborted(),!1;const T=fM(t,r),E=Math.min(T,_);return(P=r.signal)==null||P.throwIfAborted(),E>0&&await new Promise((K,W)=>{var ae,z;const q=()=>{var N;clearTimeout(ee),(N=r.signal)==null||N.removeEventListener("abort",q),W(r.signal.reason)},ee=setTimeout(()=>{var N;(N=r.signal)==null||N.removeEventListener("abort",q),K()},E);r.unref&&((ae=ee.unref)==null||ae.call(ee)),(z=r.signal)==null||z.addEventListener("abort",q,{once:!0})}),(k=r.signal)==null||k.throwIfAborted(),!0}async function pM(n,e={}){var a,l,c;if(e={...e},dM(e.retries),Object.hasOwn(e,"forever"))throw new Error("The `forever` option is no longer supported. For many use-cases, you can set `retries: Infinity` instead.");e.retries??(e.retries=10),e.factor??(e.factor=2),e.minTimeout??(e.minTimeout=1e3),e.maxTimeout??(e.maxTimeout=Number.POSITIVE_INFINITY),e.maxRetryTime??(e.maxRetryTime=Number.POSITIVE_INFINITY),e.randomize??(e.randomize=!1),e.onFailedAttempt??(e.onFailedAttempt=()=>{}),e.shouldRetry??(e.shouldRetry=()=>!0),e.shouldConsumeRetry??(e.shouldConsumeRetry=()=>!0),kf("factor",e.factor,{min:0,allowInfinity:!1}),kf("minTimeout",e.minTimeout,{min:0,allowInfinity:!1}),kf("maxTimeout",e.maxTimeout,{min:0,allowInfinity:!0}),kf("maxRetryTime",e.maxRetryTime,{min:0,allowInfinity:!0}),e.factor>0||(e.factor=1),(a=e.signal)==null||a.throwIfAborted();let t=0,i=0;const r=performance.now();for(;!Number.isFinite(e.retries)||i<=e.retries;){t++;try{(l=e.signal)==null||l.throwIfAborted();const f=await n(t);return(c=e.signal)==null||c.throwIfAborted(),f}catch(f){await hM({error:f,attemptNumber:t,retriesConsumed:i,startTime:r,options:e})&&i++}}throw new Error("Retry attempts exhausted without throwing an error.")}var mM={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gM,yM;function _M(){return{geminiUrl:gM,vertexUrl:yM}}function vM(n,e,t,i){var r,a;if(!(n!=null&&n.baseUrl)){const l=_M();return e?(r=l.vertexUrl)!==null&&r!==void 0?r:t:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fs{}function me(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function m(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in n))if(Array.isArray(t))n[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[c])){const f=n[c];if(Array.isArray(t))for(let p=0;p<f.length;p++){const _=f[p];m(_,e.slice(a+1),t[p])}else for(const p of f)m(p,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in n||(n[c]=[{}]);const f=n[c];m(f[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in n){const l=n[a];return Array.isArray(l)?l.map(c=>h(c,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function TM(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),a=i.split("."),l=new Set;let c=-1;for(let f=0;f<r.length;f++)if(r[f]==="*"){c=f;break}if(c!==-1&&a.length>c)for(let f=c;f<a.length;f++){const p=a[f];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&l.add(p)}Xg(n,r,a,0,l)}}function Xg(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2),c=n;if(l in c&&Array.isArray(c[l]))for(const f of c[l])Xg(f,e,t,i+1,r)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,c=Object.keys(l).filter(p=>!p.startsWith("_")&&!r.has(p)),f={};for(const p of c)f[p]=l[p];for(const[p,_]of Object.entries(f)){const T=[];for(const E of t.slice(i))E==="*"?T.push(p):T.push(E);m(l,T,_)}for(const p of c)delete l[p]}}else{const l=n;a in l&&Xg(l[a],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xy(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EM(n){const e={},t=h(n,["operationName"]);t!=null&&m(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&m(e,["_url","resourceName"],i),e}function SM(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],IM(l)),e}function AM(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],wM(l)),e}function IM(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>CM(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const r=h(n,["raiMediaFilteredReasons"]);return r!=null&&m(e,["raiMediaFilteredReasons"],r),e}function wM(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>bM(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const r=h(n,["raiMediaFilteredReasons"]);return r!=null&&m(e,["raiMediaFilteredReasons"],r),e}function CM(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],PM(t)),e}function bM(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],VM(t)),e}function RM(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function xM(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function NM(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],MM(l)),e}function MM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const r=h(n,["documentName"]);return r!=null&&m(e,["documentName"],r),e}function Bw(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],DM(l)),e}function DM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const r=h(n,["documentName"]);return r!=null&&m(e,["documentName"],r),e}function PM(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],Xy(i));const r=h(n,["encoding"]);return r!=null&&m(e,["mimeType"],r),e}function VM(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],Xy(i));const r=h(n,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var nS;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(nS||(nS={}));var iS;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(iS||(iS={}));var sS;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(sS||(sS={}));var de;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(de||(de={}));var rS;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(rS||(rS={}));var oS;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(oS||(oS={}));var aS;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(aS||(aS={}));var lS;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(lS||(lS={}));var uS;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(uS||(uS={}));var cS;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(cS||(cS={}));var dS;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(dS||(dS={}));var fS;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(fS||(fS={}));var hS;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(hS||(hS={}));var pS;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(pS||(pS={}));var mS;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(mS||(mS={}));var gS;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(gS||(gS={}));var yS;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(yS||(yS={}));var _S;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(_S||(_S={}));var vS;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(vS||(vS={}));var TS;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(TS||(TS={}));var ES;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ES||(ES={}));var yh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(yh||(yh={}));var SS;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(SS||(SS={}));var AS;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(AS||(AS={}));var IS;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(IS||(IS={}));var Wg;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Wg||(Wg={}));var wS;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(wS||(wS={}));var CS;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(CS||(CS={}));var Zg;(function(n){n.COLLECTION="COLLECTION"})(Zg||(Zg={}));var bS;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(bS||(bS={}));var RS;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(RS||(RS={}));var xS;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(xS||(xS={}));var NS;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(NS||(NS={}));var MS;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(MS||(MS={}));var DS;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(DS||(DS={}));var PS;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(PS||(PS={}));var VS;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(VS||(VS={}));var kS;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(kS||(kS={}));var LS;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(LS||(LS={}));var US;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(US||(US={}));var OS;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(OS||(OS={}));var FS;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(FS||(FS={}));var BS;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(BS||(BS={}));var GS;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(GS||(GS={}));var qS;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(qS||(qS={}));var zS;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(zS||(zS={}));var HS;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(HS||(HS={}));var KS;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(KS||(KS={}));var JS;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(JS||(JS={}));var $S;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})($S||($S={}));var YS;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(YS||(YS={}));var QS;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(QS||(QS={}));var jS;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(jS||(jS={}));var XS;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(XS||(XS={}));var WS;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(WS||(WS={}));var ZS;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(ZS||(ZS={}));var rl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(rl||(rl={}));class ey{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class nc{get text(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",_=!1;const T=[];for(const E of(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[C,x]of Object.entries(E))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(x!==null||x!==void 0)&&T.push(C);if(typeof E.text=="string"){if(typeof E.thought=="boolean"&&E.thought)continue;_=!0,p+=E.text}}return T.length>0&&console.warn(`there are non-text parts ${T} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?p:void 0}get data(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const _=[];for(const T of(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&f!==void 0?f:[]){for(const[E,C]of Object.entries(T))E!=="inlineData"&&(C!==null||C!==void 0)&&_.push(E);T.inlineData&&typeof T.inlineData.data=="string"&&(p+=atob(T.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,a,l,c,f;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,a,l,c,f,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(T=>T.executableCode).map(T=>T.executableCode).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,a,l,c,f,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(c=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||f===void 0?void 0:f.filter(T=>T.codeExecutionResult).map(T=>T.codeExecutionResult).filter(T=>T!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.output}}class eA{}class tA{}class kM{}class LM{}class UM{}class OM{}class nA{}class iA{}class sA{}class FM{}class _h{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _h;let r;const a=e;return t?r=AM(a):r=SM(a),Object.assign(i,r),i}}class rA{}class oA{}class aA{}class lA{}class BM{}class GM{}class qM{}class Wy{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Wy,a=NM(e);return Object.assign(i,a),i}}class zM{}class HM{}class KM{}class JM{}class uA{}class $M{get text(){var e,t,i;let r="",a=!1;const l=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,p]of Object.entries(c))f!=="text"&&f!=="thought"&&p!==null&&l.push(f);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;a=!0,r+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,t,i;let r="";const a=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[c,f]of Object.entries(l))c!=="inlineData"&&f!==null&&a.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(r+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class YM{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Zy{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Zy,a=Bw(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Xe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Gw(n,e){const t=Xe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function qw(n){return Array.isArray(n)?n.map(e=>vh(e)):[vh(n)]}function vh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function zw(n){const e=vh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Hw(n){const e=vh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function cA(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Kw(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>cA(e)):[cA(n)]}function ty(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function dA(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function fA(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function pn(n){if(n==null)throw new Error("ContentUnion is required");return ty(n)?n:{role:"user",parts:Kw(n)}}function e_(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=pn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=pn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>pn(t)):[pn(e)]}function ui(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(dA(n)||fA(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[pn(n)]}const e=[],t=[],i=ty(n[0]);for(const r of n){const a=ty(r);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(dA(r)||fA(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:Kw(t)}),e}function QM(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(de).includes(t[0].toUpperCase())?t[0].toUpperCase():de.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(de).includes(i.toUpperCase())?i.toUpperCase():de.TYPE_UNSPECIFIED})}}function ll(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&QM(n.type,e);for(const[l,c]of Object.entries(n))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(de).includes(c.toUpperCase())?c.toUpperCase():de.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=ll(c);else if(i.includes(l)){const f=[];for(const p of c){if(p.type=="null"){e.nullable=!0;continue}f.push(ll(p))}e[l]=f}else if(r.includes(l)){const f={};for(const[p,_]of Object.entries(c))f[p]=ll(_);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=c}return e}function t_(n){return ll(n)}function n_(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function i_(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Ol(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ll(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ll(e.response));return n}function Fl(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function jM(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Bs(n,e){if(typeof e!="string")throw new Error("name must be a string");return jM(n,e,"cachedContents")}function Jw(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function qr(n){return Xy(n)}function XM(n){return n!=null&&typeof n=="object"&&"name"in n}function WM(n){return n!=null&&typeof n=="object"&&"video"in n}function ZM(n){return n!=null&&typeof n=="object"&&"uri"in n}function $w(n){var e;let t;if(XM(n)&&(t=n.name),!(ZM(n)&&(t=n.uri,t===void 0))&&!(WM(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Yw(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function Qw(n){for(const e of["models","tunedModels","publisherModels"])if(eD(n,e))return n[e];return[]}function eD(n,e){return n!==null&&typeof n=="object"&&e in n}function tD(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function nD(n,e={}){const t=[],i=new Set;for(const r of n){const a=r.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=tD(r,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function jw(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function iD(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Xw(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let a=!1;for(const l of r){if(typeof l!="object"||l===null)continue;const f=l.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Bl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Ww(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sD(n){const e={},t=h(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>OD(l))),m(e,["inlinedResponses"],a)}const r=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["inlinedEmbedContentResponses"],a)}return e}function rD(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&m(e,["gcsUri"],i);const r=h(n,["bigqueryDestination","outputUri"]);return r!=null&&m(e,["bigqueryUri"],r),e}function oD(n){const e={},t=h(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsDestination","outputUriPrefix"],i);const r=h(n,["bigqueryUri"]);if(r!=null&&m(e,["bigqueryDestination","outputUri"],r),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Zf(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&m(e,["displayName"],i);const r=h(n,["metadata","state"]);r!=null&&m(e,["state"],Ww(r));const a=h(n,["metadata","createTime"]);a!=null&&m(e,["createTime"],a);const l=h(n,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(n,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const f=h(n,["metadata","model"]);f!=null&&m(e,["model"],f);const p=h(n,["metadata","output"]);return p!=null&&m(e,["dest"],sD(Xw(p))),e}function ny(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const r=h(n,["state"]);r!=null&&m(e,["state"],Ww(r));const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(n,["startTime"]);c!=null&&m(e,["startTime"],c);const f=h(n,["endTime"]);f!=null&&m(e,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(e,["updateTime"],p);const _=h(n,["model"]);_!=null&&m(e,["model"],_);const T=h(n,["inputConfig"]);T!=null&&m(e,["src"],aD(T));const E=h(n,["outputConfig"]);E!=null&&m(e,["dest"],rD(Xw(E)));const C=h(n,["completionStats"]);return C!=null&&m(e,["completionStats"],C),e}function aD(n){const e={},t=h(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&m(e,["gcsUri"],i);const r=h(n,["bigquerySource","inputUri"]);return r!=null&&m(e,["bigqueryUri"],r),e}function lD(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&m(t,["fileName"],i);const r=h(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>UD(n,l))),m(t,["requests","requests"],a)}return t}function uD(n){const e={},t=h(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsSource","uris"],i);const r=h(n,["bigqueryUri"]);if(r!=null&&m(e,["bigquerySource","inputUri"],r),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function cD(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function dD(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function fD(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function hD(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],pD(i));const r=h(n,["tokenCount"]);r!=null&&m(e,["tokenCount"],r);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const l=h(n,["avgLogprobs"]);l!=null&&m(e,["avgLogprobs"],l);const c=h(n,["groundingMetadata"]);c!=null&&m(e,["groundingMetadata"],c);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(C=>C)),m(e,["safetyRatings"],E)}const T=h(n,["urlContextMetadata"]);return T!=null&&m(e,["urlContextMetadata"],T),e}function pD(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),m(e,["citations"],i)}return e}function Zw(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>KD(a))),m(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function mD(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&m(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function gD(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const r=h(n,["dest"]);return e!==void 0&&r!=null&&m(e,["outputConfig"],oD(iD(r))),t}function hA(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Xe(n,i));const r=h(e,["src"]);r!=null&&m(t,["batch","inputConfig"],lD(n,jw(n,r)));const a=h(e,["config"]);return a!=null&&mD(a,t),t}function yD(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],Xe(n,i));const r=h(e,["src"]);r!=null&&m(t,["inputConfig"],uD(jw(n,r)));const a=h(e,["config"]);return a!=null&&gD(a,t),t}function _D(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["batch","displayName"],i),t}function vD(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Xe(n,i));const r=h(e,["src"]);r!=null&&m(t,["batch","inputConfig"],CD(n,r));const a=h(e,["config"]);return a!=null&&_D(a,t),t}function TD(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function ED(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function SD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function AD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function ID(n,e){const t={},i=h(e,["contents"]);if(i!=null){let a=e_(n,i);Array.isArray(a)&&(a=a.map(l=>l)),m(t,["requests[]","request","content"],a)}const r=h(e,["config"]);return r!=null&&(m(t,["_self"],wD(r,t)),TM(t,{"requests[].*":"requests[].request.*"})),t}function wD(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const r=h(n,["title"]);e!==void 0&&r!=null&&m(e,["requests[]","title"],r);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function CD(n,e){const t={},i=h(e,["fileName"]);i!=null&&m(t,["file_name"],i);const r=h(e,["inlinedRequests"]);return r!=null&&m(t,["requests"],ID(n,r)),t}function bD(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function RD(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const r=h(n,["name"]);if(r!=null&&m(e,["name"],r),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xD(n){const e={},t=h(n,["allowedFunctionNames"]);t!=null&&m(e,["allowedFunctionNames"],t);const i=h(n,["mode"]);if(i!=null&&m(e,["mode"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ND(n,e,t){const i={},r=h(e,["systemInstruction"]);t!==void 0&&r!=null&&m(t,["systemInstruction"],Zw(pn(r)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const c=h(e,["topK"]);c!=null&&m(i,["topK"],c);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const T=h(e,["responseLogprobs"]);T!=null&&m(i,["responseLogprobs"],T);const E=h(e,["logprobs"]);E!=null&&m(i,["logprobs"],E);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const x=h(e,["frequencyPenalty"]);x!=null&&m(i,["frequencyPenalty"],x);const P=h(e,["seed"]);P!=null&&m(i,["seed"],P);const k=h(e,["responseMimeType"]);k!=null&&m(i,["responseMimeType"],k);const K=h(e,["responseSchema"]);K!=null&&m(i,["responseSchema"],t_(K));const W=h(e,["responseJsonSchema"]);if(W!=null&&m(i,["responseJsonSchema"],W),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const q=h(e,["safetySettings"]);if(t!==void 0&&q!=null){let V=q;Array.isArray(V)&&(V=V.map(ke=>JD(ke))),m(t,["safetySettings"],V)}const ee=h(e,["tools"]);if(t!==void 0&&ee!=null){let V=Fl(ee);Array.isArray(V)&&(V=V.map(ke=>YD(Ol(ke)))),m(t,["tools"],V)}const ae=h(e,["toolConfig"]);if(t!==void 0&&ae!=null&&m(t,["toolConfig"],$D(ae)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=h(e,["cachedContent"]);t!==void 0&&z!=null&&m(t,["cachedContent"],Bs(n,z));const N=h(e,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const M=h(e,["mediaResolution"]);M!=null&&m(i,["mediaResolution"],M);const D=h(e,["speechConfig"]);if(D!=null&&m(i,["speechConfig"],n_(D)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&m(i,["thinkingConfig"],L);const U=h(e,["imageConfig"]);U!=null&&m(i,["imageConfig"],LD(U));const G=h(e,["enableEnhancedCivicAnswers"]);if(G!=null&&m(i,["enableEnhancedCivicAnswers"],G),h(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function MD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>hD(p))),m(e,["candidates"],f)}const r=h(n,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const l=h(n,["responseId"]);l!=null&&m(e,["responseId"],l);const c=h(n,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function DD(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function PD(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bl(n,i)),t}function VD(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function kD(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function LD(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function UD(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["request","model"],Xe(n,i));const r=h(e,["contents"]);if(r!=null){let c=ui(r);Array.isArray(c)&&(c=c.map(f=>Zw(f))),m(t,["request","contents"],c)}const a=h(e,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(e,["config"]);return l!=null&&m(t,["request","generationConfig"],ND(n,l,h(t,["request"],{}))),t}function OD(n){const e={},t=h(n,["response"]);t!=null&&m(e,["response"],MD(t));const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["error"]);return r!=null&&m(e,["error"],r),e}function FD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);if(e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function BD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);e!==void 0&&r!=null&&m(e,["_query","pageToken"],r);const a=h(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),t}function GD(n){const e={},t=h(n,["config"]);return t!=null&&FD(t,e),e}function qD(n){const e={},t=h(n,["config"]);return t!=null&&BD(t,e),e}function zD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Zf(l))),m(e,["batchJobs"],a)}return e}function HD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>ny(l))),m(e,["batchJobs"],a)}return e}function KD(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const r=h(n,["executableCode"]);r!=null&&m(e,["executableCode"],r);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],bD(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],RD(l));const c=h(n,["functionResponse"]);c!=null&&m(e,["functionResponse"],c);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],cD(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const T=h(n,["thoughtSignature"]);T!=null&&m(e,["thoughtSignature"],T);const E=h(n,["videoMetadata"]);return E!=null&&m(e,["videoMetadata"],E),e}function JD(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function $D(n){const e={},t=h(n,["retrievalConfig"]);t!=null&&m(e,["retrievalConfig"],t);const i=h(n,["functionCallingConfig"]);return i!=null&&m(e,["functionCallingConfig"],xD(i)),e}function YD(n){const e={};if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=h(n,["computerUse"]);t!=null&&m(e,["computerUse"],t);const i=h(n,["fileSearch"]);i!=null&&m(e,["fileSearch"],i);const r=h(n,["codeExecution"]);if(r!=null&&m(e,["codeExecution"],r),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=h(n,["functionDeclarations"]);if(a!=null){let _=a;Array.isArray(_)&&(_=_.map(T=>T)),m(e,["functionDeclarations"],_)}const l=h(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],VD(l));const c=h(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],kD(c));const f=h(n,["googleSearchRetrieval"]);f!=null&&m(e,["googleSearchRetrieval"],f);const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ps;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Ps||(Ps={}));class ea{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(r=l.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QD extends Fs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ea(Ps.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=hA(this.apiClient,e),i=t._url,r=me("{model}:batchGenerateContent",i),c=t.batch.inputConfig.requests,f=c.requests,p=[];for(const _ of f){const T=Object.assign({},_);if(T.systemInstruction){const E=T.systemInstruction;delete T.systemInstruction;const C=T.request;C.systemInstruction=E,T.request=C}p.push(T)}return c.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${r}`;else if(l)i.dest=`${l}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=yD(this.apiClient,e);return c=me("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>ny(_))}else{const p=hA(this.apiClient,e);return c=me("{model}:batchGenerateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Zf(_))}}async createEmbeddingsInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=vD(this.apiClient,e);return a=me("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>Zf(f))}}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=PD(this.apiClient,e);return c=me("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>ny(_))}else{const p=DD(this.apiClient,e);return c=me("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Zf(_))}}async cancel(e){var t,i,r,a;let l="",c={};if(this.apiClient.isVertexAI()){const f=fD(this.apiClient,e);l=me("batchPredictionJobs/{name}:cancel",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=dD(this.apiClient,e);l=me("batches/{name}:cancel",f._url),c=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=qD(e);return c=me("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=HD(_),E=new uA;return Object.assign(E,T),E})}else{const p=GD(e);return c=me("batches",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=zD(_),E=new uA;return Object.assign(E,T),E})}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=ED(this.apiClient,e);return c=me("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>AD(_))}else{const p=TD(this.apiClient,e);return c=me("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>SD(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jD(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function pA(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>v2(a))),m(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function XD(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const r=h(n,["expireTime"]);e!==void 0&&r!=null&&m(e,["expireTime"],r);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let _=ui(l);Array.isArray(_)&&(_=_.map(T=>pA(T))),m(e,["contents"],_)}const c=h(n,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],pA(pn(c)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>E2(T))),m(e,["tools"],_)}const p=h(n,["toolConfig"]);if(e!==void 0&&p!=null&&m(e,["toolConfig"],T2(p)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function WD(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const r=h(n,["expireTime"]);e!==void 0&&r!=null&&m(e,["expireTime"],r);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let T=ui(l);Array.isArray(T)&&(T=T.map(E=>E)),m(e,["contents"],T)}const c=h(n,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],pn(c));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let T=f;Array.isArray(T)&&(T=T.map(E=>S2(E))),m(e,["tools"],T)}const p=h(n,["toolConfig"]);e!==void 0&&p!=null&&m(e,["toolConfig"],p);const _=h(n,["kmsKeyName"]);return e!==void 0&&_!=null&&m(e,["encryption_spec","kmsKeyName"],_),t}function ZD(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],Gw(n,i));const r=h(e,["config"]);return r!=null&&XD(r,t),t}function e2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],Gw(n,i));const r=h(e,["config"]);return r!=null&&WD(r,t),t}function t2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bs(n,i)),t}function n2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bs(n,i)),t}function i2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function s2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function r2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function o2(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const r=h(n,["name"]);if(r!=null&&m(e,["name"],r),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function a2(n){const e={},t=h(n,["allowedFunctionNames"]);t!=null&&m(e,["allowedFunctionNames"],t);const i=h(n,["mode"]);if(i!=null&&m(e,["mode"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function l2(n){const e={},t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const r=h(n,["parameters"]);r!=null&&m(e,["parameters"],r);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const c=h(n,["responseJsonSchema"]);if(c!=null&&m(e,["responseJsonSchema"],c),h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function u2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bs(n,i)),t}function c2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Bs(n,i)),t}function d2(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function f2(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function h2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),t}function p2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),t}function m2(n){const e={},t=h(n,["config"]);return t!=null&&h2(t,e),e}function g2(n){const e={},t=h(n,["config"]);return t!=null&&p2(t,e),e}function y2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function _2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function v2(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const r=h(n,["executableCode"]);r!=null&&m(e,["executableCode"],r);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],r2(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],o2(l));const c=h(n,["functionResponse"]);c!=null&&m(e,["functionResponse"],c);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],jD(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const T=h(n,["thoughtSignature"]);T!=null&&m(e,["thoughtSignature"],T);const E=h(n,["videoMetadata"]);return E!=null&&m(e,["videoMetadata"],E),e}function T2(n){const e={},t=h(n,["retrievalConfig"]);t!=null&&m(e,["retrievalConfig"],t);const i=h(n,["functionCallingConfig"]);return i!=null&&m(e,["functionCallingConfig"],a2(i)),e}function E2(n){const e={};if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=h(n,["computerUse"]);t!=null&&m(e,["computerUse"],t);const i=h(n,["fileSearch"]);i!=null&&m(e,["fileSearch"],i);const r=h(n,["codeExecution"]);if(r!=null&&m(e,["codeExecution"],r),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=h(n,["functionDeclarations"]);if(a!=null){let _=a;Array.isArray(_)&&(_=_.map(T=>T)),m(e,["functionDeclarations"],_)}const l=h(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],d2(l));const c=h(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],f2(c));const f=h(n,["googleSearchRetrieval"]);f!=null&&m(e,["googleSearchRetrieval"],f);const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function S2(n){const e={},t=h(n,["retrieval"]);t!=null&&m(e,["retrieval"],t);const i=h(n,["computerUse"]);if(i!=null&&m(e,["computerUse"],i),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=h(n,["codeExecution"]);r!=null&&m(e,["codeExecution"],r);const a=h(n,["enterpriseWebSearch"]);a!=null&&m(e,["enterpriseWebSearch"],a);const l=h(n,["functionDeclarations"]);if(l!=null){let T=l;Array.isArray(T)&&(T=T.map(E=>l2(E))),m(e,["functionDeclarations"],T)}const c=h(n,["googleMaps"]);c!=null&&m(e,["googleMaps"],c);const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],f);const p=h(n,["googleSearchRetrieval"]);p!=null&&m(e,["googleSearchRetrieval"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function A2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const r=h(n,["expireTime"]);return e!==void 0&&r!=null&&m(e,["expireTime"],r),t}function I2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const r=h(n,["expireTime"]);return e!==void 0&&r!=null&&m(e,["expireTime"],r),t}function w2(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Bs(n,i));const r=h(e,["config"]);return r!=null&&A2(r,t),t}function C2(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Bs(n,i));const r=h(e,["config"]);return r!=null&&I2(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class b2 extends Fs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ea(Ps.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=e2(this.apiClient,e);return c=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=ZD(this.apiClient,e);return c=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=c2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=u2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=n2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=s2(_),E=new aA;return Object.assign(E,T),E})}else{const p=t2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=i2(_),E=new aA;return Object.assign(E,T),E})}}async update(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=C2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=w2(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=g2(e);return c=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=_2(_),E=new lA;return Object.assign(E,T),E})}else{const p=m2(e);return c=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=y2(_),E=new lA;return Object.assign(E,T),E})}}}function Th(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function mA(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Me(n){return this instanceof Me?(this.v=n,this):new Me(n)}function Ci(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),r[Symbol.asyncIterator]=function(){return this},r;function l(C){return function(x){return Promise.resolve(x).then(C,T)}}function c(C,x){i[C]&&(r[C]=function(P){return new Promise(function(k,K){a.push([C,P,k,K])>1||f(C,P)})},x&&(r[C]=x(r[C])))}function f(C,x){try{p(i[C](x))}catch(P){E(a[0][3],P)}}function p(C){C.value instanceof Me?Promise.resolve(C.value.v).then(_,T):E(a[0][2],C)}function _(C){f("next",C)}function T(C){f("throw",C)}function E(C,x){C(x),a.shift(),a.length&&f(a[0][0],a[0][1])}}function bi(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof mA=="function"?mA(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(l){return new Promise(function(c,f){l=n[a](l),r(c,f,l.done,l.value)})}}function r(a,l,c,f){Promise.resolve(f).then(function(p){a({value:p,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R2(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:eC(t)}function eC(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function x2(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function gA(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let a=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),a&&!eC(n[i])&&(a=!1),i++;a?e.push(...r):e.pop()}return e}class N2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new M2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class M2{constructor(e,t,i,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),x2(a)}async sendMessage(e){var t;await this.sendPromise;const i=pn(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,c;const f=await r,p=(l=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,_=f.automaticFunctionCallingHistory,T=this.getHistory(!0).length;let E=[];_!=null&&(E=(c=_.slice(T))!==null&&c!==void 0?c:[]);const C=p?[p]:[];this.recordHistory(i,C,E)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=pn(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?gA(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Ci(this,arguments,function*(){var r,a,l,c,f,p;const _=[];try{for(var T=!0,E=bi(e),C;C=yield Me(E.next()),r=C.done,!r;T=!0){c=C.value,T=!1;const x=c;if(R2(x)){const P=(p=(f=x.candidates)===null||f===void 0?void 0:f[0])===null||p===void 0?void 0:p.content;P!==void 0&&_.push(P)}yield yield Me(x)}}catch(x){a={error:x}}finally{try{!T&&!r&&(l=E.return)&&(yield Me(l.call(E)))}finally{if(a)throw a.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(a=>a.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...gA(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Rc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function D2(n){const e={},t=h(n,["file"]);return t!=null&&m(e,["file"],t),e}function P2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function V2(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],$w(t)),e}function k2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function L2(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],$w(t)),e}function U2(n){const e={},t=h(n,["uris"]);return t!=null&&m(e,["uris"],t),e}function O2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),t}function F2(n){const e={},t=h(n,["config"]);return t!=null&&O2(t,e),e}function B2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["files"],a)}return e}function G2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["files"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q2 extends Fs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ea(Ps.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async registerFiles(e){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(e){return this.registerFilesInternal(e)}async listInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=F2(e);return a=me("files",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const p=B2(f),_=new zM;return Object.assign(_,p),_})}}async createInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=D2(e);return a=me("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=P2(f),_=new HM;return Object.assign(_,p),_})}}async get(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=L2(e);return a=me("files/{file}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>f)}}async delete(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=V2(e);return a=me("files/{file}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const p=k2(f),_=new KM;return Object.assign(_,p),_})}}async registerFilesInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=U2(e);return a=me("files:register",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=G2(f),_=new JM;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eh(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function z2(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>rP(a))),m(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function H2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function K2(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const r=h(n,["name"]);if(r!=null&&m(e,["name"],r),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function J2(n){const e={},t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const r=h(n,["parameters"]);r!=null&&m(e,["parameters"],r);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const c=h(n,["responseJsonSchema"]);if(c!=null&&m(e,["responseJsonSchema"],c),h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function $2(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const r=h(n,["audioTimestamp"]);r!=null&&m(e,["audioTimestamp"],r);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&m(e,["enableAffectiveDialog"],l);const c=h(n,["frequencyPenalty"]);c!=null&&m(e,["frequencyPenalty"],c);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const T=h(n,["presencePenalty"]);T!=null&&m(e,["presencePenalty"],T);const E=h(n,["responseLogprobs"]);E!=null&&m(e,["responseLogprobs"],E);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const x=h(n,["responseModalities"]);x!=null&&m(e,["responseModalities"],x);const P=h(n,["responseSchema"]);P!=null&&m(e,["responseSchema"],P);const k=h(n,["routingConfig"]);k!=null&&m(e,["routingConfig"],k);const K=h(n,["seed"]);K!=null&&m(e,["seed"],K);const W=h(n,["speechConfig"]);W!=null&&m(e,["speechConfig"],W);const q=h(n,["stopSequences"]);q!=null&&m(e,["stopSequences"],q);const ee=h(n,["temperature"]);ee!=null&&m(e,["temperature"],ee);const ae=h(n,["thinkingConfig"]);ae!=null&&m(e,["thinkingConfig"],ae);const z=h(n,["topK"]);z!=null&&m(e,["topK"],z);const N=h(n,["topP"]);if(N!=null&&m(e,["topP"],N),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Y2(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function Q2(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function j2(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const T=h(n,["speechConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","speechConfig"],i_(T));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","thinkingConfig"],E);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const x=h(n,["systemInstruction"]);e!==void 0&&x!=null&&m(e,["setup","systemInstruction"],z2(pn(x)));const P=h(n,["tools"]);if(e!==void 0&&P!=null){let z=Fl(P);Array.isArray(z)&&(z=z.map(N=>aP(Ol(N)))),m(e,["setup","tools"],z)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],oP(k));const K=h(n,["inputAudioTranscription"]);e!==void 0&&K!=null&&m(e,["setup","inputAudioTranscription"],K);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&m(e,["setup","outputAudioTranscription"],W);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&m(e,["setup","contextWindowCompression"],ee);const ae=h(n,["proactivity"]);if(e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function X2(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],$2(i));const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const T=h(n,["speechConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","speechConfig"],i_(T));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","thinkingConfig"],E);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const x=h(n,["systemInstruction"]);e!==void 0&&x!=null&&m(e,["setup","systemInstruction"],pn(x));const P=h(n,["tools"]);if(e!==void 0&&P!=null){let N=Fl(P);Array.isArray(N)&&(N=N.map(M=>lP(Ol(M)))),m(e,["setup","tools"],N)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],k);const K=h(n,["inputAudioTranscription"]);e!==void 0&&K!=null&&m(e,["setup","inputAudioTranscription"],K);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&m(e,["setup","outputAudioTranscription"],W);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&m(e,["setup","contextWindowCompression"],ee);const ae=h(n,["proactivity"]);e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae);const z=h(n,["explicitVadSignal"]);return e!==void 0&&z!=null&&m(e,["setup","explicitVadSignal"],z),t}function W2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Xe(n,i));const r=h(e,["config"]);return r!=null&&m(t,["config"],j2(r,t)),t}function Z2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Xe(n,i));const r=h(e,["config"]);return r!=null&&m(t,["config"],X2(r,t)),t}function eP(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function tP(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),m(e,["weightedPrompts"],i)}return e}function nP(n){const e={},t=h(n,["media"]);if(t!=null){let p=qw(t);Array.isArray(p)&&(p=p.map(_=>eh(_))),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],eh(Hw(i)));const r=h(n,["audioStreamEnd"]);r!=null&&m(e,["audioStreamEnd"],r);const a=h(n,["video"]);a!=null&&m(e,["video"],eh(zw(a)));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const c=h(n,["activityStart"]);c!=null&&m(e,["activityStart"],c);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function iP(n){const e={},t=h(n,["media"]);if(t!=null){let p=qw(t);Array.isArray(p)&&(p=p.map(_=>_)),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],Hw(i));const r=h(n,["audioStreamEnd"]);r!=null&&m(e,["audioStreamEnd"],r);const a=h(n,["video"]);a!=null&&m(e,["video"],zw(a));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const c=h(n,["activityStart"]);c!=null&&m(e,["activityStart"],c);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function sP(n){const e={},t=h(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&m(e,["serverContent"],i);const r=h(n,["toolCall"]);r!=null&&m(e,["toolCall"],r);const a=h(n,["toolCallCancellation"]);a!=null&&m(e,["toolCallCancellation"],a);const l=h(n,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],uP(l));const c=h(n,["goAway"]);c!=null&&m(e,["goAway"],c);const f=h(n,["sessionResumptionUpdate"]);f!=null&&m(e,["sessionResumptionUpdate"],f);const p=h(n,["voiceActivityDetectionSignal"]);p!=null&&m(e,["voiceActivityDetectionSignal"],p);const _=h(n,["voiceActivity"]);return _!=null&&m(e,["voiceActivity"],cP(_)),e}function rP(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const r=h(n,["executableCode"]);r!=null&&m(e,["executableCode"],r);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],H2(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],K2(l));const c=h(n,["functionResponse"]);c!=null&&m(e,["functionResponse"],c);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],eh(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const T=h(n,["thoughtSignature"]);T!=null&&m(e,["thoughtSignature"],T);const E=h(n,["videoMetadata"]);return E!=null&&m(e,["videoMetadata"],E),e}function oP(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function aP(n){const e={};if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=h(n,["computerUse"]);t!=null&&m(e,["computerUse"],t);const i=h(n,["fileSearch"]);i!=null&&m(e,["fileSearch"],i);const r=h(n,["codeExecution"]);if(r!=null&&m(e,["codeExecution"],r),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=h(n,["functionDeclarations"]);if(a!=null){let _=a;Array.isArray(_)&&(_=_.map(T=>T)),m(e,["functionDeclarations"],_)}const l=h(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],Y2(l));const c=h(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],Q2(c));const f=h(n,["googleSearchRetrieval"]);f!=null&&m(e,["googleSearchRetrieval"],f);const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function lP(n){const e={},t=h(n,["retrieval"]);t!=null&&m(e,["retrieval"],t);const i=h(n,["computerUse"]);if(i!=null&&m(e,["computerUse"],i),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=h(n,["codeExecution"]);r!=null&&m(e,["codeExecution"],r);const a=h(n,["enterpriseWebSearch"]);a!=null&&m(e,["enterpriseWebSearch"],a);const l=h(n,["functionDeclarations"]);if(l!=null){let T=l;Array.isArray(T)&&(T=T.map(E=>J2(E))),m(e,["functionDeclarations"],T)}const c=h(n,["googleMaps"]);c!=null&&m(e,["googleMaps"],c);const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],f);const p=h(n,["googleSearchRetrieval"]);p!=null&&m(e,["googleSearchRetrieval"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function uP(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&m(e,["cachedContentTokenCount"],i);const r=h(n,["candidatesTokenCount"]);r!=null&&m(e,["responseTokenCount"],r);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&m(e,["toolUsePromptTokenCount"],a);const l=h(n,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(n,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const f=h(n,["promptTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(x=>x)),m(e,["promptTokensDetails"],C)}const p=h(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(x=>x)),m(e,["cacheTokensDetails"],C)}const _=h(n,["candidatesTokensDetails"]);if(_!=null){let C=_;Array.isArray(C)&&(C=C.map(x=>x)),m(e,["responseTokensDetails"],C)}const T=h(n,["toolUsePromptTokensDetails"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(x=>x)),m(e,["toolUsePromptTokensDetails"],C)}const E=h(n,["trafficType"]);return E!=null&&m(e,["trafficType"],E),e}function cP(n){const e={},t=h(n,["type"]);return t!=null&&m(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dP(n,e){const t={},i=h(n,["data"]);if(i!=null&&m(t,["data"],i),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=h(n,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function fP(n,e){const t={},i=h(n,["content"]);i!=null&&m(t,["content"],i);const r=h(n,["citationMetadata"]);r!=null&&m(t,["citationMetadata"],hP(r));const a=h(n,["tokenCount"]);a!=null&&m(t,["tokenCount"],a);const l=h(n,["finishReason"]);l!=null&&m(t,["finishReason"],l);const c=h(n,["avgLogprobs"]);c!=null&&m(t,["avgLogprobs"],c);const f=h(n,["groundingMetadata"]);f!=null&&m(t,["groundingMetadata"],f);const p=h(n,["index"]);p!=null&&m(t,["index"],p);const _=h(n,["logprobsResult"]);_!=null&&m(t,["logprobsResult"],_);const T=h(n,["safetyRatings"]);if(T!=null){let C=T;Array.isArray(C)&&(C=C.map(x=>x)),m(t,["safetyRatings"],C)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(t,["urlContextMetadata"],E),t}function hP(n,e){const t={},i=h(n,["citationSources"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(t,["citations"],r)}return t}function pP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let l=ui(a);Array.isArray(l)&&(l=l.map(c=>c)),m(i,["contents"],l)}return i}function mP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["tokensInfo"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(t,["tokensInfo"],a)}return t}function gP(n,e){const t={},i=h(n,["values"]);i!=null&&m(t,["values"],i);const r=h(n,["statistics"]);return r!=null&&m(t,["statistics"],yP(r)),t}function yP(n,e){const t={},i=h(n,["truncated"]);i!=null&&m(t,["truncated"],i);const r=h(n,["token_count"]);return r!=null&&m(t,["tokenCount"],r),t}function $h(n,e){const t={},i=h(n,["parts"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>CV(l))),m(t,["parts"],a)}const r=h(n,["role"]);return r!=null&&m(t,["role"],r),t}function _P(n,e){const t={},i=h(n,["controlType"]);i!=null&&m(t,["controlType"],i);const r=h(n,["enableControlImageComputation"]);return r!=null&&m(t,["computeControl"],r),t}function vP(n,e){const t={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function TP(n,e,t){const i={},r=h(n,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],pn(r));const a=h(n,["tools"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(f=>sC(f))),m(e,["tools"],c)}const l=h(n,["generationConfig"]);return e!==void 0&&l!=null&&m(e,["generationConfig"],dV(l)),i}function EP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let c=ui(a);Array.isArray(c)&&(c=c.map(f=>$h(f))),m(i,["contents"],c)}const l=h(e,["config"]);return l!=null&&vP(l),i}function SP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let c=ui(a);Array.isArray(c)&&(c=c.map(f=>f)),m(i,["contents"],c)}const l=h(e,["config"]);return l!=null&&TP(l,i),i}function AP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["totalTokens"]);r!=null&&m(t,["totalTokens"],r);const a=h(n,["cachedContentTokenCount"]);return a!=null&&m(t,["cachedContentTokenCount"],a),t}function IP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["totalTokens"]);return r!=null&&m(t,["totalTokens"],r),t}function wP(n,e,t){const i={},r=h(e,["model"]);return r!=null&&m(i,["_url","name"],Xe(n,r)),i}function CP(n,e,t){const i={},r=h(e,["model"]);return r!=null&&m(i,["_url","name"],Xe(n,r)),i}function bP(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function RP(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function xP(n,e,t){const i={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(n,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&m(e,["parameters","sampleCount"],l);const c=h(n,["aspectRatio"]);e!==void 0&&c!=null&&m(e,["parameters","aspectRatio"],c);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&m(e,["parameters","guidanceScale"],f);const p=h(n,["seed"]);e!==void 0&&p!=null&&m(e,["parameters","seed"],p);const _=h(n,["safetyFilterLevel"]);e!==void 0&&_!=null&&m(e,["parameters","safetySetting"],_);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&m(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const C=h(n,["includeRaiReason"]);e!==void 0&&C!=null&&m(e,["parameters","includeRaiReason"],C);const x=h(n,["language"]);e!==void 0&&x!=null&&m(e,["parameters","language"],x);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const k=h(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&m(e,["parameters","outputOptions","compressionQuality"],k);const K=h(n,["addWatermark"]);e!==void 0&&K!=null&&m(e,["parameters","addWatermark"],K);const W=h(n,["labels"]);e!==void 0&&W!=null&&m(e,["labels"],W);const q=h(n,["editMode"]);e!==void 0&&q!=null&&m(e,["parameters","editMode"],q);const ee=h(n,["baseSteps"]);return e!==void 0&&ee!=null&&m(e,["parameters","editConfig","baseSteps"],ee),i}function NP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["prompt"]);a!=null&&m(i,["instances[0]","prompt"],a);const l=h(e,["referenceImages"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>DV(p))),m(i,["instances[0]","referenceImages"],f)}const c=h(e,["config"]);return c!=null&&xP(c,i),i}function MP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Yh(l))),m(t,["generatedImages"],a)}return t}function DP(n,e,t){const i={},r=h(n,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(n,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const l=h(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&m(e,["requests[]","outputDimensionality"],l),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function PP(n,e,t){const i={},r=h(n,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(n,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const l=h(n,["outputDimensionality"]);e!==void 0&&l!=null&&m(e,["parameters","outputDimensionality"],l);const c=h(n,["mimeType"]);e!==void 0&&c!=null&&m(e,["instances[]","mimeType"],c);const f=h(n,["autoTruncate"]);return e!==void 0&&f!=null&&m(e,["parameters","autoTruncate"],f),i}function VP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let f=e_(n,a);Array.isArray(f)&&(f=f.map(p=>p)),m(i,["requests[]","content"],f)}const l=h(e,["config"]);l!=null&&DP(l,i);const c=h(e,["model"]);return c!==void 0&&m(i,["requests[]","model"],Xe(n,c)),i}function kP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let c=e_(n,a);Array.isArray(c)&&(c=c.map(f=>f)),m(i,["instances[]","content"],c)}const l=h(e,["config"]);return l!=null&&PP(l,i),i}function LP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),m(t,["embeddings"],l)}const a=h(n,["metadata"]);return a!=null&&m(t,["metadata"],a),t}function UP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["predictions[]","embeddings"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>gP(c))),m(t,["embeddings"],l)}const a=h(n,["metadata"]);return a!=null&&m(t,["metadata"],a),t}function OP(n,e){const t={},i=h(n,["endpoint"]);i!=null&&m(t,["name"],i);const r=h(n,["deployedModelId"]);return r!=null&&m(t,["deployedModelId"],r),t}function FP(n,e){const t={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["fileUri"]);i!=null&&m(t,["fileUri"],i);const r=h(n,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function BP(n,e){const t={},i=h(n,["id"]);i!=null&&m(t,["id"],i);const r=h(n,["args"]);r!=null&&m(t,["args"],r);const a=h(n,["name"]);if(a!=null&&m(t,["name"],a),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function GP(n,e){const t={},i=h(n,["allowedFunctionNames"]);i!=null&&m(t,["allowedFunctionNames"],i);const r=h(n,["mode"]);if(r!=null&&m(t,["mode"],r),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function qP(n,e){const t={},i=h(n,["description"]);i!=null&&m(t,["description"],i);const r=h(n,["name"]);r!=null&&m(t,["name"],r);const a=h(n,["parameters"]);a!=null&&m(t,["parameters"],a);const l=h(n,["parametersJsonSchema"]);l!=null&&m(t,["parametersJsonSchema"],l);const c=h(n,["response"]);c!=null&&m(t,["response"],c);const f=h(n,["responseJsonSchema"]);if(f!=null&&m(t,["responseJsonSchema"],f),h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function zP(n,e,t,i){const r={},a=h(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],$h(pn(a)));const l=h(e,["temperature"]);l!=null&&m(r,["temperature"],l);const c=h(e,["topP"]);c!=null&&m(r,["topP"],c);const f=h(e,["topK"]);f!=null&&m(r,["topK"],f);const p=h(e,["candidateCount"]);p!=null&&m(r,["candidateCount"],p);const _=h(e,["maxOutputTokens"]);_!=null&&m(r,["maxOutputTokens"],_);const T=h(e,["stopSequences"]);T!=null&&m(r,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&m(r,["responseLogprobs"],E);const C=h(e,["logprobs"]);C!=null&&m(r,["logprobs"],C);const x=h(e,["presencePenalty"]);x!=null&&m(r,["presencePenalty"],x);const P=h(e,["frequencyPenalty"]);P!=null&&m(r,["frequencyPenalty"],P);const k=h(e,["seed"]);k!=null&&m(r,["seed"],k);const K=h(e,["responseMimeType"]);K!=null&&m(r,["responseMimeType"],K);const W=h(e,["responseSchema"]);W!=null&&m(r,["responseSchema"],t_(W));const q=h(e,["responseJsonSchema"]);if(q!=null&&m(r,["responseJsonSchema"],q),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=h(e,["safetySettings"]);if(t!==void 0&&ee!=null){let ke=ee;Array.isArray(ke)&&(ke=ke.map(ht=>PV(ht))),m(t,["safetySettings"],ke)}const ae=h(e,["tools"]);if(t!==void 0&&ae!=null){let ke=Fl(ae);Array.isArray(ke)&&(ke=ke.map(ht=>BV(Ol(ht)))),m(t,["tools"],ke)}const z=h(e,["toolConfig"]);if(t!==void 0&&z!=null&&m(t,["toolConfig"],FV(z)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=h(e,["cachedContent"]);t!==void 0&&N!=null&&m(t,["cachedContent"],Bs(n,N));const M=h(e,["responseModalities"]);M!=null&&m(r,["responseModalities"],M);const D=h(e,["mediaResolution"]);D!=null&&m(r,["mediaResolution"],D);const L=h(e,["speechConfig"]);if(L!=null&&m(r,["speechConfig"],n_(L)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=h(e,["thinkingConfig"]);U!=null&&m(r,["thinkingConfig"],U);const G=h(e,["imageConfig"]);G!=null&&m(r,["imageConfig"],gV(G));const V=h(e,["enableEnhancedCivicAnswers"]);if(V!=null&&m(r,["enableEnhancedCivicAnswers"],V),h(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function HP(n,e,t,i){const r={},a=h(e,["systemInstruction"]);t!==void 0&&a!=null&&m(t,["systemInstruction"],pn(a));const l=h(e,["temperature"]);l!=null&&m(r,["temperature"],l);const c=h(e,["topP"]);c!=null&&m(r,["topP"],c);const f=h(e,["topK"]);f!=null&&m(r,["topK"],f);const p=h(e,["candidateCount"]);p!=null&&m(r,["candidateCount"],p);const _=h(e,["maxOutputTokens"]);_!=null&&m(r,["maxOutputTokens"],_);const T=h(e,["stopSequences"]);T!=null&&m(r,["stopSequences"],T);const E=h(e,["responseLogprobs"]);E!=null&&m(r,["responseLogprobs"],E);const C=h(e,["logprobs"]);C!=null&&m(r,["logprobs"],C);const x=h(e,["presencePenalty"]);x!=null&&m(r,["presencePenalty"],x);const P=h(e,["frequencyPenalty"]);P!=null&&m(r,["frequencyPenalty"],P);const k=h(e,["seed"]);k!=null&&m(r,["seed"],k);const K=h(e,["responseMimeType"]);K!=null&&m(r,["responseMimeType"],K);const W=h(e,["responseSchema"]);W!=null&&m(r,["responseSchema"],t_(W));const q=h(e,["responseJsonSchema"]);q!=null&&m(r,["responseJsonSchema"],q);const ee=h(e,["routingConfig"]);ee!=null&&m(r,["routingConfig"],ee);const ae=h(e,["modelSelectionConfig"]);ae!=null&&m(r,["modelConfig"],ae);const z=h(e,["safetySettings"]);if(t!==void 0&&z!=null){let Te=z;Array.isArray(Te)&&(Te=Te.map(Fe=>Fe)),m(t,["safetySettings"],Te)}const N=h(e,["tools"]);if(t!==void 0&&N!=null){let Te=Fl(N);Array.isArray(Te)&&(Te=Te.map(Fe=>sC(Ol(Fe)))),m(t,["tools"],Te)}const M=h(e,["toolConfig"]);t!==void 0&&M!=null&&m(t,["toolConfig"],M);const D=h(e,["labels"]);t!==void 0&&D!=null&&m(t,["labels"],D);const L=h(e,["cachedContent"]);t!==void 0&&L!=null&&m(t,["cachedContent"],Bs(n,L));const U=h(e,["responseModalities"]);U!=null&&m(r,["responseModalities"],U);const G=h(e,["mediaResolution"]);G!=null&&m(r,["mediaResolution"],G);const V=h(e,["speechConfig"]);V!=null&&m(r,["speechConfig"],n_(V));const ke=h(e,["audioTimestamp"]);ke!=null&&m(r,["audioTimestamp"],ke);const ht=h(e,["thinkingConfig"]);ht!=null&&m(r,["thinkingConfig"],ht);const te=h(e,["imageConfig"]);if(te!=null&&m(r,["imageConfig"],yV(te)),h(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const fe=h(e,["modelArmorConfig"]);return t!==void 0&&fe!=null&&m(t,["modelArmorConfig"],fe),r}function yA(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let c=ui(a);Array.isArray(c)&&(c=c.map(f=>$h(f))),m(i,["contents"],c)}const l=h(e,["config"]);return l!=null&&m(i,["generationConfig"],zP(n,l,i)),i}function _A(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["contents"]);if(a!=null){let c=ui(a);Array.isArray(c)&&(c=c.map(f=>f)),m(i,["contents"],c)}const l=h(e,["config"]);return l!=null&&m(i,["generationConfig"],HP(n,l,i)),i}function vA(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["candidates"]);if(r!=null){let p=r;Array.isArray(p)&&(p=p.map(_=>fP(_))),m(t,["candidates"],p)}const a=h(n,["modelVersion"]);a!=null&&m(t,["modelVersion"],a);const l=h(n,["promptFeedback"]);l!=null&&m(t,["promptFeedback"],l);const c=h(n,["responseId"]);c!=null&&m(t,["responseId"],c);const f=h(n,["usageMetadata"]);return f!=null&&m(t,["usageMetadata"],f),t}function TA(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["candidates"]);if(r!=null){let _=r;Array.isArray(_)&&(_=_.map(T=>T)),m(t,["candidates"],_)}const a=h(n,["createTime"]);a!=null&&m(t,["createTime"],a);const l=h(n,["modelVersion"]);l!=null&&m(t,["modelVersion"],l);const c=h(n,["promptFeedback"]);c!=null&&m(t,["promptFeedback"],c);const f=h(n,["responseId"]);f!=null&&m(t,["responseId"],f);const p=h(n,["usageMetadata"]);return p!=null&&m(t,["usageMetadata"],p),t}function KP(n,e,t){const i={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const l=h(n,["guidanceScale"]);if(e!==void 0&&l!=null&&m(e,["parameters","guidanceScale"],l),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=h(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&m(e,["parameters","safetySetting"],c);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&m(e,["parameters","personGeneration"],f);const p=h(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&m(e,["parameters","includeSafetyAttributes"],p);const _=h(n,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(n,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const C=h(n,["outputCompressionQuality"]);if(e!==void 0&&C!=null&&m(e,["parameters","outputOptions","compressionQuality"],C),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const x=h(n,["imageSize"]);if(e!==void 0&&x!=null&&m(e,["parameters","sampleImageSize"],x),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function JP(n,e,t){const i={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(n,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const l=h(n,["numberOfImages"]);e!==void 0&&l!=null&&m(e,["parameters","sampleCount"],l);const c=h(n,["aspectRatio"]);e!==void 0&&c!=null&&m(e,["parameters","aspectRatio"],c);const f=h(n,["guidanceScale"]);e!==void 0&&f!=null&&m(e,["parameters","guidanceScale"],f);const p=h(n,["seed"]);e!==void 0&&p!=null&&m(e,["parameters","seed"],p);const _=h(n,["safetyFilterLevel"]);e!==void 0&&_!=null&&m(e,["parameters","safetySetting"],_);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&m(e,["parameters","personGeneration"],T);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const C=h(n,["includeRaiReason"]);e!==void 0&&C!=null&&m(e,["parameters","includeRaiReason"],C);const x=h(n,["language"]);e!==void 0&&x!=null&&m(e,["parameters","language"],x);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const k=h(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&m(e,["parameters","outputOptions","compressionQuality"],k);const K=h(n,["addWatermark"]);e!==void 0&&K!=null&&m(e,["parameters","addWatermark"],K);const W=h(n,["labels"]);e!==void 0&&W!=null&&m(e,["labels"],W);const q=h(n,["imageSize"]);e!==void 0&&q!=null&&m(e,["parameters","sampleImageSize"],q);const ee=h(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&m(e,["parameters","enhancePrompt"],ee),i}function $P(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["prompt"]);a!=null&&m(i,["instances[0]","prompt"],a);const l=h(e,["config"]);return l!=null&&KP(l,i),i}function YP(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["prompt"]);a!=null&&m(i,["instances[0]","prompt"],a);const l=h(e,["config"]);return l!=null&&JP(l,i),i}function QP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>aV(c))),m(t,["generatedImages"],l)}const a=h(n,["positivePromptSafetyAttributes"]);return a!=null&&m(t,["positivePromptSafetyAttributes"],nC(a)),t}function jP(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Yh(c))),m(t,["generatedImages"],l)}const a=h(n,["positivePromptSafetyAttributes"]);return a!=null&&m(t,["positivePromptSafetyAttributes"],iC(a)),t}function XP(n,e,t){const i={},r=h(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(n,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(n,["resolution"]);e!==void 0&&c!=null&&m(e,["parameters","resolution"],c);const f=h(n,["personGeneration"]);if(e!==void 0&&f!=null&&m(e,["parameters","personGeneration"],f),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const p=h(n,["negativePrompt"]);e!==void 0&&p!=null&&m(e,["parameters","negativePrompt"],p);const _=h(n,["enhancePrompt"]);if(e!==void 0&&_!=null&&m(e,["parameters","enhancePrompt"],_),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const T=h(n,["lastFrame"]);e!==void 0&&T!=null&&m(e,["instances[0]","lastFrame"],Qh(T));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let C=E;Array.isArray(C)&&(C=C.map(x=>ZV(x))),m(e,["instances[0]","referenceImages"],C)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return i}function WP(n,e,t){const i={},r=h(n,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(n,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const l=h(n,["fps"]);e!==void 0&&l!=null&&m(e,["parameters","fps"],l);const c=h(n,["durationSeconds"]);e!==void 0&&c!=null&&m(e,["parameters","durationSeconds"],c);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["aspectRatio"]);e!==void 0&&p!=null&&m(e,["parameters","aspectRatio"],p);const _=h(n,["resolution"]);e!==void 0&&_!=null&&m(e,["parameters","resolution"],_);const T=h(n,["personGeneration"]);e!==void 0&&T!=null&&m(e,["parameters","personGeneration"],T);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&m(e,["parameters","pubsubTopic"],E);const C=h(n,["negativePrompt"]);e!==void 0&&C!=null&&m(e,["parameters","negativePrompt"],C);const x=h(n,["enhancePrompt"]);e!==void 0&&x!=null&&m(e,["parameters","enhancePrompt"],x);const P=h(n,["generateAudio"]);e!==void 0&&P!=null&&m(e,["parameters","generateAudio"],P);const k=h(n,["lastFrame"]);e!==void 0&&k!=null&&m(e,["instances[0]","lastFrame"],Ni(k));const K=h(n,["referenceImages"]);if(e!==void 0&&K!=null){let ee=K;Array.isArray(ee)&&(ee=ee.map(ae=>ek(ae))),m(e,["instances[0]","referenceImages"],ee)}const W=h(n,["mask"]);e!==void 0&&W!=null&&m(e,["instances[0]","mask"],WV(W));const q=h(n,["compressionQuality"]);return e!==void 0&&q!=null&&m(e,["parameters","compressionQuality"],q),i}function ZP(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["name"],i);const r=h(n,["metadata"]);r!=null&&m(t,["metadata"],r);const a=h(n,["done"]);a!=null&&m(t,["done"],a);const l=h(n,["error"]);l!=null&&m(t,["error"],l);const c=h(n,["response","generateVideoResponse"]);return c!=null&&m(t,["response"],iV(c)),t}function eV(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["name"],i);const r=h(n,["metadata"]);r!=null&&m(t,["metadata"],r);const a=h(n,["done"]);a!=null&&m(t,["done"],a);const l=h(n,["error"]);l!=null&&m(t,["error"],l);const c=h(n,["response"]);return c!=null&&m(t,["response"],sV(c)),t}function tV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["prompt"]);a!=null&&m(i,["instances[0]","prompt"],a);const l=h(e,["image"]);l!=null&&m(i,["instances[0]","image"],Qh(l));const c=h(e,["video"]);c!=null&&m(i,["instances[0]","video"],rC(c));const f=h(e,["source"]);f!=null&&rV(f,i);const p=h(e,["config"]);return p!=null&&XP(p,i),i}function nV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["prompt"]);a!=null&&m(i,["instances[0]","prompt"],a);const l=h(e,["image"]);l!=null&&m(i,["instances[0]","image"],Ni(l));const c=h(e,["video"]);c!=null&&m(i,["instances[0]","video"],oC(c));const f=h(e,["source"]);f!=null&&oV(f,i);const p=h(e,["config"]);return p!=null&&WP(p,i),i}function iV(n,e){const t={},i=h(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>uV(c))),m(t,["generatedVideos"],l)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&m(t,["raiMediaFilteredCount"],r);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&m(t,["raiMediaFilteredReasons"],a),t}function sV(n,e){const t={},i=h(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>cV(c))),m(t,["generatedVideos"],l)}const r=h(n,["raiMediaFilteredCount"]);r!=null&&m(t,["raiMediaFilteredCount"],r);const a=h(n,["raiMediaFilteredReasons"]);return a!=null&&m(t,["raiMediaFilteredReasons"],a),t}function rV(n,e,t){const i={},r=h(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const a=h(n,["image"]);e!==void 0&&a!=null&&m(e,["instances[0]","image"],Qh(a));const l=h(n,["video"]);return e!==void 0&&l!=null&&m(e,["instances[0]","video"],rC(l)),i}function oV(n,e,t){const i={},r=h(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const a=h(n,["image"]);e!==void 0&&a!=null&&m(e,["instances[0]","image"],Ni(a));const l=h(n,["video"]);return e!==void 0&&l!=null&&m(e,["instances[0]","video"],oC(l)),i}function aV(n,e){const t={},i=h(n,["_self"]);i!=null&&m(t,["image"],_V(i));const r=h(n,["raiFilteredReason"]);r!=null&&m(t,["raiFilteredReason"],r);const a=h(n,["_self"]);return a!=null&&m(t,["safetyAttributes"],nC(a)),t}function Yh(n,e){const t={},i=h(n,["_self"]);i!=null&&m(t,["image"],tC(i));const r=h(n,["raiFilteredReason"]);r!=null&&m(t,["raiFilteredReason"],r);const a=h(n,["_self"]);a!=null&&m(t,["safetyAttributes"],iC(a));const l=h(n,["prompt"]);return l!=null&&m(t,["enhancedPrompt"],l),t}function lV(n,e){const t={},i=h(n,["_self"]);i!=null&&m(t,["mask"],tC(i));const r=h(n,["labels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(t,["labels"],a)}return t}function uV(n,e){const t={},i=h(n,["video"]);return i!=null&&m(t,["video"],jV(i)),t}function cV(n,e){const t={},i=h(n,["_self"]);return i!=null&&m(t,["video"],XV(i)),t}function dV(n,e){const t={},i=h(n,["modelSelectionConfig"]);i!=null&&m(t,["modelConfig"],i);const r=h(n,["responseJsonSchema"]);r!=null&&m(t,["responseJsonSchema"],r);const a=h(n,["audioTimestamp"]);a!=null&&m(t,["audioTimestamp"],a);const l=h(n,["candidateCount"]);l!=null&&m(t,["candidateCount"],l);const c=h(n,["enableAffectiveDialog"]);c!=null&&m(t,["enableAffectiveDialog"],c);const f=h(n,["frequencyPenalty"]);f!=null&&m(t,["frequencyPenalty"],f);const p=h(n,["logprobs"]);p!=null&&m(t,["logprobs"],p);const _=h(n,["maxOutputTokens"]);_!=null&&m(t,["maxOutputTokens"],_);const T=h(n,["mediaResolution"]);T!=null&&m(t,["mediaResolution"],T);const E=h(n,["presencePenalty"]);E!=null&&m(t,["presencePenalty"],E);const C=h(n,["responseLogprobs"]);C!=null&&m(t,["responseLogprobs"],C);const x=h(n,["responseMimeType"]);x!=null&&m(t,["responseMimeType"],x);const P=h(n,["responseModalities"]);P!=null&&m(t,["responseModalities"],P);const k=h(n,["responseSchema"]);k!=null&&m(t,["responseSchema"],k);const K=h(n,["routingConfig"]);K!=null&&m(t,["routingConfig"],K);const W=h(n,["seed"]);W!=null&&m(t,["seed"],W);const q=h(n,["speechConfig"]);q!=null&&m(t,["speechConfig"],q);const ee=h(n,["stopSequences"]);ee!=null&&m(t,["stopSequences"],ee);const ae=h(n,["temperature"]);ae!=null&&m(t,["temperature"],ae);const z=h(n,["thinkingConfig"]);z!=null&&m(t,["thinkingConfig"],z);const N=h(n,["topK"]);N!=null&&m(t,["topK"],N);const M=h(n,["topP"]);if(M!=null&&m(t,["topP"],M),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function fV(n,e,t){const i={},r=h(e,["model"]);return r!=null&&m(i,["_url","name"],Xe(n,r)),i}function hV(n,e,t){const i={},r=h(e,["model"]);return r!=null&&m(i,["_url","name"],Xe(n,r)),i}function pV(n,e){const t={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=h(n,["enableWidget"]);return i!=null&&m(t,["enableWidget"],i),t}function mV(n,e){const t={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=h(n,["timeRangeFilter"]);return i!=null&&m(t,["timeRangeFilter"],i),t}function gV(n,e){const t={},i=h(n,["aspectRatio"]);i!=null&&m(t,["aspectRatio"],i);const r=h(n,["imageSize"]);if(r!=null&&m(t,["imageSize"],r),h(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function yV(n,e){const t={},i=h(n,["aspectRatio"]);i!=null&&m(t,["aspectRatio"],i);const r=h(n,["imageSize"]);r!=null&&m(t,["imageSize"],r);const a=h(n,["personGeneration"]);a!=null&&m(t,["personGeneration"],a);const l=h(n,["outputMimeType"]);l!=null&&m(t,["imageOutputOptions","mimeType"],l);const c=h(n,["outputCompressionQuality"]);return c!=null&&m(t,["imageOutputOptions","compressionQuality"],c),t}function _V(n,e){const t={},i=h(n,["bytesBase64Encoded"]);i!=null&&m(t,["imageBytes"],qr(i));const r=h(n,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function tC(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["gcsUri"],i);const r=h(n,["bytesBase64Encoded"]);r!=null&&m(t,["imageBytes"],qr(r));const a=h(n,["mimeType"]);return a!=null&&m(t,["mimeType"],a),t}function Qh(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=h(n,["imageBytes"]);i!=null&&m(t,["bytesBase64Encoded"],qr(i));const r=h(n,["mimeType"]);return r!=null&&m(t,["mimeType"],r),t}function Ni(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["gcsUri"],i);const r=h(n,["imageBytes"]);r!=null&&m(t,["bytesBase64Encoded"],qr(r));const a=h(n,["mimeType"]);return a!=null&&m(t,["mimeType"],a),t}function vV(n,e,t,i){const r={},a=h(e,["pageSize"]);t!==void 0&&a!=null&&m(t,["_query","pageSize"],a);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&m(t,["_query","pageToken"],l);const c=h(e,["filter"]);t!==void 0&&c!=null&&m(t,["_query","filter"],c);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&m(t,["_url","models_url"],Yw(n,f)),r}function TV(n,e,t,i){const r={},a=h(e,["pageSize"]);t!==void 0&&a!=null&&m(t,["_query","pageSize"],a);const l=h(e,["pageToken"]);t!==void 0&&l!=null&&m(t,["_query","pageToken"],l);const c=h(e,["filter"]);t!==void 0&&c!=null&&m(t,["_query","filter"],c);const f=h(e,["queryBase"]);return t!==void 0&&f!=null&&m(t,["_url","models_url"],Yw(n,f)),r}function EV(n,e,t){const i={},r=h(e,["config"]);return r!=null&&vV(n,r,i),i}function SV(n,e,t){const i={},r=h(e,["config"]);return r!=null&&TV(n,r,i),i}function AV(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["nextPageToken"]);r!=null&&m(t,["nextPageToken"],r);const a=h(n,["_self"]);if(a!=null){let l=Qw(a);Array.isArray(l)&&(l=l.map(c=>iy(c))),m(t,["models"],l)}return t}function IV(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["nextPageToken"]);r!=null&&m(t,["nextPageToken"],r);const a=h(n,["_self"]);if(a!=null){let l=Qw(a);Array.isArray(l)&&(l=l.map(c=>sy(c))),m(t,["models"],l)}return t}function wV(n,e){const t={},i=h(n,["maskMode"]);i!=null&&m(t,["maskMode"],i);const r=h(n,["segmentationClasses"]);r!=null&&m(t,["maskClasses"],r);const a=h(n,["maskDilation"]);return a!=null&&m(t,["dilation"],a),t}function iy(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["name"],i);const r=h(n,["displayName"]);r!=null&&m(t,["displayName"],r);const a=h(n,["description"]);a!=null&&m(t,["description"],a);const l=h(n,["version"]);l!=null&&m(t,["version"],l);const c=h(n,["_self"]);c!=null&&m(t,["tunedModelInfo"],GV(c));const f=h(n,["inputTokenLimit"]);f!=null&&m(t,["inputTokenLimit"],f);const p=h(n,["outputTokenLimit"]);p!=null&&m(t,["outputTokenLimit"],p);const _=h(n,["supportedGenerationMethods"]);_!=null&&m(t,["supportedActions"],_);const T=h(n,["temperature"]);T!=null&&m(t,["temperature"],T);const E=h(n,["maxTemperature"]);E!=null&&m(t,["maxTemperature"],E);const C=h(n,["topP"]);C!=null&&m(t,["topP"],C);const x=h(n,["topK"]);x!=null&&m(t,["topK"],x);const P=h(n,["thinking"]);return P!=null&&m(t,["thinking"],P),t}function sy(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["name"],i);const r=h(n,["displayName"]);r!=null&&m(t,["displayName"],r);const a=h(n,["description"]);a!=null&&m(t,["description"],a);const l=h(n,["versionId"]);l!=null&&m(t,["version"],l);const c=h(n,["deployedModels"]);if(c!=null){let E=c;Array.isArray(E)&&(E=E.map(C=>OP(C))),m(t,["endpoints"],E)}const f=h(n,["labels"]);f!=null&&m(t,["labels"],f);const p=h(n,["_self"]);p!=null&&m(t,["tunedModelInfo"],qV(p));const _=h(n,["defaultCheckpointId"]);_!=null&&m(t,["defaultCheckpointId"],_);const T=h(n,["checkpoints"]);if(T!=null){let E=T;Array.isArray(E)&&(E=E.map(C=>C)),m(t,["checkpoints"],E)}return t}function CV(n,e){const t={},i=h(n,["mediaResolution"]);i!=null&&m(t,["mediaResolution"],i);const r=h(n,["codeExecutionResult"]);r!=null&&m(t,["codeExecutionResult"],r);const a=h(n,["executableCode"]);a!=null&&m(t,["executableCode"],a);const l=h(n,["fileData"]);l!=null&&m(t,["fileData"],FP(l));const c=h(n,["functionCall"]);c!=null&&m(t,["functionCall"],BP(c));const f=h(n,["functionResponse"]);f!=null&&m(t,["functionResponse"],f);const p=h(n,["inlineData"]);p!=null&&m(t,["inlineData"],dP(p));const _=h(n,["text"]);_!=null&&m(t,["text"],_);const T=h(n,["thought"]);T!=null&&m(t,["thought"],T);const E=h(n,["thoughtSignature"]);E!=null&&m(t,["thoughtSignature"],E);const C=h(n,["videoMetadata"]);return C!=null&&m(t,["videoMetadata"],C),t}function bV(n,e){const t={},i=h(n,["productImage"]);return i!=null&&m(t,["image"],Ni(i)),t}function RV(n,e,t){const i={},r=h(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(n,["baseSteps"]);e!==void 0&&a!=null&&m(e,["parameters","baseSteps"],a);const l=h(n,["outputGcsUri"]);e!==void 0&&l!=null&&m(e,["parameters","storageUri"],l);const c=h(n,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const f=h(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const p=h(n,["personGeneration"]);e!==void 0&&p!=null&&m(e,["parameters","personGeneration"],p);const _=h(n,["addWatermark"]);e!==void 0&&_!=null&&m(e,["parameters","addWatermark"],_);const T=h(n,["outputMimeType"]);e!==void 0&&T!=null&&m(e,["parameters","outputOptions","mimeType"],T);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","compressionQuality"],E);const C=h(n,["enhancePrompt"]);e!==void 0&&C!=null&&m(e,["parameters","enhancePrompt"],C);const x=h(n,["labels"]);return e!==void 0&&x!=null&&m(e,["labels"],x),i}function xV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["source"]);a!=null&&MV(a,i);const l=h(e,["config"]);return l!=null&&RV(l,i),i}function NV(n,e){const t={},i=h(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Yh(a))),m(t,["generatedImages"],r)}return t}function MV(n,e,t){const i={},r=h(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const a=h(n,["personImage"]);e!==void 0&&a!=null&&m(e,["instances[0]","personImage","image"],Ni(a));const l=h(n,["productImages"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(f=>bV(f))),m(e,["instances[0]","productImages"],c)}return i}function DV(n,e){const t={},i=h(n,["referenceImage"]);i!=null&&m(t,["referenceImage"],Ni(i));const r=h(n,["referenceId"]);r!=null&&m(t,["referenceId"],r);const a=h(n,["referenceType"]);a!=null&&m(t,["referenceType"],a);const l=h(n,["maskImageConfig"]);l!=null&&m(t,["maskImageConfig"],wV(l));const c=h(n,["controlImageConfig"]);c!=null&&m(t,["controlImageConfig"],_P(c));const f=h(n,["styleImageConfig"]);f!=null&&m(t,["styleImageConfig"],f);const p=h(n,["subjectImageConfig"]);return p!=null&&m(t,["subjectImageConfig"],p),t}function nC(n,e){const t={},i=h(n,["safetyAttributes","categories"]);i!=null&&m(t,["categories"],i);const r=h(n,["safetyAttributes","scores"]);r!=null&&m(t,["scores"],r);const a=h(n,["contentType"]);return a!=null&&m(t,["contentType"],a),t}function iC(n,e){const t={},i=h(n,["safetyAttributes","categories"]);i!=null&&m(t,["categories"],i);const r=h(n,["safetyAttributes","scores"]);r!=null&&m(t,["scores"],r);const a=h(n,["contentType"]);return a!=null&&m(t,["contentType"],a),t}function PV(n,e){const t={},i=h(n,["category"]);if(i!=null&&m(t,["category"],i),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=h(n,["threshold"]);return r!=null&&m(t,["threshold"],r),t}function VV(n,e){const t={},i=h(n,["image"]);return i!=null&&m(t,["image"],Ni(i)),t}function kV(n,e,t){const i={},r=h(n,["mode"]);e!==void 0&&r!=null&&m(e,["parameters","mode"],r);const a=h(n,["maxPredictions"]);e!==void 0&&a!=null&&m(e,["parameters","maxPredictions"],a);const l=h(n,["confidenceThreshold"]);e!==void 0&&l!=null&&m(e,["parameters","confidenceThreshold"],l);const c=h(n,["maskDilation"]);e!==void 0&&c!=null&&m(e,["parameters","maskDilation"],c);const f=h(n,["binaryColorThreshold"]);e!==void 0&&f!=null&&m(e,["parameters","binaryColorThreshold"],f);const p=h(n,["labels"]);return e!==void 0&&p!=null&&m(e,["labels"],p),i}function LV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["source"]);a!=null&&OV(a,i);const l=h(e,["config"]);return l!=null&&kV(l,i),i}function UV(n,e){const t={},i=h(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>lV(a))),m(t,["generatedMasks"],r)}return t}function OV(n,e,t){const i={},r=h(n,["prompt"]);e!==void 0&&r!=null&&m(e,["instances[0]","prompt"],r);const a=h(n,["image"]);e!==void 0&&a!=null&&m(e,["instances[0]","image"],Ni(a));const l=h(n,["scribbleImage"]);return e!==void 0&&l!=null&&m(e,["instances[0]","scribble"],VV(l)),i}function FV(n,e){const t={},i=h(n,["retrievalConfig"]);i!=null&&m(t,["retrievalConfig"],i);const r=h(n,["functionCallingConfig"]);return r!=null&&m(t,["functionCallingConfig"],GP(r)),t}function BV(n,e){const t={};if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["computerUse"]);i!=null&&m(t,["computerUse"],i);const r=h(n,["fileSearch"]);r!=null&&m(t,["fileSearch"],r);const a=h(n,["codeExecution"]);if(a!=null&&m(t,["codeExecution"],a),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=h(n,["functionDeclarations"]);if(l!=null){let T=l;Array.isArray(T)&&(T=T.map(E=>E)),m(t,["functionDeclarations"],T)}const c=h(n,["googleMaps"]);c!=null&&m(t,["googleMaps"],pV(c));const f=h(n,["googleSearch"]);f!=null&&m(t,["googleSearch"],mV(f));const p=h(n,["googleSearchRetrieval"]);p!=null&&m(t,["googleSearchRetrieval"],p);const _=h(n,["urlContext"]);return _!=null&&m(t,["urlContext"],_),t}function sC(n,e){const t={},i=h(n,["retrieval"]);i!=null&&m(t,["retrieval"],i);const r=h(n,["computerUse"]);if(r!=null&&m(t,["computerUse"],r),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=h(n,["codeExecution"]);a!=null&&m(t,["codeExecution"],a);const l=h(n,["enterpriseWebSearch"]);l!=null&&m(t,["enterpriseWebSearch"],l);const c=h(n,["functionDeclarations"]);if(c!=null){let E=c;Array.isArray(E)&&(E=E.map(C=>qP(C))),m(t,["functionDeclarations"],E)}const f=h(n,["googleMaps"]);f!=null&&m(t,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(t,["googleSearch"],p);const _=h(n,["googleSearchRetrieval"]);_!=null&&m(t,["googleSearchRetrieval"],_);const T=h(n,["urlContext"]);return T!=null&&m(t,["urlContext"],T),t}function GV(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const r=h(n,["createTime"]);r!=null&&m(t,["createTime"],r);const a=h(n,["updateTime"]);return a!=null&&m(t,["updateTime"],a),t}function qV(n,e){const t={},i=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&m(t,["baseModel"],i);const r=h(n,["createTime"]);r!=null&&m(t,["createTime"],r);const a=h(n,["updateTime"]);return a!=null&&m(t,["updateTime"],a),t}function zV(n,e,t){const i={},r=h(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(n,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&m(e,["defaultCheckpointId"],l),i}function HV(n,e,t){const i={},r=h(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(n,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const l=h(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&m(e,["defaultCheckpointId"],l),i}function KV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","name"],Xe(n,r));const a=h(e,["config"]);return a!=null&&zV(a,i),i}function JV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["config"]);return a!=null&&HV(a,i),i}function $V(n,e,t){const i={},r=h(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&m(e,["parameters","safetySetting"],a);const l=h(n,["personGeneration"]);e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l);const c=h(n,["includeRaiReason"]);e!==void 0&&c!=null&&m(e,["parameters","includeRaiReason"],c);const f=h(n,["outputMimeType"]);e!==void 0&&f!=null&&m(e,["parameters","outputOptions","mimeType"],f);const p=h(n,["outputCompressionQuality"]);e!==void 0&&p!=null&&m(e,["parameters","outputOptions","compressionQuality"],p);const _=h(n,["enhanceInputImage"]);e!==void 0&&_!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],_);const T=h(n,["imagePreservationFactor"]);e!==void 0&&T!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],T);const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const C=h(n,["numberOfImages"]);e!==void 0&&C!=null&&m(e,["parameters","sampleCount"],C);const x=h(n,["mode"]);return e!==void 0&&x!=null&&m(e,["parameters","mode"],x),i}function YV(n,e,t){const i={},r=h(e,["model"]);r!=null&&m(i,["_url","model"],Xe(n,r));const a=h(e,["image"]);a!=null&&m(i,["instances[0]","image"],Ni(a));const l=h(e,["upscaleFactor"]);l!=null&&m(i,["parameters","upscaleConfig","upscaleFactor"],l);const c=h(e,["config"]);return c!=null&&$V(c,i),i}function QV(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>Yh(l))),m(t,["generatedImages"],a)}return t}function jV(n,e){const t={},i=h(n,["uri"]);i!=null&&m(t,["uri"],i);const r=h(n,["encodedVideo"]);r!=null&&m(t,["videoBytes"],qr(r));const a=h(n,["encoding"]);return a!=null&&m(t,["mimeType"],a),t}function XV(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["uri"],i);const r=h(n,["bytesBase64Encoded"]);r!=null&&m(t,["videoBytes"],qr(r));const a=h(n,["mimeType"]);return a!=null&&m(t,["mimeType"],a),t}function WV(n,e){const t={},i=h(n,["image"]);i!=null&&m(t,["_self"],Ni(i));const r=h(n,["maskMode"]);return r!=null&&m(t,["maskMode"],r),t}function ZV(n,e){const t={},i=h(n,["image"]);i!=null&&m(t,["image"],Qh(i));const r=h(n,["referenceType"]);return r!=null&&m(t,["referenceType"],r),t}function ek(n,e){const t={},i=h(n,["image"]);i!=null&&m(t,["image"],Ni(i));const r=h(n,["referenceType"]);return r!=null&&m(t,["referenceType"],r),t}function rC(n,e){const t={},i=h(n,["uri"]);i!=null&&m(t,["uri"],i);const r=h(n,["videoBytes"]);r!=null&&m(t,["encodedVideo"],qr(r));const a=h(n,["mimeType"]);return a!=null&&m(t,["encoding"],a),t}function oC(n,e){const t={},i=h(n,["uri"]);i!=null&&m(t,["gcsUri"],i);const r=h(n,["videoBytes"]);r!=null&&m(t,["bytesBase64Encoded"],qr(r));const a=h(n,["mimeType"]);return a!=null&&m(t,["mimeType"],a),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tk(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["displayName"],i),t}function nk(n){const e={},t=h(n,["config"]);return t!=null&&tk(t,e),e}function ik(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function sk(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&ik(i,e),e}function rk(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function ok(n,e){const t={},i=h(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["customMetadata"],a)}const r=h(n,["chunkingConfig"]);return e!==void 0&&r!=null&&m(e,["chunkingConfig"],r),t}function ak(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const r=h(n,["done"]);r!=null&&m(e,["done"],r);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],uk(l)),e}function lk(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["fileName"]);i!=null&&m(e,["fileName"],i);const r=h(n,["config"]);return r!=null&&ok(r,e),e}function uk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const r=h(n,["documentName"]);return r!=null&&m(e,["documentName"],r),e}function ck(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),t}function dk(n){const e={},t=h(n,["config"]);return t!=null&&ck(t,e),e}function fk(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["fileSearchStores"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["fileSearchStores"],a)}return e}function aC(n,e){const t={},i=h(n,["mimeType"]);e!==void 0&&i!=null&&m(e,["mimeType"],i);const r=h(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(n,["customMetadata"]);if(e!==void 0&&a!=null){let c=a;Array.isArray(c)&&(c=c.map(f=>f)),m(e,["customMetadata"],c)}const l=h(n,["chunkingConfig"]);return e!==void 0&&l!=null&&m(e,["chunkingConfig"],l),t}function hk(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["config"]);return i!=null&&aC(i,e),e}function pk(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mk="Content-Type",gk="X-Server-Timeout",yk="User-Agent",ry="x-goog-api-client",_k="1.41.0",vk=`google-genai-sdk/${_k}`,Tk="v1beta1",Ek="v1beta",Sk=5,Ak=[408,429,500,502,503,504];class Ik{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const a={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(a.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?a.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(a.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:Tk}else{if(!this.clientOptions.apiKey)throw new Rc({message:"API key must be set when using the Gemini API.",status:403});a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:Ek,a.baseUrl="https://generativelanguage.googleapis.com/"}a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===Zg.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))r.searchParams.append(l,String(c));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))typeof a=="object"?i[r]=Object.assign(Object.assign({},i[r]),a):a!==void 0&&(i[r]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>a.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&wk(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await EA(r),new ey(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await EA(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return Ci(this,arguments,function*(){var i;const r=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let l="";const c="data:",f=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:_}=yield Me(r.read());if(p){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const T=a.decode(_,{stream:!0});try{const x=JSON.parse(T);if("error"in x){const P=JSON.parse(JSON.stringify(x.error)),k=P.status,K=P.code,W=`got status: ${k}. ${JSON.stringify(x)}`;if(K>=400&&K<600)throw new Rc({message:W,status:K})}}catch(x){if(x.name==="ApiError")throw x}l+=T;let E=-1,C=0;for(;;){E=-1,C=0;for(const k of f){const K=l.indexOf(k);K!==-1&&(E===-1||K<E)&&(E=K,C=k.length)}if(E===-1)break;const x=l.substring(0,E);l=l.substring(E+C);const P=x.trim();if(P.startsWith(c)){const k=P.substring(c.length).trim();try{const K=new Response(k,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Me(new ey(K))}catch(K){throw new Error(`exception parsing stream chunk ${k}. ${K}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){var i;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(e,t);const r=this.clientOptions.httpOptions.retryOptions;return pM(async()=>{const l=await fetch(e,t);if(l.ok)return l;throw Ak.includes(l.status)?new Error(`Retryable HTTP Error: ${l.statusText}`):new Fw(`Non-retryable exception ${l.statusText} sending request`)},{retries:((i=r.attempts)!==null&&i!==void 0?i:Sk)-1})}getDefaultHeaders(){const e={},t=vk+" "+this.clientOptions.userAgentExtra;return e[yk]=t,e[ry]=t,e[mk]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))i.append(r,a);e.timeout&&e.timeout>0&&i.append(gk,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);r.sizeBytes=String(l.size);const c=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=c;const f={file:r},p=this.getFileName(e),_=me("upload/v1beta/files",f._url),T=await this.fetchUploadUrl(_,r.sizeBytes,r.mimeType,p,f,t==null?void 0:t.httpOptions);return a.upload(e,T,this)}async uploadFileToFileSearchStore(e,t,i){var r;const a=this.clientOptions.uploader,l=await a.stat(t),c=String(l.size),f=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),T={};i!=null&&aC(i,T);const E=await this.fetchUploadUrl(p,c,f,_,T,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,E,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,a,l){var c;let f={};l?f=l:f={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:f});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(c=p==null?void 0:p.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function EA(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Rc({message:r,status:t}):new Error(r)}}function wk(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const c=Object.assign({},a);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const p=l[f],_=c[f];p&&typeof p=="object"&&!Array.isArray(p)&&_&&typeof _=="object"&&!Array.isArray(_)?c[f]=i(_,p):(_&&p&&typeof _!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof p}. Overwriting.`),c[f]=p)}return c}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ck="mcp_used/unknown";let bk=!1;function lC(n){for(const e of n)if(Rk(e)||typeof e=="object"&&"inputSchema"in e)return!0;return bk}function uC(n){var e;const t=(e=n[ry])!==null&&e!==void 0?e:"";n[ry]=(t+` ${Ck}`).trimStart()}function Rk(n){return n!==null&&typeof n=="object"&&n instanceof s_}function xk(n){return Ci(this,arguments,function*(t,i=100){let r,a=0;for(;a<i;){const l=yield Me(t.listTools({cursor:r}));for(const c of l.tools)yield yield Me(c),a++;if(!l.nextCursor)break;r=l.nextCursor}})}class s_{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new s_(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const a={},l=[];for(const _ of this.mcpClients)try{for(var c=!0,f=(t=void 0,bi(xk(_))),p;p=await f.next(),e=p.done,!e;c=!0){r=p.value,c=!1;const T=r;l.push(T);const E=T.name;if(a[E])throw new Error(`Duplicate function name ${E} found in MCP tools. Please ensure function names are unique.`);a[E]=_}}catch(T){t={error:T}}finally{try{!c&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),nD(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await r.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Nk(n,e,t){const i=new YM;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class Mk{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=Vk(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),f=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${c}`;let p=()=>{};const _=new Promise(q=>{p=q}),T=e.callbacks,E=function(){p({})},C=this.apiClient,x={onopen:E,onmessage:q=>{Nk(C,T.onmessage,q)},onerror:(t=T==null?void 0:T.onerror)!==null&&t!==void 0?t:function(q){},onclose:(i=T==null?void 0:T.onclose)!==null&&i!==void 0?i:function(q){}},P=this.webSocketFactory.create(f,Pk(l),x);P.connect(),await _;const W={setup:{model:Xe(this.apiClient,e.model)}};return P.send(JSON.stringify(W)),new Dk(P,this.apiClient)}}class Dk{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=tP(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=eP(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(rl.PLAY)}pause(){this.sendPlaybackControl(rl.PAUSE)}stop(){this.sendPlaybackControl(rl.STOP)}resetContext(){this.sendPlaybackControl(rl.RESET_CONTEXT)}close(){this.conn.close()}}function Pk(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function Vk(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kk="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Lk(n,e,t){const i=new $M;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const a=JSON.parse(r);if(n.isVertexAI()){const l=sP(a);Object.assign(i,l)}else Object.assign(i,a);e(i)}class Uk{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Mk(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,a,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let _;const T=this.apiClient.getHeaders();e.config&&e.config.tools&&lC(e.config.tools)&&uC(T);const E=Gk(T);if(this.apiClient.isVertexAI()){const D=this.apiClient.getProject(),L=this.apiClient.getLocation(),U=this.apiClient.getApiKey(),G=!!D&&!!L||!!U;this.apiClient.getCustomBaseUrl()&&!G?_=f:(_=`${f}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(E,_))}else{const D=this.apiClient.getApiKey();let L="BidiGenerateContent",U="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",U="access_token"),_=`${f}/ws/google.ai.generativelanguage.${p}.GenerativeService.${L}?${U}=${D}`}let C=()=>{};const x=new Promise(D=>{C=D}),P=e.callbacks,k=function(){var D;(D=P==null?void 0:P.onopen)===null||D===void 0||D.call(P),C({})},K=this.apiClient,W={onopen:k,onmessage:D=>{Lk(K,P.onmessage,D)},onerror:(t=P==null?void 0:P.onerror)!==null&&t!==void 0?t:function(D){},onclose:(i=P==null?void 0:P.onclose)!==null&&i!==void 0?i:function(D){}},q=this.webSocketFactory.create(_,Bk(E),W);q.connect(),await x;let ee=Xe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&ee.startsWith("publishers/")){const D=this.apiClient.getProject(),L=this.apiClient.getLocation();D&&L&&(ee=`projects/${D}/locations/${L}/`+ee)}let ae={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[yh.AUDIO]}:e.config.responseModalities=[yh.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],N=[];for(const D of z)if(this.isCallableTool(D)){const L=D;N.push(await L.tool())}else N.push(D);N.length>0&&(e.config.tools=N);const M={model:ee,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ae=Z2(this.apiClient,M):ae=W2(this.apiClient,M),delete ae.config,q.send(JSON.stringify(ae)),new Fk(q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Ok={turnComplete:!0};class Fk{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ui(t.turns),e.isVertexAI()||(i=i.map(r=>$h(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(kk)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},Ok),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:iP(e)}:t={realtimeInput:nP(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Bk(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function Gk(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SA=10;function AA(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ul(l)){r=!0;break}if(!r)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function ul(n){return"callTool"in n&&typeof n.callTool=="function"}function qk(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>ul(r)))!==null&&i!==void 0?i:!1}function IA(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(ul(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(r)}),t}function wA(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zk extends Fs{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,a,l,c;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!qk(t)||AA(t.config))return await this.generateContentInternal(f);const p=IA(t);if(p.length>0){const P=p.map(k=>`tools[${k}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${P}.`)}let _,T;const E=ui(f.contents),C=(a=(r=(i=f.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:SA;let x=0;for(;x<C&&(_=await this.generateContentInternal(f),!(!_.functionCalls||_.functionCalls.length===0));){const P=_.candidates[0].content,k=[];for(const K of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(ul(K)){const q=await K.callTool(_.functionCalls);k.push(...q)}x++,T={role:"user",parts:k},f.contents=ui(f.contents),f.contents.push(P),f.contents.push(T),wA(f.config)&&(E.push(P),E.push(T))}return wA(f.config)&&(_.automaticFunctionCallingHistory=E),_},this.generateContentStream=async t=>{var i,r,a,l,c;if(this.maybeMoveToResponseJsonSchem(t),AA(t.config)){const T=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(T)}const f=IA(t);if(f.length>0){const T=f.map(E=>`tools[${E}]`).join(", ");throw new Error(`Incompatible tools found at ${T}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(a=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(c=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(p&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let a;const l=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((r=f==null?void 0:f.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:l.push(f);let c;return a?c={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},c}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new ea(Ps.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,a,l,c,f;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((f=(c=t.source)===null||c===void 0?void 0:c.video)===null||f===void 0)&&f.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async f=>ul(f)?await f.tool():f)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&lC(e.config.tools)){const f=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},f);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),uC(p),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return c}async initAfcToolsMap(e){var t,i,r;const a=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(ul(l)){const c=l,f=await c.tool();for(const p of(r=f.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,c)}}return a}async processAfcStream(e){var t,i,r;const a=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:SA;let l=!1,c=0;const f=await this.initAfcToolsMap(e);return(function(p,_,T){return Ci(this,arguments,function*(){for(var E,C,x,P,k,K;c<a;){l&&(c++,l=!1);const ae=yield Me(p.processParamsMaybeAddMcpUsage(T)),z=yield Me(p.generateContentStreamInternal(ae)),N=[],M=[];try{for(var W=!0,q=(C=void 0,bi(z)),ee;ee=yield Me(q.next()),E=ee.done,!E;W=!0){P=ee.value,W=!1;const D=P;if(yield yield Me(D),D.candidates&&(!((k=D.candidates[0])===null||k===void 0)&&k.content)){M.push(D.candidates[0].content);for(const L of(K=D.candidates[0].content.parts)!==null&&K!==void 0?K:[])if(c<a&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(L.functionCall.name)){const U=yield Me(_.get(L.functionCall.name).callTool([L.functionCall]));N.push(...U)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(D){C={error:D}}finally{try{!W&&!E&&(x=q.return)&&(yield Me(x.call(q)))}finally{if(C)throw C.error}}if(N.length>0){l=!0;const D=new nc;D.candidates=[{content:{role:"user",parts:N}}],yield yield Me(D);const L=[];L.push(...M),L.push({role:"user",parts:N});const U=ui(T.contents).concat(L);T.contents=U}else break}})})(this,f,e)}async generateContentInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=_A(this.apiClient,e);return c=me("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=TA(_),E=new nc;return Object.assign(E,T),E})}else{const p=yA(this.apiClient,e);return c=me("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=vA(_),E=new nc;return Object.assign(E,T),E})}}async generateContentStreamInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=_A(this.apiClient,e);return c=me("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(T){return Ci(this,arguments,function*(){var E,C,x,P;try{for(var k=!0,K=bi(T),W;W=yield Me(K.next()),E=W.done,!E;k=!0){P=W.value,k=!1;const q=P,ee=TA(yield Me(q.json()),e);ee.sdkHttpResponse={headers:q.headers};const ae=new nc;Object.assign(ae,ee),yield yield Me(ae)}}catch(q){C={error:q}}finally{try{!k&&!E&&(x=K.return)&&(yield Me(x.call(K)))}finally{if(C)throw C.error}}})})}else{const p=yA(this.apiClient,e);return c=me("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(T){return Ci(this,arguments,function*(){var E,C,x,P;try{for(var k=!0,K=bi(T),W;W=yield Me(K.next()),E=W.done,!E;k=!0){P=W.value,k=!1;const q=P,ee=vA(yield Me(q.json()),e);ee.sdkHttpResponse={headers:q.headers};const ae=new nc;Object.assign(ae,ee),yield yield Me(ae)}}catch(q){C={error:q}}finally{try{!k&&!E&&(x=K.return)&&(yield Me(x.call(K)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=kP(this.apiClient,e);return c=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=UP(_),E=new eA;return Object.assign(E,T),E})}else{const p=VP(this.apiClient,e);return c=me("{model}:batchEmbedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=LP(_),E=new eA;return Object.assign(E,T),E})}}async generateImagesInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=YP(this.apiClient,e);return c=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=jP(_),E=new tA;return Object.assign(E,T),E})}else{const p=$P(this.apiClient,e);return c=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=QP(_),E=new tA;return Object.assign(E,T),E})}}async editImageInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=NP(this.apiClient,e);return a=me("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const p=MP(f),_=new kM;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=YV(this.apiClient,e);return a=me("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const p=QV(f),_=new LM;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=xV(this.apiClient,e);return a=me("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=NV(f),_=new UM;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=LV(this.apiClient,e);return a=me("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=UV(f),_=new OM;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=hV(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>sy(_))}else{const p=fV(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>iy(_))}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=SV(this.apiClient,e);return c=me("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=IV(_),E=new nA;return Object.assign(E,T),E})}else{const p=EV(this.apiClient,e);return c=me("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=AV(_),E=new nA;return Object.assign(E,T),E})}}async update(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=JV(this.apiClient,e);return c=me("{model}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>sy(_))}else{const p=KV(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>iy(_))}}async delete(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=CP(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=RP(_),E=new iA;return Object.assign(E,T),E})}else{const p=wP(this.apiClient,e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=bP(_),E=new iA;return Object.assign(E,T),E})}}async countTokens(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=SP(this.apiClient,e);return c=me("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=IP(_),E=new sA;return Object.assign(E,T),E})}else{const p=EP(this.apiClient,e);return c=me("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=AP(_),E=new sA;return Object.assign(E,T),E})}}async computeTokens(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=pP(this.apiClient,e);return a=me("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>{const p=mP(f),_=new FM;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=nV(this.apiClient,e);return c=me("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>{const T=eV(_),E=new _h;return Object.assign(E,T),E})}else{const p=tV(this.apiClient,e);return c=me("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>{const T=ZP(_),E=new _h;return Object.assign(E,T),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hk extends Fs{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=xM(e);return c=me("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l}else{const p=RM(e);return c=me("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=EM(e);return a=me("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Kk(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function Jk(n){const e={},t=h(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>tL(a))),m(e,["parts"],r)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function $k(n,e,t){const i={},r=h(e,["expireTime"]);t!==void 0&&r!=null&&m(t,["expireTime"],r);const a=h(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&m(t,["newSessionExpireTime"],a);const l=h(e,["uses"]);t!==void 0&&l!=null&&m(t,["uses"],l);const c=h(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&m(t,["bidiGenerateContentSetup"],eL(n,c));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&m(t,["fieldMask"],f),i}function Yk(n,e){const t={},i=h(e,["config"]);return i!=null&&m(t,["config"],$k(n,i,t)),t}function Qk(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function jk(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const r=h(n,["name"]);if(r!=null&&m(e,["name"],r),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Xk(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function Wk(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function Zk(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const r=h(n,["responseModalities"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","responseModalities"],r);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(n,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const T=h(n,["speechConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","speechConfig"],i_(T));const E=h(n,["thinkingConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","thinkingConfig"],E);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const x=h(n,["systemInstruction"]);e!==void 0&&x!=null&&m(e,["setup","systemInstruction"],Jk(pn(x)));const P=h(n,["tools"]);if(e!==void 0&&P!=null){let z=Fl(P);Array.isArray(z)&&(z=z.map(N=>iL(Ol(N)))),m(e,["setup","tools"],z)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],nL(k));const K=h(n,["inputAudioTranscription"]);e!==void 0&&K!=null&&m(e,["setup","inputAudioTranscription"],K);const W=h(n,["outputAudioTranscription"]);e!==void 0&&W!=null&&m(e,["setup","outputAudioTranscription"],W);const q=h(n,["realtimeInputConfig"]);e!==void 0&&q!=null&&m(e,["setup","realtimeInputConfig"],q);const ee=h(n,["contextWindowCompression"]);e!==void 0&&ee!=null&&m(e,["setup","contextWindowCompression"],ee);const ae=h(n,["proactivity"]);if(e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function eL(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Xe(n,i));const r=h(e,["config"]);return r!=null&&m(t,["config"],Zk(r,t)),t}function tL(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const r=h(n,["executableCode"]);r!=null&&m(e,["executableCode"],r);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],Qk(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],jk(l));const c=h(n,["functionResponse"]);c!=null&&m(e,["functionResponse"],c);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],Kk(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const T=h(n,["thoughtSignature"]);T!=null&&m(e,["thoughtSignature"],T);const E=h(n,["videoMetadata"]);return E!=null&&m(e,["videoMetadata"],E),e}function nL(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function iL(n){const e={};if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=h(n,["computerUse"]);t!=null&&m(e,["computerUse"],t);const i=h(n,["fileSearch"]);i!=null&&m(e,["fileSearch"],i);const r=h(n,["codeExecution"]);if(r!=null&&m(e,["codeExecution"],r),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=h(n,["functionDeclarations"]);if(a!=null){let _=a;Array.isArray(_)&&(_=_.map(T=>T)),m(e,["functionDeclarations"],_)}const l=h(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],Xk(l));const c=h(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],Wk(c));const f=h(n,["googleSearchRetrieval"]);f!=null&&m(e,["googleSearchRetrieval"],f);const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sL(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(a=>`${t}.${a}`);e.push(...r)}else e.push(t)}return e.join(",")}function rL(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const a=sL(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];r.length>0&&(c=r.map(p=>l.includes(p)?`generationConfig.${p}`:p));const f=[];a&&f.push(a),c.length>0&&f.push(...c),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class oL extends Fs{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=Yk(this.apiClient,e);a=me("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const f=rL(c,e.config);return r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aL(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function lL(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&aL(i,e),e}function uL(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function cL(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=h(n,["pageToken"]);return e!==void 0&&r!=null&&m(e,["_query","pageToken"],r),t}function dL(n){const e={},t=h(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const i=h(n,["config"]);return i!=null&&cL(i,e),e}function fL(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const r=h(n,["documents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hL extends Fs{constructor(e){super(),this.apiClient=e,this.list=async t=>new ea(Ps.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=uL(e);return a=me("{name}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>f)}}async delete(e){var t,i;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=lL(e);r=me("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=dL(e);return a=me("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=fL(f),_=new BM;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pL extends Fs{constructor(e,t=new hL(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new ea(Ps.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=nk(e);return a=me("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>f)}}async get(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rk(e);return a=me("{name}",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>f)}}async delete(e){var t,i;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=sk(e);r=me("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=dk(e);return a=me("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=fk(f),_=new GM;return Object.assign(_,p),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=hk(e);return a=me("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=pk(f),_=new qM;return Object.assign(_,p),_})}}async importFile(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=lk(e);return a=me("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),r.then(f=>{const p=ak(f),_=new Wy;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cC=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return cC=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const mL=()=>cC();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oy(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const ay=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ci extends Error{}class En extends ci{constructor(e,t,i,r){super(`${En.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new jh({message:i,cause:ay(t)});const a=t;return e===400?new fC(e,a,i,r):e===401?new hC(e,a,i,r):e===403?new pC(e,a,i,r):e===404?new mC(e,a,i,r):e===409?new gC(e,a,i,r):e===422?new yC(e,a,i,r):e===429?new _C(e,a,i,r):e>=500?new vC(e,a,i,r):new En(e,a,i,r)}}class ly extends En{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class jh extends En{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class dC extends jh{constructor({message:e}={}){super({message:e??"Request timed out."})}}class fC extends En{}class hC extends En{}class pC extends En{}class mC extends En{}class gC extends En{}class yC extends En{}class _C extends En{}class vC extends En{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gL=/^[a-z][a-z0-9+.-]*:/i,yL=n=>gL.test(n);let uy=n=>(uy=Array.isArray,uy(n));const _L=uy;let vL=_L;const CA=vL;function TL(n){if(!n)return!0;for(const e in n)return!1;return!0}function EL(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const SL=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ci(`${n} must be an integer`);if(e<0)throw new ci(`${n} must be a positive integer`);return e},AL=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IL=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Za="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wL(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const CL=()=>{var n,e,t,i,r;const a=wL();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Za,"X-Stainless-OS":RA(Deno.build.os),"X-Stainless-Arch":bA(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Za,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Za,"X-Stainless-OS":RA((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":bA((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const l=bL();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Za,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Za,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function bL(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const r=i[1]||0,a=i[2]||0,l=i[3]||0;return{browser:e,version:`${r}.${a}.${l}`}}}return null}const bA=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",RA=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Lf;const RL=()=>Lf??(Lf=CL());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xL(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function TC(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function NL(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return TC({start(){},async pull(t){const{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function EC(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function ML(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),r=i.cancel();i.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DL=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SC=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Rg(n,e,t){return SC(),new File(n,e??"unknown_file",t)}function PL(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const VL=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AC=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",kL=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&AC(n),LL=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function UL(n,e,t){if(SC(),n=await n,kL(n))return n instanceof File?n:Rg([await n.arrayBuffer()],n.name);if(LL(n)){const r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Rg(await cy(r),e,t)}const i=await cy(n);if(e||(e=PL(n)),!(t!=null&&t.type)){const r=i.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return Rg(i,e,t)}async function cy(n){var e,t,i,r,a;let l=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)l.push(n);else if(AC(n))l.push(n instanceof Blob?n:await n.arrayBuffer());else if(VL(n))try{for(var c=!0,f=bi(n),p;p=await f.next(),e=p.done,!e;c=!0){r=p.value,c=!1;const _=r;l.push(...await cy(_))}}catch(_){t={error:_}}finally{try{!c&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}else{const _=(a=n==null?void 0:n.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof n}${_?`; constructor: ${_}`:""}${OL(n)}`)}return l}function OL(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IC{constructor(e){this._client=e}}IC._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wC(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const xA=Object.freeze(Object.create(null)),FL=(n=wC)=>(function(t,...i){if(t.length===1)return t[0];let r=!1;const a=[],l=t.reduce((_,T,E)=>{var C,x,P;/[?#]/.test(T)&&(r=!0);const k=i[E];let K=(r?encodeURIComponent:n)(""+k);return E!==i.length&&(k==null||typeof k=="object"&&k.toString===((P=Object.getPrototypeOf((x=Object.getPrototypeOf((C=k.hasOwnProperty)!==null&&C!==void 0?C:xA))!==null&&x!==void 0?x:xA))===null||P===void 0?void 0:P.toString))&&(K=k+"",a.push({start:_.length+T.length,length:K.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),_+T+(E===i.length?"":K)},""),c=l.split(/[?#]/,1)[0],f=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=f.exec(c))!==null;)a.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(a.sort((_,T)=>_.start-T.start),a.length>0){let _=0;const T=a.reduce((E,C)=>{const x=" ".repeat(C.start-_),P="^".repeat(C.length);return _=C.start+C.length,E+x+P},"");throw new ci(`Path parameters result in path with invalid segments:
${a.map(E=>E.error).join(`
`)}
${l}
${T}`)}return l}),Uf=FL(wC);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CC extends IC{create(e,t){var i;const{api_version:r=this._client.apiVersion}=e,a=Th(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new ci("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new ci("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Uf`/${r}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(Uf`/${r}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.post(Uf`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;const a=t??{},{api_version:l=this._client.apiVersion}=a,c=Th(a,["api_version"]);return this._client.get(Uf`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},i),{stream:(r=t==null?void 0:t.stream)!==null&&r!==void 0?r:!1}))}}CC._key=Object.freeze(["interactions"]);class bC extends CC{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BL(n){let e=0;for(const r of n)e+=r.length;const t=new Uint8Array(e);let i=0;for(const r of n)t.set(r,i),i+=r.length;return t}let Of;function r_(n){let e;return(Of??(e=new globalThis.TextEncoder,Of=e.encode.bind(e)))(n)}let Ff;function NA(n){let e;return(Ff??(e=new globalThis.TextDecoder,Ff=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xh{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?r_(e):e;this.buffer=BL([this.buffer,t]);const i=[];let r;for(;(r=GL(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(NA(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,l=NA(this.buffer.subarray(0,a));i.push(l),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Xh.NEWLINE_CHARS=new Set([`
`,"\r"]);Xh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function GL(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function qL(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Eh={off:0,error:200,warn:300,info:400,debug:500},MA=(n,e,t)=>{if(n){if(EL(Eh,n))return n;vn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Eh))}`)}};function dc(){}function Bf(n,e,t){return!e||Eh[n]>Eh[t]?dc:e[n].bind(e)}const zL={error:dc,warn:dc,info:dc,debug:dc};let DA=new WeakMap;function vn(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return zL;const r=DA.get(t);if(r&&r[0]===i)return r[1];const a={error:Bf("error",t,i),warn:Bf("warn",t,i),info:Bf("info",t,i),debug:Bf("debug",t,i)};return DA.set(t,[i,a]),a}const xo=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ol{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1;const a=i?vn(i):console;function l(){return Ci(this,arguments,function*(){var f,p,_,T;if(r)throw new ci("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let E=!1;try{try{for(var C=!0,x=bi(HL(e,t)),P;P=yield Me(x.next()),f=P.done,!f;C=!0){T=P.value,C=!1;const k=T;if(!E)if(k.data.startsWith("[DONE]")){E=!0;continue}else try{yield yield Me(JSON.parse(k.data))}catch(K){throw a.error("Could not parse message into JSON:",k.data),a.error("From chunk:",k.raw),K}}}catch(k){p={error:k}}finally{try{!C&&!f&&(_=x.return)&&(yield Me(_.call(x)))}finally{if(p)throw p.error}}E=!0}catch(k){if(oy(k))return yield Me(void 0);throw k}finally{E||t.abort()}})}return new ol(l,t,i)}static fromReadableStream(e,t,i){let r=!1;function a(){return Ci(this,arguments,function*(){var f,p,_,T;const E=new Xh,C=EC(e);try{for(var x=!0,P=bi(C),k;k=yield Me(P.next()),f=k.done,!f;x=!0){T=k.value,x=!1;const K=T;for(const W of E.decode(K))yield yield Me(W)}}catch(K){p={error:K}}finally{try{!x&&!f&&(_=P.return)&&(yield Me(_.call(P)))}finally{if(p)throw p.error}}for(const K of E.flush())yield yield Me(K)})}function l(){return Ci(this,arguments,function*(){var f,p,_,T;if(r)throw new ci("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let E=!1;try{try{for(var C=!0,x=bi(a()),P;P=yield Me(x.next()),f=P.done,!f;C=!0){T=P.value,C=!1;const k=T;E||k&&(yield yield Me(JSON.parse(k)))}}catch(k){p={error:k}}finally{try{!C&&!f&&(_=x.return)&&(yield Me(_.call(x)))}finally{if(p)throw p.error}}E=!0}catch(k){if(oy(k))return yield Me(void 0);throw k}finally{E||t.abort()}})}return new ol(l,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),r=a=>({next:()=>{if(a.length===0){const l=i.next();e.push(l),t.push(l)}return a.shift()}});return[new ol(()=>r(e),this.controller,this.client),new ol(()=>r(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return TC({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:r,done:a}=await t.next();if(a)return i.close();const l=r_(JSON.stringify(r)+`
`);i.enqueue(l)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function HL(n,e){return Ci(this,arguments,function*(){var i,r,a,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ci("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ci("Attempted to iterate over a response with no body");const c=new JL,f=new Xh,p=EC(n.body);try{for(var _=!0,T=bi(KL(p)),E;E=yield Me(T.next()),i=E.done,!i;_=!0){l=E.value,_=!1;const C=l;for(const x of f.decode(C)){const P=c.decode(x);P&&(yield yield Me(P))}}}catch(C){r={error:C}}finally{try{!_&&!i&&(a=T.return)&&(yield Me(a.call(T)))}finally{if(r)throw r.error}}for(const C of f.flush()){const x=c.decode(C);x&&(yield yield Me(x))}})}function KL(n){return Ci(this,arguments,function*(){var t,i,r,a;let l=new Uint8Array;try{for(var c=!0,f=bi(n),p;p=yield Me(f.next()),t=p.done,!t;c=!0){a=p.value,c=!1;const _=a;if(_==null)continue;const T=_ instanceof ArrayBuffer?new Uint8Array(_):typeof _=="string"?r_(_):_;let E=new Uint8Array(l.length+T.length);E.set(l),E.set(T,l.length),l=E;let C;for(;(C=qL(l))!==-1;)yield yield Me(l.slice(0,C)),l=l.slice(C)}}catch(_){i={error:_}}finally{try{!c&&!t&&(r=f.return)&&(yield Me(r.call(f)))}finally{if(i)throw i.error}}l.length>0&&(yield yield Me(l))})}class JL{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=$L(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function $L(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function YL(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:a}=e,l=await(async()=>{var c;if(e.options.stream)return vn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):ol.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const f=t.headers.get("content-type"),p=(c=f==null?void 0:f.split(";")[0])===null||c===void 0?void 0:c.trim();return(p==null?void 0:p.includes("application/json"))||(p==null?void 0:p.endsWith("+json"))?t.headers.get("content-length")==="0"?void 0:await t.json():await t.text()})();return vn(n).debug(`[${i}] response parsed`,xo({retryOfRequestLogID:r,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class o_ extends Promise{constructor(e,t,i=YL){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new o_(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RC=Symbol("brand.privateNullableHeaders");function*QL(n){if(!n)return;if(RC in n){const{values:i,nulls:r}=n;yield*i.entries();for(const a of r)yield[a,null];return}let e=!1,t;n instanceof Headers?t=n.entries():CA(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const a=CA(i[1])?i[1]:[i[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[r,null]),yield[r,c])}}const ic=n=>{const e=new Headers,t=new Set;for(const i of n){const r=new Set;for(const[a,l]of QL(i)){const c=a.toLowerCase();r.has(c)||(e.delete(a),r.add(c)),l===null?(e.delete(a),t.add(c)):(e.append(a,l),t.delete(c))}}return{[RC]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xg=n=>{var e,t,i,r,a,l;if(typeof globalThis.process<"u")return(i=(t=(e=mM)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||a===void 0?void 0:a.call(r,n))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var xC;class Wh{constructor(e){var t,i,r,a,l,c,f,{baseURL:p=xg("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:_=(t=xg("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:T="v1beta"}=e,E=Th(e,["baseURL","apiKey","apiVersion"]);const C=Object.assign(Object.assign({apiKey:_,apiVersion:T},E),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=C.baseURL,this.timeout=(i=C.timeout)!==null&&i!==void 0?i:Wh.DEFAULT_TIMEOUT,this.logger=(r=C.logger)!==null&&r!==void 0?r:console;const x="warn";this.logLevel=x,this.logLevel=(l=(a=MA(C.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:MA(xg("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:x,this.fetchOptions=C.fetchOptions,this.maxRetries=(c=C.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(f=C.fetch)!==null&&f!==void 0?f:xL(),this.encoder=DL,this._options=C,this.apiKey=_,this.apiVersion=T,this.clientAdapter=C.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=ic([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return ic([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return ic([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new ci(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Za}`}defaultIdempotencyKey(){return`stainless-node-retry-${mL()}`}makeStatusError(e,t,i,r){return En.generate(e,t,i,r)}buildURL(e,t,i){const r=!this.baseURLOverridden()&&i||this.baseURL,a=yL(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return TL(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(r=>Object.assign({method:e,path:t},r)))}request(e,t=null){return new o_(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var r,a,l;const c=await e,f=(r=c.maxRetries)!==null&&r!==void 0?r:this.maxRetries;t==null&&(t=f),await this.prepareOptions(c);const{req:p,url:_,timeout:T}=await this.buildRequest(c,{retryCount:f-t});await this.prepareRequest(p,{url:_,options:c});const E="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),C=i===void 0?"":`, retryOf: ${i}`,x=Date.now();if(vn(this).debug(`[${E}] sending request`,xo({retryOfRequestLogID:i,method:c.method,url:_,options:c,headers:p.headers})),!((a=c.signal)===null||a===void 0)&&a.aborted)throw new ly;const P=new AbortController,k=await this.fetchWithTimeout(_,p,T,P).catch(ay),K=Date.now();if(k instanceof globalThis.Error){const q=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new ly;const ee=oy(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(t)return vn(this).info(`[${E}] connection ${ee?"timed out":"failed"} - ${q}`),vn(this).debug(`[${E}] connection ${ee?"timed out":"failed"} (${q})`,xo({retryOfRequestLogID:i,url:_,durationMs:K-x,message:k.message})),this.retryRequest(c,t,i??E);throw vn(this).info(`[${E}] connection ${ee?"timed out":"failed"} - error; no more retries left`),vn(this).debug(`[${E}] connection ${ee?"timed out":"failed"} (error; no more retries left)`,xo({retryOfRequestLogID:i,url:_,durationMs:K-x,message:k.message})),ee?new dC:new jh({cause:k})}const W=`[${E}${C}] ${p.method} ${_} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${K-x}ms`;if(!k.ok){const q=await this.shouldRetry(k);if(t&&q){const D=`retrying, ${t} attempts remaining`;return await ML(k.body),vn(this).info(`${W} - ${D}`),vn(this).debug(`[${E}] response error (${D})`,xo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:K-x})),this.retryRequest(c,t,i??E,k.headers)}const ee=q?"error; no more retries left":"error; not retryable";vn(this).info(`${W} - ${ee}`);const ae=await k.text().catch(D=>ay(D).message),z=AL(ae),N=z?void 0:ae;throw vn(this).debug(`[${E}] response error (${ee})`,xo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,message:N,durationMs:Date.now()-x})),this.makeStatusError(k.status,z,N,k.headers)}return vn(this).info(W),vn(this).debug(`[${E}] response start`,xo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:K-x})),{response:k,options:c,controller:P,requestLogID:E,retryOfRequestLogID:i,startTime:x}}async fetchWithTimeout(e,t,i,r){const a=t||{},{signal:l,method:c}=a,f=Th(a,["signal","method"]),p=this._makeAbort(r);l&&l.addEventListener("abort",p,{once:!0});const _=setTimeout(p,i),T=globalThis.ReadableStream&&f.body instanceof globalThis.ReadableStream||typeof f.body=="object"&&f.body!==null&&Symbol.asyncIterator in f.body,E=Object.assign(Object.assign(Object.assign({signal:r.signal},T?{duplex:"half"}:{}),{method:"GET"}),f);c&&(E.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,E)}finally{clearTimeout(_)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,r){var a;let l;const c=r==null?void 0:r.get("retry-after-ms");if(c){const p=parseFloat(c);Number.isNaN(p)||(l=p)}const f=r==null?void 0:r.get("retry-after");if(f&&!l){const p=parseFloat(f);Number.isNaN(p)?l=Date.parse(f)-Date.now():l=p*1e3}if(!(l&&0<=l&&l<60*1e3)){const p=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,p)}return await IL(l),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,r,a;const l=Object.assign({},e),{method:c,path:f,query:p,defaultBaseURL:_}=l,T=this.buildURL(f,p,_);"timeout"in l&&SL("timeout",l.timeout),l.timeout=(i=l.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:E,body:C}=this.buildBody({options:l}),x=await this.buildHeaders({options:e,method:c,bodyHeaders:E,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:x},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&C instanceof globalThis.ReadableStream&&{duplex:"half"}),C&&{body:C}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:T,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:r}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=ic([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),RL()),this._options.defaultHeaders,i,e.headers,l]);return this.validateHeaders(c),c.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=ic([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:NL(e)}:this.encoder({body:e,headers:i})}}Wh.DEFAULT_TIMEOUT=6e4;class en extends Wh{constructor(){super(...arguments),this.interactions=new bC(this)}}xC=en;en.GeminiNextGenAPIClient=xC;en.GeminiNextGenAPIClientError=ci;en.APIError=En;en.APIConnectionError=jh;en.APIConnectionTimeoutError=dC;en.APIUserAbortError=ly;en.NotFoundError=mC;en.ConflictError=gC;en.RateLimitError=_C;en.BadRequestError=fC;en.AuthenticationError=hC;en.InternalServerError=vC;en.PermissionDeniedError=pC;en.UnprocessableEntityError=yC;en.toFile=UL;en.Interactions=bC;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jL(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function XL(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function WL(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function ZL(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function eU(n,e,t){const i={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(n,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const l=h(n,["learningRateMultiplier"]);if(l!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(h(n,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(h(n,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const c=h(n,["batchSize"]);e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","batchSize"],c);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&m(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(h(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(h(n,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(h(n,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(h(n,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(h(n,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(h(n,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return i}function tU(n,e,t){const i={};let r=h(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const z=h(n,["validationDataset"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec"],Ng(z))}else if(r==="PREFERENCE_TUNING"){const z=h(n,["validationDataset"]);e!==void 0&&z!=null&&m(e,["preferenceOptimizationSpec"],Ng(z))}else if(r==="DISTILLATION"){const z=h(n,["validationDataset"]);e!==void 0&&z!=null&&m(e,["distillationSpec"],Ng(z))}const a=h(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const l=h(n,["description"]);e!==void 0&&l!=null&&m(e,["description"],l);let c=h(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const z=h(n,["epochCount"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],z)}else if(c==="PREFERENCE_TUNING"){const z=h(n,["epochCount"]);e!==void 0&&z!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],z)}else if(c==="DISTILLATION"){const z=h(n,["epochCount"]);e!==void 0&&z!=null&&m(e,["distillationSpec","hyperParameters","epochCount"],z)}let f=h(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const z=h(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],z)}else if(f==="PREFERENCE_TUNING"){const z=h(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],z)}else if(f==="DISTILLATION"){const z=h(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&m(e,["distillationSpec","hyperParameters","learningRateMultiplier"],z)}let p=h(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const z=h(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],z)}else if(p==="PREFERENCE_TUNING"){const z=h(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],z)}else if(p==="DISTILLATION"){const z=h(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&m(e,["distillationSpec","exportLastCheckpointOnly"],z)}let _=h(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const z=h(n,["adapterSize"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],z)}else if(_==="PREFERENCE_TUNING"){const z=h(n,["adapterSize"]);e!==void 0&&z!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],z)}else if(_==="DISTILLATION"){const z=h(n,["adapterSize"]);e!==void 0&&z!=null&&m(e,["distillationSpec","hyperParameters","adapterSize"],z)}let T=h(t,["config","method"]);if(T===void 0&&(T="SUPERVISED_FINE_TUNING"),T==="SUPERVISED_FINE_TUNING"){const z=h(n,["tuningMode"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","tuningMode"],z)}const E=h(n,["customBaseModel"]);e!==void 0&&E!=null&&m(e,["customBaseModel"],E);let C=h(t,["config","method"]);if(C===void 0&&(C="SUPERVISED_FINE_TUNING"),C==="SUPERVISED_FINE_TUNING"){const z=h(n,["batchSize"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","hyperParameters","batchSize"],z)}let x=h(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const z=h(n,["learningRate"]);e!==void 0&&z!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRate"],z)}const P=h(n,["labels"]);e!==void 0&&P!=null&&m(e,["labels"],P);const k=h(n,["beta"]);e!==void 0&&k!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],k);const K=h(n,["baseTeacherModel"]);e!==void 0&&K!=null&&m(e,["distillationSpec","baseTeacherModel"],K);const W=h(n,["tunedTeacherModelSource"]);e!==void 0&&W!=null&&m(e,["distillationSpec","tunedTeacherModelSource"],W);const q=h(n,["sftLossWeightMultiplier"]);e!==void 0&&q!=null&&m(e,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],q);const ee=h(n,["outputUri"]);e!==void 0&&ee!=null&&m(e,["outputUri"],ee);const ae=h(n,["encryptionSpec"]);return e!==void 0&&ae!=null&&m(e,["encryptionSpec"],ae),i}function nU(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const r=h(n,["preTunedModel"]);r!=null&&m(t,["preTunedModel"],r);const a=h(n,["trainingDataset"]);a!=null&&hU(a);const l=h(n,["config"]);return l!=null&&eU(l,t),t}function iU(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const r=h(n,["preTunedModel"]);r!=null&&m(t,["preTunedModel"],r);const a=h(n,["trainingDataset"]);a!=null&&pU(a,t,e);const l=h(n,["config"]);return l!=null&&tU(l,t,e),t}function sU(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function rU(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function oU(n,e,t){const i={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function aU(n,e,t){const i={},r=h(n,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function lU(n,e){const t={},i=h(n,["config"]);return i!=null&&oU(i,t),t}function uU(n,e){const t={},i=h(n,["config"]);return i!=null&&aU(i,t),t}function cU(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["nextPageToken"]);r!=null&&m(t,["nextPageToken"],r);const a=h(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>NC(c))),m(t,["tuningJobs"],l)}return t}function dU(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["nextPageToken"]);r!=null&&m(t,["nextPageToken"],r);const a=h(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>dy(c))),m(t,["tuningJobs"],l)}return t}function fU(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["model"],i);const r=h(n,["name"]);return r!=null&&m(t,["endpoint"],r),t}function hU(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=h(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(t,["examples","examples"],r)}return t}function pU(n,e,t){const i={};let r=h(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(r==="PREFERENCE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(r==="DISTILLATION"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["distillationSpec","promptDatasetUri"],l)}let a=h(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}else if(a==="DISTILLATION"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["distillationSpec","promptDatasetUri"],l)}if(h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function NC(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["name"]);r!=null&&m(t,["name"],r);const a=h(n,["state"]);a!=null&&m(t,["state"],Jw(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const c=h(n,["tuningTask","startTime"]);c!=null&&m(t,["startTime"],c);const f=h(n,["tuningTask","completeTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["description"]);_!=null&&m(t,["description"],_);const T=h(n,["baseModel"]);T!=null&&m(t,["baseModel"],T);const E=h(n,["_self"]);return E!=null&&m(t,["tunedModel"],fU(E)),t}function dy(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["name"]);r!=null&&m(t,["name"],r);const a=h(n,["state"]);a!=null&&m(t,["state"],Jw(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const c=h(n,["startTime"]);c!=null&&m(t,["startTime"],c);const f=h(n,["endTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["error"]);_!=null&&m(t,["error"],_);const T=h(n,["description"]);T!=null&&m(t,["description"],T);const E=h(n,["baseModel"]);E!=null&&m(t,["baseModel"],E);const C=h(n,["tunedModel"]);C!=null&&m(t,["tunedModel"],C);const x=h(n,["preTunedModel"]);x!=null&&m(t,["preTunedModel"],x);const P=h(n,["supervisedTuningSpec"]);P!=null&&m(t,["supervisedTuningSpec"],P);const k=h(n,["preferenceOptimizationSpec"]);k!=null&&m(t,["preferenceOptimizationSpec"],k);const K=h(n,["distillationSpec"]);K!=null&&m(t,["distillationSpec"],K);const W=h(n,["tuningDataStats"]);W!=null&&m(t,["tuningDataStats"],W);const q=h(n,["encryptionSpec"]);q!=null&&m(t,["encryptionSpec"],q);const ee=h(n,["partnerModelTuningSpec"]);ee!=null&&m(t,["partnerModelTuningSpec"],ee);const ae=h(n,["customBaseModel"]);ae!=null&&m(t,["customBaseModel"],ae);const z=h(n,["experiment"]);z!=null&&m(t,["experiment"],z);const N=h(n,["labels"]);N!=null&&m(t,["labels"],N);const M=h(n,["outputUri"]);M!=null&&m(t,["outputUri"],M);const D=h(n,["pipelineJob"]);D!=null&&m(t,["pipelineJob"],D);const L=h(n,["serviceAccount"]);L!=null&&m(t,["serviceAccount"],L);const U=h(n,["tunedModelDisplayName"]);U!=null&&m(t,["tunedModelDisplayName"],U);const G=h(n,["veoTuningSpec"]);return G!=null&&m(t,["veoTuningSpec"],G),t}function mU(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const r=h(n,["name"]);r!=null&&m(t,["name"],r);const a=h(n,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(n,["done"]);l!=null&&m(t,["done"],l);const c=h(n,["error"]);return c!=null&&m(t,["error"],c),t}function Ng(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["validationDatasetUri"],i);const r=h(n,["vertexDatasetResource"]);return r!=null&&m(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gU extends Fs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ea(Ps.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:r});return a.baseModel=void 0,await this.tuneInternal(a)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),a=await this.tuneMldevInternal(r);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Wg.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=rU(e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>dy(_))}else{const p=sU(e);return c=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>NC(_))}}async listInternal(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=uU(e);return c=me("tuningJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=dU(_),E=new rA;return Object.assign(E,T),E})}else{const p=lU(e);return c=me("tunedModels",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=cU(_),E=new rA;return Object.assign(E,T),E})}}async cancel(e){var t,i,r,a;let l,c="",f={};if(this.apiClient.isVertexAI()){const p=XL(e);return c=me("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=ZL(_),E=new oA;return Object.assign(E,T),E})}else{const p=jL(e);return c=me("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:c,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(T=>{const E=T;return E.sdkHttpResponse={headers:_.headers},E})),l.then(_=>{const T=WL(_),E=new oA;return Object.assign(E,T),E})}}async tuneInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI()){const c=iU(e,e);return a=me("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>dy(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=nU(e);return a=me("tunedModels",c._url),l=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),r.then(f=>mU(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yU{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _U=1024*1024*8,vU=3,TU=1e3,EU=2,Sh="x-goog-upload-status";async function SU(n,e,t){var i;const r=await MC(n,e,t),a=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Sh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function AU(n,e,t){var i;const r=await MC(n,e,t),a=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Sh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=Bw(a),c=new Zy;return Object.assign(c,l),c}async function MC(n,e,t){var i,r;let a=0,l=0,c=new ey(new Response),f="upload";for(a=n.size;l<a;){const p=Math.min(_U,a-l),_=n.slice(l,l+p);l+p>=a&&(f+=", finalize");let T=0,E=TU;for(;T<vU&&(c=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((i=c==null?void 0:c.headers)===null||i===void 0)&&i[Sh]));)T++,await wU(E),E=E*EU;if(l+=p,((r=c==null?void 0:c.headers)===null||r===void 0?void 0:r[Sh])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function IU(n){return{size:n.size,type:n.type}}function wU(n){return new Promise(e=>setTimeout(e,n))}class CU{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SU(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await AU(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await IU(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bU{create(e,t,i){return new RU(e,t,i)}}class RU{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PA="x-goog-api-key";class xU{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(PA)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(PA,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NU="gl-node/";class MU{get interactions(){var e;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const i=new en({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout,maxRetries:(e=t==null?void 0:t.retryOptions)===null||e===void 0?void 0:e.attempts});return this._interactions=i.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=vM(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new xU(this.apiKey);this.apiClient=new Ik({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:NU+"web",uploader:new CU,downloader:new yU}),this.models=new zk(this.apiClient),this.live=new Uk(this.apiClient,r,new bU),this.batches=new QD(this.apiClient),this.chats=new N2(this.models,this.apiClient),this.caches=new b2(this.apiClient),this.files=new q2(this.apiClient),this.operations=new Hk(this.apiClient),this.authTokens=new oL(this.apiClient),this.tunings=new gU(this.apiClient),this.fileSearchStores=new pL(this.apiClient)}}const sc=()=>new MU({apiKey:"AIzaSyDss0sbMOYsobjRWlcBD8oI4zys56j7T7Q"}),Gf=(n,e=45e3)=>Promise.race([n,new Promise((t,i)=>setTimeout(()=>i(new Error(`AI Timed out after ${e}ms`)),e))]),DU={type:de.OBJECT,properties:{type:{type:de.STRING,enum:["AQUATIC","TERRESTRIAL","PHOTOSYNTHETIC","INVERTEBRATE","VERTEBRATE","COLONY"]},parameters:{type:de.OBJECT,properties:{pH:{type:de.NUMBER},temp:{type:de.NUMBER},salinity:{type:de.STRING},humidity:{type:de.NUMBER},substrate:{type:de.STRING},lightReq:{type:de.STRING},co2:{type:de.BOOLEAN},molting:{type:de.BOOLEAN},colony:{type:de.BOOLEAN},diet:{type:de.STRING},estimatedCount:{type:de.NUMBER},stable:{type:de.BOOLEAN},nitrates:{type:de.NUMBER},ammonia:{type:de.NUMBER}}}},required:["type"]},PU={type:de.OBJECT,properties:{intent:{type:de.STRING,description:"ACCESSION_ENTITY, LOG_OBSERVATION, MODIFY_HABITAT, or QUERY"},targetHabitatName:{type:de.STRING},candidates:{type:de.ARRAY,items:{type:de.OBJECT,properties:{commonName:{type:de.STRING},scientificName:{type:de.STRING},quantity:{type:de.NUMBER},traits:{type:de.ARRAY,items:DU}},required:["commonName","traits"]}},observationNotes:{type:de.STRING},observationParams:{type:de.OBJECT,properties:{pH:{type:de.NUMBER},temp:{type:de.NUMBER},ammonia:{type:de.NUMBER},nitrites:{type:de.NUMBER},nitrates:{type:de.NUMBER},humidity:{type:de.NUMBER},growth_cm:{type:de.NUMBER},is_blooming:{type:de.BOOLEAN},count_update:{type:de.NUMBER}}},habitatParams:{type:de.OBJECT,properties:{name:{type:de.STRING},size:{type:de.NUMBER},unit:{type:de.STRING},type:{type:de.STRING},location:{type:de.STRING}}},aiReasoning:{type:de.STRING},isAmbiguous:{type:de.BOOLEAN}},required:["intent","aiReasoning"]},xc={async parseVoiceCommand(n,e){const t=sc(),i=e.map(l=>({id:l.id,name:l.name,aliases:l.aliases})),r=`
      You are the Principal Curator of "The Conservatory". Parse user voice input into structured JSON.
      Existing Index: ${JSON.stringify(i)}
      Priority: Speed. Use gemini-flash-lite-latest.
    `,a=await Gf(t.models.generateContent({model:"gemini-flash-lite-latest",contents:n,config:{systemInstruction:r,responseMimeType:"application/json",responseSchema:PU}}));return JSON.parse(a.text||"{}")},async identifyPhoto(n){const e=sc(),t=await Gf(e.models.generateContent({model:"gemini-3-pro-preview",contents:{parts:[{inlineData:{data:n,mimeType:"image/jpeg"}},{text:"Identify the species in this photo with high precision. Provide reasoning and confidence."}]},config:{responseMimeType:"application/json",responseSchema:{type:de.OBJECT,properties:{species:{type:de.STRING},common_name:{type:de.STRING},kingdom:{type:de.STRING},confidence:{type:de.NUMBER},reasoning:{type:de.STRING}},required:["species","common_name","kingdom","confidence"]}}}));return JSON.parse(t.text||"{}")},async analyzeRackScene(n){const e=sc(),t=await Gf(e.models.generateContent({model:"gemini-3-pro-preview",contents:{parts:[{inlineData:{data:n,mimeType:"image/jpeg"}},{text:"Identify all aquarium/terrarium containers on this rack. Map their position and contents."}]},config:{responseMimeType:"application/json",responseSchema:{type:de.OBJECT,properties:{containers:{type:de.ARRAY,items:{type:de.OBJECT,properties:{id:{type:de.STRING},shelf_level:{type:de.STRING,enum:["top","middle","bottom","unknown"]},horizontal_position:{type:de.STRING,enum:["left","center","right","unknown"]},size_estimate:{type:de.STRING},primary_species:{type:de.ARRAY,items:{type:de.OBJECT,properties:{common_name:{type:de.STRING},scientific_name:{type:de.STRING},confidence:{type:de.NUMBER}},required:["common_name","scientific_name","confidence"]}},plants:{type:de.ARRAY,items:{type:de.STRING}},equipment:{type:de.ARRAY,items:{type:de.STRING}},confidence:{type:de.NUMBER}},required:["shelf_level","horizontal_position","size_estimate","primary_species","confidence"]}}},required:["containers"]}}}));return JSON.parse(t.text||'{"containers": []}')},async getAdvisoryReport(n){const e=sc(),t=await Gf(e.models.generateContent({model:"gemini-3-pro-preview",contents:`Propose an implementation strategy for the following user request: ${n}`,config:{systemInstruction:"You are an expert system architect specializing in digital twin management. Provide implementation reports.",responseMimeType:"application/json",responseSchema:{type:de.OBJECT,properties:{strategy:{type:de.STRING},implementation_steps:{type:de.ARRAY,items:{type:de.STRING}},impact_analysis:{type:de.STRING},ide_prompt:{type:de.STRING},persistence_status:{type:de.STRING,enum:["SECURE","AUDIT_FAILED"]}},required:["strategy","implementation_steps","impact_analysis","ide_prompt","persistence_status"]}}}));return JSON.parse(t.text||"{}")},async chat(n,e=[],t={}){var p,_,T,E;const i=sc(),r=t.search?"gemini-3-flash-preview":"gemini-3-pro-preview",a={};t.search&&(a.tools=[{googleSearch:{}}]),t.thinking&&!t.search&&(a.thinkingConfig={thinkingBudget:32768});const c=await i.chats.create({model:r,config:{...a,systemInstruction:"You are the Conservatory Guide. Help with aquaculture, biology, and system operations."},history:e.map(C=>({role:C.role,parts:[{text:C.text}]}))}).sendMessage({message:n}),f=(E=(T=(_=(p=c.candidates)==null?void 0:p[0])==null?void 0:_.groundingMetadata)==null?void 0:T.groundingChunks)==null?void 0:E.map(C=>{var x,P;return{title:((x=C.web)==null?void 0:x.title)||"Source",uri:(P=C.web)==null?void 0:P.uri}}).filter(C=>C.uri);return{text:c.text||"No response received.",links:f}}},VU=()=>{};var VA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},kU=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const a=n[t++];e[i++]=String.fromCharCode((r&31)<<6|a&63)}else if(r>239&&r<365){const a=n[t++],l=n[t++],c=n[t++],f=((r&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(a&63)<<6|l&63)}}return e.join("")},PC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const a=n[r],l=r+1<n.length,c=l?n[r+1]:0,f=r+2<n.length,p=f?n[r+2]:0,_=a>>2,T=(a&3)<<4|c>>4;let E=(c&15)<<2|p>>6,C=p&63;f||(C=64,l||(E=64)),i.push(t[_],t[T],t[E],t[C])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(DC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const a=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;const p=r<n.length?t[n.charAt(r)]:64;++r;const T=r<n.length?t[n.charAt(r)]:64;if(++r,a==null||c==null||p==null||T==null)throw new LU;const E=a<<2|c>>4;if(i.push(E),p!==64){const C=c<<4&240|p>>2;if(i.push(C),T!==64){const x=p<<6&192|T;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class LU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UU=function(n){const e=DC(n);return PC.encodeByteArray(e,!0)},VC=function(n){return UU(n).replace(/\./g,"")},kC=function(n){try{return PC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU=()=>LC().__FIREBASE_DEFAULTS__,FU=()=>{if(typeof process>"u"||typeof VA>"u")return;const n=VA.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&kC(n[1]);return e&&JSON.parse(e)},Zh=()=>{try{return VU()||OU()||FU()||BU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},GU=n=>{var e,t;return(t=(e=Zh())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},UC=()=>{var n;return(n=Zh())==null?void 0:n.config},OC=n=>{var e;return(e=Zh())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function FC(n){return(await fetch(n,{credentials:"include"})).ok}const yc={};function zU(){const n={prod:[],emulator:[]};for(const e of Object.keys(yc))yc[e]?n.emulator.push(e):n.prod.push(e);return n}function HU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let kA=!1;function KU(n,e){if(typeof window>"u"||typeof document>"u"||!Gl(window.location.host)||yc[n]===e||yc[n]||kA)return;yc[n]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",a=zU().prod.length>0;function l(){const E=document.getElementById(i);E&&E.remove()}function c(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function f(E,C){E.setAttribute("width","24"),E.setAttribute("id",C),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function p(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{kA=!0,l()},E}function _(E,C){E.setAttribute("id",C),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function T(){const E=HU(i),C=t("text"),x=document.getElementById(C)||document.createElement("span"),P=t("learnmore"),k=document.getElementById(P)||document.createElement("a"),K=t("preprendIcon"),W=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const q=E.element;c(q),_(k,P);const ee=p();f(W,K),q.append(W,x,k,ee),document.body.appendChild(q)}a?(x.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yt())}function BC(){var e;const n=(e=Zh())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $U(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function QU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jU(){const n=Yt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function GC(){return!BC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qC(){return!BC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function zC(){try{return typeof indexedDB=="object"}catch{return!1}}function XU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var a;e(((a=r.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU="FirebaseError";class Gs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=WU,Object.setPrototypeOf(this,Gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jc.prototype.create)}}class Jc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,a=this.errors[e],l=a?ZU(a,i):"Error",c=`${this.serviceName}: ${l} (${r}).`;return new Gs(r,c,i)}}function ZU(n,e){return n.replace(e4,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const e4=/\{\$([^}]+)}/g;function t4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const a=n[r],l=e[r];if(LA(a)&&LA(l)){if(!Ho(a,l))return!1}else if(a!==l)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function LA(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function n4(n,e){const t=new i4(n,e);return t.subscribe.bind(t)}class i4{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");s4(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Mg),r.error===void 0&&(r.error=Mg),r.complete===void 0&&(r.complete=Mg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function s4(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Mg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(n){return n&&n._delegate?n._delegate:n}class Ko{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new qU;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(a4(e))try{this.getOrInitializeService({instanceIdentifier:No})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:r});i.resolve(a)}catch{}}}}clearInstance(e=No){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=No){return this.instances.has(e)}getOptions(e=No){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);i===c&&l.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:o4(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=No){return this.component?this.component.multipleInstances?e:No:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o4(n){return n===No?void 0:n}function a4(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new r4(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const u4={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},c4=He.INFO,d4={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},f4=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=d4[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class a_{constructor(e){this.name=e,this._logLevel=c4,this._logHandler=f4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?u4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const h4=(n,e)=>e.some(t=>n instanceof t);let UA,OA;function p4(){return UA||(UA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m4(){return OA||(OA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HC=new WeakMap,fy=new WeakMap,KC=new WeakMap,Dg=new WeakMap,l_=new WeakMap;function g4(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Mr(n.result)),r()},l=()=>{i(n.error),r()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&HC.set(t,n)}).catch(()=>{}),l_.set(e,n),e}function y4(n){if(fy.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),r()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});fy.set(n,e)}let hy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return fy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||KC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _4(n){hy=n(hy)}function v4(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Pg(this),e,...t);return KC.set(i,e.sort?e.sort():[e]),Mr(i)}:m4().includes(n)?function(...e){return n.apply(Pg(this),e),Mr(HC.get(this))}:function(...e){return Mr(n.apply(Pg(this),e))}}function T4(n){return typeof n=="function"?v4(n):(n instanceof IDBTransaction&&y4(n),h4(n,p4())?new Proxy(n,hy):n)}function Mr(n){if(n instanceof IDBRequest)return g4(n);if(Dg.has(n))return Dg.get(n);const e=T4(n);return e!==n&&(Dg.set(n,e),l_.set(e,n)),e}const Pg=n=>l_.get(n);function E4(n,e,{blocked:t,upgrade:i,blocking:r,terminated:a}={}){const l=indexedDB.open(n,e),c=Mr(l);return i&&l.addEventListener("upgradeneeded",f=>{i(Mr(l.result),f.oldVersion,f.newVersion,Mr(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),c.then(f=>{a&&f.addEventListener("close",()=>a()),r&&f.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const S4=["get","getKey","getAll","getAllKeys","count"],A4=["put","add","delete","clear"],Vg=new Map;function FA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Vg.get(e))return Vg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=A4.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||S4.includes(t)))return;const a=async function(l,...c){const f=this.transaction(l,r?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(c.shift())),(await Promise.all([p[t](...c),r&&f.done]))[0]};return Vg.set(e,a),a}_4(n=>({...n,get:(e,t,i)=>FA(e,t)||n.get(e,t,i),has:(e,t)=>!!FA(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(w4(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function w4(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const py="@firebase/app",BA="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=new a_("@firebase/app"),C4="@firebase/app-compat",b4="@firebase/analytics-compat",R4="@firebase/analytics",x4="@firebase/app-check-compat",N4="@firebase/app-check",M4="@firebase/auth",D4="@firebase/auth-compat",P4="@firebase/database",V4="@firebase/data-connect",k4="@firebase/database-compat",L4="@firebase/functions",U4="@firebase/functions-compat",O4="@firebase/installations",F4="@firebase/installations-compat",B4="@firebase/messaging",G4="@firebase/messaging-compat",q4="@firebase/performance",z4="@firebase/performance-compat",H4="@firebase/remote-config",K4="@firebase/remote-config-compat",J4="@firebase/storage",$4="@firebase/storage-compat",Y4="@firebase/firestore",Q4="@firebase/ai",j4="@firebase/firestore-compat",X4="firebase",W4="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="[DEFAULT]",Z4={[py]:"fire-core",[C4]:"fire-core-compat",[R4]:"fire-analytics",[b4]:"fire-analytics-compat",[N4]:"fire-app-check",[x4]:"fire-app-check-compat",[M4]:"fire-auth",[D4]:"fire-auth-compat",[P4]:"fire-rtdb",[V4]:"fire-data-connect",[k4]:"fire-rtdb-compat",[L4]:"fire-fn",[U4]:"fire-fn-compat",[O4]:"fire-iid",[F4]:"fire-iid-compat",[B4]:"fire-fcm",[G4]:"fire-fcm-compat",[q4]:"fire-perf",[z4]:"fire-perf-compat",[H4]:"fire-rc",[K4]:"fire-rc-compat",[J4]:"fire-gcs",[$4]:"fire-gcs-compat",[Y4]:"fire-fst",[j4]:"fire-fst-compat",[Q4]:"fire-vertex","fire-js":"fire-js",[X4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=new Map,eO=new Map,gy=new Map;function GA(n,e){try{n.container.addComponent(e)}catch(t){Vs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function gl(n){const e=n.name;if(gy.has(e))return Vs.debug(`There were multiple attempts to register component ${e}.`),!1;gy.set(e,n);for(const t of Nc.values())GA(t,n);for(const t of eO.values())GA(t,n);return!0}function u_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ii(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dr=new Jc("app","Firebase",tO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ko("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ql=W4;function JC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:my,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Dr.create("bad-app-name",{appName:String(r)});if(t||(t=UC()),!t)throw Dr.create("no-options");const a=Nc.get(r);if(a){if(Ho(t,a.options)&&Ho(i,a.config))return a;throw Dr.create("duplicate-app",{appName:r})}const l=new l4(r);for(const f of gy.values())l.addComponent(f);const c=new nO(t,i,l);return Nc.set(r,c),c}function $C(n=my){const e=Nc.get(n);if(!e&&n===my&&UC())return JC();if(!e)throw Dr.create("no-app",{appName:n});return e}function iO(){return Array.from(Nc.values())}function Pr(n,e,t){let i=Z4[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vs.warn(l.join(" "));return}gl(new Ko(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO="firebase-heartbeat-database",rO=1,Mc="firebase-heartbeat-store";let kg=null;function YC(){return kg||(kg=E4(sO,rO,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Mc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Dr.create("idb-open",{originalErrorMessage:n.message})})),kg}async function oO(n){try{const t=(await YC()).transaction(Mc),i=await t.objectStore(Mc).get(QC(n));return await t.done,i}catch(e){if(e instanceof Gs)Vs.warn(e.message);else{const t=Dr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vs.warn(t.message)}}}async function qA(n,e){try{const i=(await YC()).transaction(Mc,"readwrite");await i.objectStore(Mc).put(e,QC(n)),await i.done}catch(t){if(t instanceof Gs)Vs.warn(t.message);else{const i=Dr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Vs.warn(i.message)}}}function QC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=1024,lO=30;class uO{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dO(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=zA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:r}),this._heartbeatsCache.heartbeats.length>lO){const l=fO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Vs.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=zA(),{heartbeatsToSend:i,unsentEntries:r}=cO(this._heartbeatsCache.heartbeats),a=VC(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Vs.warn(t),""}}}function zA(){return new Date().toISOString().substring(0,10)}function cO(n,e=aO){const t=[];let i=n.slice();for(const r of n){const a=t.find(l=>l.agent===r.agent);if(a){if(a.dates.push(r.date),HA(t)>e){a.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),HA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class dO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zC()?XU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await oO(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return qA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return qA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function HA(n){return VC(JSON.stringify({version:2,heartbeats:n})).length}function fO(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(n){gl(new Ko("platform-logger",e=>new I4(e),"PRIVATE")),gl(new Ko("heartbeat",e=>new uO(e),"PRIVATE")),Pr(py,BA,n),Pr(py,BA,"esm2020"),Pr("fire-js","")}hO("");var pO="firebase",mO="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr(pO,mO,"app");var KA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vr,jC;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,M){function D(){}D.prototype=M.prototype,N.F=M.prototype,N.prototype=new D,N.prototype.constructor=N,N.D=function(L,U,G){for(var V=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)V[ke-2]=arguments[ke];return M.prototype[U].apply(L,V)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(N,M,D){D||(D=0);const L=Array(16);if(typeof M=="string")for(var U=0;U<16;++U)L[U]=M.charCodeAt(D++)|M.charCodeAt(D++)<<8|M.charCodeAt(D++)<<16|M.charCodeAt(D++)<<24;else for(U=0;U<16;++U)L[U]=M[D++]|M[D++]<<8|M[D++]<<16|M[D++]<<24;M=N.g[0],D=N.g[1],U=N.g[2];let G=N.g[3],V;V=M+(G^D&(U^G))+L[0]+3614090360&4294967295,M=D+(V<<7&4294967295|V>>>25),V=G+(U^M&(D^U))+L[1]+3905402710&4294967295,G=M+(V<<12&4294967295|V>>>20),V=U+(D^G&(M^D))+L[2]+606105819&4294967295,U=G+(V<<17&4294967295|V>>>15),V=D+(M^U&(G^M))+L[3]+3250441966&4294967295,D=U+(V<<22&4294967295|V>>>10),V=M+(G^D&(U^G))+L[4]+4118548399&4294967295,M=D+(V<<7&4294967295|V>>>25),V=G+(U^M&(D^U))+L[5]+1200080426&4294967295,G=M+(V<<12&4294967295|V>>>20),V=U+(D^G&(M^D))+L[6]+2821735955&4294967295,U=G+(V<<17&4294967295|V>>>15),V=D+(M^U&(G^M))+L[7]+4249261313&4294967295,D=U+(V<<22&4294967295|V>>>10),V=M+(G^D&(U^G))+L[8]+1770035416&4294967295,M=D+(V<<7&4294967295|V>>>25),V=G+(U^M&(D^U))+L[9]+2336552879&4294967295,G=M+(V<<12&4294967295|V>>>20),V=U+(D^G&(M^D))+L[10]+4294925233&4294967295,U=G+(V<<17&4294967295|V>>>15),V=D+(M^U&(G^M))+L[11]+2304563134&4294967295,D=U+(V<<22&4294967295|V>>>10),V=M+(G^D&(U^G))+L[12]+1804603682&4294967295,M=D+(V<<7&4294967295|V>>>25),V=G+(U^M&(D^U))+L[13]+4254626195&4294967295,G=M+(V<<12&4294967295|V>>>20),V=U+(D^G&(M^D))+L[14]+2792965006&4294967295,U=G+(V<<17&4294967295|V>>>15),V=D+(M^U&(G^M))+L[15]+1236535329&4294967295,D=U+(V<<22&4294967295|V>>>10),V=M+(U^G&(D^U))+L[1]+4129170786&4294967295,M=D+(V<<5&4294967295|V>>>27),V=G+(D^U&(M^D))+L[6]+3225465664&4294967295,G=M+(V<<9&4294967295|V>>>23),V=U+(M^D&(G^M))+L[11]+643717713&4294967295,U=G+(V<<14&4294967295|V>>>18),V=D+(G^M&(U^G))+L[0]+3921069994&4294967295,D=U+(V<<20&4294967295|V>>>12),V=M+(U^G&(D^U))+L[5]+3593408605&4294967295,M=D+(V<<5&4294967295|V>>>27),V=G+(D^U&(M^D))+L[10]+38016083&4294967295,G=M+(V<<9&4294967295|V>>>23),V=U+(M^D&(G^M))+L[15]+3634488961&4294967295,U=G+(V<<14&4294967295|V>>>18),V=D+(G^M&(U^G))+L[4]+3889429448&4294967295,D=U+(V<<20&4294967295|V>>>12),V=M+(U^G&(D^U))+L[9]+568446438&4294967295,M=D+(V<<5&4294967295|V>>>27),V=G+(D^U&(M^D))+L[14]+3275163606&4294967295,G=M+(V<<9&4294967295|V>>>23),V=U+(M^D&(G^M))+L[3]+4107603335&4294967295,U=G+(V<<14&4294967295|V>>>18),V=D+(G^M&(U^G))+L[8]+1163531501&4294967295,D=U+(V<<20&4294967295|V>>>12),V=M+(U^G&(D^U))+L[13]+2850285829&4294967295,M=D+(V<<5&4294967295|V>>>27),V=G+(D^U&(M^D))+L[2]+4243563512&4294967295,G=M+(V<<9&4294967295|V>>>23),V=U+(M^D&(G^M))+L[7]+1735328473&4294967295,U=G+(V<<14&4294967295|V>>>18),V=D+(G^M&(U^G))+L[12]+2368359562&4294967295,D=U+(V<<20&4294967295|V>>>12),V=M+(D^U^G)+L[5]+4294588738&4294967295,M=D+(V<<4&4294967295|V>>>28),V=G+(M^D^U)+L[8]+2272392833&4294967295,G=M+(V<<11&4294967295|V>>>21),V=U+(G^M^D)+L[11]+1839030562&4294967295,U=G+(V<<16&4294967295|V>>>16),V=D+(U^G^M)+L[14]+4259657740&4294967295,D=U+(V<<23&4294967295|V>>>9),V=M+(D^U^G)+L[1]+2763975236&4294967295,M=D+(V<<4&4294967295|V>>>28),V=G+(M^D^U)+L[4]+1272893353&4294967295,G=M+(V<<11&4294967295|V>>>21),V=U+(G^M^D)+L[7]+4139469664&4294967295,U=G+(V<<16&4294967295|V>>>16),V=D+(U^G^M)+L[10]+3200236656&4294967295,D=U+(V<<23&4294967295|V>>>9),V=M+(D^U^G)+L[13]+681279174&4294967295,M=D+(V<<4&4294967295|V>>>28),V=G+(M^D^U)+L[0]+3936430074&4294967295,G=M+(V<<11&4294967295|V>>>21),V=U+(G^M^D)+L[3]+3572445317&4294967295,U=G+(V<<16&4294967295|V>>>16),V=D+(U^G^M)+L[6]+76029189&4294967295,D=U+(V<<23&4294967295|V>>>9),V=M+(D^U^G)+L[9]+3654602809&4294967295,M=D+(V<<4&4294967295|V>>>28),V=G+(M^D^U)+L[12]+3873151461&4294967295,G=M+(V<<11&4294967295|V>>>21),V=U+(G^M^D)+L[15]+530742520&4294967295,U=G+(V<<16&4294967295|V>>>16),V=D+(U^G^M)+L[2]+3299628645&4294967295,D=U+(V<<23&4294967295|V>>>9),V=M+(U^(D|~G))+L[0]+4096336452&4294967295,M=D+(V<<6&4294967295|V>>>26),V=G+(D^(M|~U))+L[7]+1126891415&4294967295,G=M+(V<<10&4294967295|V>>>22),V=U+(M^(G|~D))+L[14]+2878612391&4294967295,U=G+(V<<15&4294967295|V>>>17),V=D+(G^(U|~M))+L[5]+4237533241&4294967295,D=U+(V<<21&4294967295|V>>>11),V=M+(U^(D|~G))+L[12]+1700485571&4294967295,M=D+(V<<6&4294967295|V>>>26),V=G+(D^(M|~U))+L[3]+2399980690&4294967295,G=M+(V<<10&4294967295|V>>>22),V=U+(M^(G|~D))+L[10]+4293915773&4294967295,U=G+(V<<15&4294967295|V>>>17),V=D+(G^(U|~M))+L[1]+2240044497&4294967295,D=U+(V<<21&4294967295|V>>>11),V=M+(U^(D|~G))+L[8]+1873313359&4294967295,M=D+(V<<6&4294967295|V>>>26),V=G+(D^(M|~U))+L[15]+4264355552&4294967295,G=M+(V<<10&4294967295|V>>>22),V=U+(M^(G|~D))+L[6]+2734768916&4294967295,U=G+(V<<15&4294967295|V>>>17),V=D+(G^(U|~M))+L[13]+1309151649&4294967295,D=U+(V<<21&4294967295|V>>>11),V=M+(U^(D|~G))+L[4]+4149444226&4294967295,M=D+(V<<6&4294967295|V>>>26),V=G+(D^(M|~U))+L[11]+3174756917&4294967295,G=M+(V<<10&4294967295|V>>>22),V=U+(M^(G|~D))+L[2]+718787259&4294967295,U=G+(V<<15&4294967295|V>>>17),V=D+(G^(U|~M))+L[9]+3951481745&4294967295,N.g[0]=N.g[0]+M&4294967295,N.g[1]=N.g[1]+(U+(V<<21&4294967295|V>>>11))&4294967295,N.g[2]=N.g[2]+U&4294967295,N.g[3]=N.g[3]+G&4294967295}i.prototype.v=function(N,M){M===void 0&&(M=N.length);const D=M-this.blockSize,L=this.C;let U=this.h,G=0;for(;G<M;){if(U==0)for(;G<=D;)r(this,N,G),G+=this.blockSize;if(typeof N=="string"){for(;G<M;)if(L[U++]=N.charCodeAt(G++),U==this.blockSize){r(this,L),U=0;break}}else for(;G<M;)if(L[U++]=N[G++],U==this.blockSize){r(this,L),U=0;break}}this.h=U,this.o+=M},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var M=1;M<N.length-8;++M)N[M]=0;M=this.o*8;for(var D=N.length-8;D<N.length;++D)N[D]=M&255,M/=256;for(this.v(N),N=Array(16),M=0,D=0;D<4;++D)for(let L=0;L<32;L+=8)N[M++]=this.g[D]>>>L&255;return N};function a(N,M){var D=c;return Object.prototype.hasOwnProperty.call(D,N)?D[N]:D[N]=M(N)}function l(N,M){this.h=M;const D=[];let L=!0;for(let U=N.length-1;U>=0;U--){const G=N[U]|0;L&&G==M||(D[U]=G,L=!1)}this.g=D}var c={};function f(N){return-128<=N&&N<128?a(N,function(M){return new l([M|0],M<0?-1:0)}):new l([N|0],N<0?-1:0)}function p(N){if(isNaN(N)||!isFinite(N))return T;if(N<0)return k(p(-N));const M=[];let D=1;for(let L=0;N>=D;L++)M[L]=N/D|0,D*=4294967296;return new l(M,0)}function _(N,M){if(N.length==0)throw Error("number format error: empty string");if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(N.charAt(0)=="-")return k(_(N.substring(1),M));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=p(Math.pow(M,8));let L=T;for(let G=0;G<N.length;G+=8){var U=Math.min(8,N.length-G);const V=parseInt(N.substring(G,G+U),M);U<8?(U=p(Math.pow(M,U)),L=L.j(U).add(p(V))):(L=L.j(D),L=L.add(p(V)))}return L}var T=f(0),E=f(1),C=f(16777216);n=l.prototype,n.m=function(){if(P(this))return-k(this).m();let N=0,M=1;for(let D=0;D<this.g.length;D++){const L=this.i(D);N+=(L>=0?L:4294967296+L)*M,M*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(x(this))return"0";if(P(this))return"-"+k(this).toString(N);const M=p(Math.pow(N,6));var D=this;let L="";for(;;){const U=ee(D,M).g;D=K(D,U.j(M));let G=((D.g.length>0?D.g[0]:D.h)>>>0).toString(N);if(D=U,x(D))return G+L;for(;G.length<6;)G="0"+G;L=G+L}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function x(N){if(N.h!=0)return!1;for(let M=0;M<N.g.length;M++)if(N.g[M]!=0)return!1;return!0}function P(N){return N.h==-1}n.l=function(N){return N=K(this,N),P(N)?-1:x(N)?0:1};function k(N){const M=N.g.length,D=[];for(let L=0;L<M;L++)D[L]=~N.g[L];return new l(D,~N.h).add(E)}n.abs=function(){return P(this)?k(this):this},n.add=function(N){const M=Math.max(this.g.length,N.g.length),D=[];let L=0;for(let U=0;U<=M;U++){let G=L+(this.i(U)&65535)+(N.i(U)&65535),V=(G>>>16)+(this.i(U)>>>16)+(N.i(U)>>>16);L=V>>>16,G&=65535,V&=65535,D[U]=V<<16|G}return new l(D,D[D.length-1]&-2147483648?-1:0)};function K(N,M){return N.add(k(M))}n.j=function(N){if(x(this)||x(N))return T;if(P(this))return P(N)?k(this).j(k(N)):k(k(this).j(N));if(P(N))return k(this.j(k(N)));if(this.l(C)<0&&N.l(C)<0)return p(this.m()*N.m());const M=this.g.length+N.g.length,D=[];for(var L=0;L<2*M;L++)D[L]=0;for(L=0;L<this.g.length;L++)for(let U=0;U<N.g.length;U++){const G=this.i(L)>>>16,V=this.i(L)&65535,ke=N.i(U)>>>16,ht=N.i(U)&65535;D[2*L+2*U]+=V*ht,W(D,2*L+2*U),D[2*L+2*U+1]+=G*ht,W(D,2*L+2*U+1),D[2*L+2*U+1]+=V*ke,W(D,2*L+2*U+1),D[2*L+2*U+2]+=G*ke,W(D,2*L+2*U+2)}for(N=0;N<M;N++)D[N]=D[2*N+1]<<16|D[2*N];for(N=M;N<2*M;N++)D[N]=0;return new l(D,0)};function W(N,M){for(;(N[M]&65535)!=N[M];)N[M+1]+=N[M]>>>16,N[M]&=65535,M++}function q(N,M){this.g=N,this.h=M}function ee(N,M){if(x(M))throw Error("division by zero");if(x(N))return new q(T,T);if(P(N))return M=ee(k(N),M),new q(k(M.g),k(M.h));if(P(M))return M=ee(N,k(M)),new q(k(M.g),M.h);if(N.g.length>30){if(P(N)||P(M))throw Error("slowDivide_ only works with positive integers.");for(var D=E,L=M;L.l(N)<=0;)D=ae(D),L=ae(L);var U=z(D,1),G=z(L,1);for(L=z(L,2),D=z(D,2);!x(L);){var V=G.add(L);V.l(N)<=0&&(U=U.add(D),G=V),L=z(L,1),D=z(D,1)}return M=K(N,U.j(M)),new q(U,M)}for(U=T;N.l(M)>=0;){for(D=Math.max(1,Math.floor(N.m()/M.m())),L=Math.ceil(Math.log(D)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),G=p(D),V=G.j(M);P(V)||V.l(N)>0;)D-=L,G=p(D),V=G.j(M);x(G)&&(G=E),U=U.add(G),N=K(N,V)}return new q(U,N)}n.B=function(N){return ee(this,N).h},n.and=function(N){const M=Math.max(this.g.length,N.g.length),D=[];for(let L=0;L<M;L++)D[L]=this.i(L)&N.i(L);return new l(D,this.h&N.h)},n.or=function(N){const M=Math.max(this.g.length,N.g.length),D=[];for(let L=0;L<M;L++)D[L]=this.i(L)|N.i(L);return new l(D,this.h|N.h)},n.xor=function(N){const M=Math.max(this.g.length,N.g.length),D=[];for(let L=0;L<M;L++)D[L]=this.i(L)^N.i(L);return new l(D,this.h^N.h)};function ae(N){const M=N.g.length+1,D=[];for(let L=0;L<M;L++)D[L]=N.i(L)<<1|N.i(L-1)>>>31;return new l(D,N.h)}function z(N,M){const D=M>>5;M%=32;const L=N.g.length-D,U=[];for(let G=0;G<L;G++)U[G]=M>0?N.i(G+D)>>>M|N.i(G+D+1)<<32-M:N.i(G+D);return new l(U,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,jC=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=_,Vr=l}).apply(typeof KA<"u"?KA:typeof self<"u"?self:typeof window<"u"?window:{});var qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XC,fc,WC,th,yy,ZC,eb,tb;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof qf=="object"&&qf];for(var S=0;S<g.length;++S){var w=g[S];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=t(this);function r(g,S){if(S)e:{var w=i;g=g.split(".");for(var R=0;R<g.length-1;R++){var $=g[R];if(!($ in w))break e;w=w[$]}g=g[g.length-1],R=w[g],S=S(R),S!=R&&S!=null&&e(w,g,{configurable:!0,writable:!0,value:S})}}r("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(g){return g||function(S){var w=[],R;for(R in S)Object.prototype.hasOwnProperty.call(S,R)&&w.push([R,S[R]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function f(g,S,w){return g.call.apply(g.bind,arguments)}function p(g,S,w){return p=f,p.apply(null,arguments)}function _(g,S){var w=Array.prototype.slice.call(arguments,1);return function(){var R=w.slice();return R.push.apply(R,arguments),g.apply(this,R)}}function T(g,S){function w(){}w.prototype=S.prototype,g.Z=S.prototype,g.prototype=new w,g.prototype.constructor=g,g.Ob=function(R,$,X){for(var ce=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)ce[Pe-2]=arguments[Pe];return S.prototype[$].apply(R,ce)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function C(g){const S=g.length;if(S>0){const w=Array(S);for(let R=0;R<S;R++)w[R]=g[R];return w}return[]}function x(g,S){for(let R=1;R<arguments.length;R++){const $=arguments[R];var w=typeof $;if(w=w!="object"?w:$?Array.isArray($)?"array":w:"null",w=="array"||w=="object"&&typeof $.length=="number"){w=g.length||0;const X=$.length||0;g.length=w+X;for(let ce=0;ce<X;ce++)g[w+ce]=$[ce]}else g.push($)}}class P{constructor(S,w){this.i=S,this.j=w,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function k(g){l.setTimeout(()=>{throw g},0)}function K(){var g=N;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class W{constructor(){this.h=this.g=null}add(S,w){const R=q.get();R.set(S,w),this.h?this.h.next=R:this.g=R,this.h=R}}var q=new P(()=>new ee,g=>g.reset());class ee{constructor(){this.next=this.g=this.h=null}set(S,w){this.h=S,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,z=!1,N=new W,M=()=>{const g=Promise.resolve(void 0);ae=()=>{g.then(D)}};function D(){for(var g;g=K();){try{g.h.call(g.g)}catch(w){k(w)}var S=q;S.j(g),S.h<100&&(S.h++,g.next=S.g,S.g=g)}z=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const w=()=>{};l.addEventListener("test",w,S),l.removeEventListener("test",w,S)}catch{}return g})();function V(g){return/^[\s\xa0]*$/.test(g)}function ke(g,S){U.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,S)}T(ke,U),ke.prototype.init=function(g,S){const w=this.type=g.type,R=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget,S||(w=="mouseover"?S=g.fromElement:w=="mouseout"&&(S=g.toElement)),this.relatedTarget=S,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ht="closure_listenable_"+(Math.random()*1e6|0),te=0;function fe(g,S,w,R,$){this.listener=g,this.proxy=null,this.src=S,this.type=w,this.capture=!!R,this.ha=$,this.key=++te,this.da=this.fa=!1}function Te(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Fe(g,S,w){for(const R in g)S.call(w,g[R],R,g)}function tt(g,S){for(const w in g)S.call(void 0,g[w],w,g)}function B(g){const S={};for(const w in g)S[w]=g[w];return S}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pe(g,S){let w,R;for(let $=1;$<arguments.length;$++){R=arguments[$];for(w in R)g[w]=R[w];for(let X=0;X<oe.length;X++)w=oe[X],Object.prototype.hasOwnProperty.call(R,w)&&(g[w]=R[w])}}function ge(g){this.src=g,this.g={},this.h=0}ge.prototype.add=function(g,S,w,R,$){const X=g.toString();g=this.g[X],g||(g=this.g[X]=[],this.h++);const ce=Le(g,S,R,$);return ce>-1?(S=g[ce],w||(S.fa=!1)):(S=new fe(S,this.src,X,!!R,$),S.fa=w,g.push(S)),S};function Re(g,S){const w=S.type;if(w in g.g){var R=g.g[w],$=Array.prototype.indexOf.call(R,S,void 0),X;(X=$>=0)&&Array.prototype.splice.call(R,$,1),X&&(Te(S),g.g[w].length==0&&(delete g.g[w],g.h--))}}function Le(g,S,w,R){for(let $=0;$<g.length;++$){const X=g[$];if(!X.da&&X.listener==S&&X.capture==!!w&&X.ha==R)return $}return-1}var $e="closure_lm_"+(Math.random()*1e6|0),Kt={};function _t(g,S,w,R,$){if(Array.isArray(S)){for(let X=0;X<S.length;X++)_t(g,S[X],w,R,$);return null}return w=Wl(w),g&&g[ht]?g.J(S,w,c(R)?!!R.capture:!1,$):Yr(g,S,w,!1,R,$)}function Yr(g,S,w,R,$,X){if(!S)throw Error("Invalid event type");const ce=c($)?!!$.capture:!!$;let Pe=Qr(g);if(Pe||(g[$e]=Pe=new ge(g)),w=Pe.add(S,w,R,ce,X),w.proxy)return w;if(R=ia(),w.proxy=R,R.src=g,R.listener=w,g.addEventListener)G||($=ce),$===void 0&&($=!1),g.addEventListener(S.toString(),R,$);else if(g.attachEvent)g.attachEvent(Mi(S.toString()),R);else if(g.addListener&&g.removeListener)g.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return w}function ia(){function g(w){return S.call(g.src,g.listener,w)}const S=jl;return g}function sa(g,S,w,R,$){if(Array.isArray(S))for(var X=0;X<S.length;X++)sa(g,S[X],w,R,$);else R=c(R)?!!R.capture:!!R,w=Wl(w),g&&g[ht]?(g=g.i,X=String(S).toString(),X in g.g&&(S=g.g[X],w=Le(S,w,R,$),w>-1&&(Te(S[w]),Array.prototype.splice.call(S,w,1),S.length==0&&(delete g.g[X],g.h--)))):g&&(g=Qr(g))&&(S=g.g[S.toString()],g=-1,S&&(g=Le(S,w,R,$)),(w=g>-1?S[g]:null)&&ra(w))}function ra(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[ht])Re(S.i,g);else{var w=g.type,R=g.proxy;S.removeEventListener?S.removeEventListener(w,R,g.capture):S.detachEvent?S.detachEvent(Mi(w),R):S.addListener&&S.removeListener&&S.removeListener(R),(w=Qr(S))?(Re(w,g),w.h==0&&(w.src=null,S[$e]=null)):Te(g)}}}function Mi(g){return g in Kt?Kt[g]:Kt[g]="on"+g}function jl(g,S){if(g.da)g=!0;else{S=new ke(S,this);const w=g.listener,R=g.ha||g.src;g.fa&&ra(g),g=w.call(R,S)}return g}function Qr(g){return g=g[$e],g instanceof ge?g:null}var Xl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wl(g){return typeof g=="function"?g:(g[Xl]||(g[Xl]=function(S){return g.handleEvent(S)}),g[Xl])}function Vt(){L.call(this),this.i=new ge(this),this.M=this,this.G=null}T(Vt,L),Vt.prototype[ht]=!0,Vt.prototype.removeEventListener=function(g,S,w,R){sa(this,g,S,w,R)};function Jt(g,S){var w,R=g.G;if(R)for(w=[];R;R=R.G)w.push(R);if(g=g.M,R=S.type||S,typeof S=="string")S=new U(S,g);else if(S instanceof U)S.target=S.target||g;else{var $=S;S=new U(R,g),pe(S,$)}$=!0;let X,ce;if(w)for(ce=w.length-1;ce>=0;ce--)X=S.g=w[ce],$=zs(X,R,!0,S)&&$;if(X=S.g=g,$=zs(X,R,!0,S)&&$,$=zs(X,R,!1,S)&&$,w)for(ce=0;ce<w.length;ce++)X=S.g=w[ce],$=zs(X,R,!1,S)&&$}Vt.prototype.N=function(){if(Vt.Z.N.call(this),this.i){var g=this.i;for(const S in g.g){const w=g.g[S];for(let R=0;R<w.length;R++)Te(w[R]);delete g.g[S],g.h--}}this.G=null},Vt.prototype.J=function(g,S,w,R){return this.i.add(String(g),S,!1,w,R)},Vt.prototype.K=function(g,S,w,R){return this.i.add(String(g),S,!0,w,R)};function zs(g,S,w,R){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();let $=!0;for(let X=0;X<S.length;++X){const ce=S[X];if(ce&&!ce.da&&ce.capture==w){const Pe=ce.listener,Rt=ce.ha||ce.src;ce.fa&&Re(g.i,ce),$=Pe.call(Rt,R)!==!1&&$}}return $&&!R.defaultPrevented}function Ap(g,S){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:l.setTimeout(g,S||0)}function rd(g){g.g=Ap(()=>{g.g=null,g.i&&(g.i=!1,rd(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class gn extends L{constructor(S,w){super(),this.m=S,this.l=w,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:rd(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jr(g){L.call(this),this.h=g,this.g={}}T(jr,L);var Zl=[];function eu(g){Fe(g.g,function(S,w){this.g.hasOwnProperty(w)&&ra(S)},g),g.g={}}jr.prototype.N=function(){jr.Z.N.call(this),eu(this)},jr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hs=l.JSON.stringify,Ip=l.JSON.parse,od=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function ad(){}function ld(){}var di={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function tn(){U.call(this,"d")}T(tn,U);function $n(){U.call(this,"c")}T($n,U);var bt={},ud=null;function oa(){return ud=ud||new Vt}bt.Ia="serverreachability";function cd(g){U.call(this,bt.Ia,g)}T(cd,U);function Di(g){const S=oa();Jt(S,new cd(S))}bt.STAT_EVENT="statevent";function Xr(g,S){U.call(this,bt.STAT_EVENT,g),this.stat=S}T(Xr,U);function kt(g){const S=oa();Jt(S,new Xr(S,g))}bt.Ja="timingevent";function Pi(g,S){U.call(this,bt.Ja,g),this.size=S}T(Pi,U);function Vi(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},S)}function fi(){this.g=!0}fi.prototype.ua=function(){this.g=!1};function wp(g,S,w,R,$,X){g.info(function(){if(g.g)if(X){var ce="",Pe=X.split("&");for(let We=0;We<Pe.length;We++){var Rt=Pe[We].split("=");if(Rt.length>1){const vt=Rt[0];Rt=Rt[1];const Xn=vt.split("_");ce=Xn.length>=2&&Xn[1]=="type"?ce+(vt+"="+Rt+"&"):ce+(vt+"=redacted&")}}}else ce=null;else ce=X;return"XMLHTTP REQ ("+R+") [attempt "+$+"]: "+S+`
`+w+`
`+ce})}function dd(g,S,w,R,$,X,ce){g.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+$+"]: "+S+`
`+w+`
`+X+" "+ce})}function ki(g,S,w,R){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+Cp(g,w)+(R?" "+R:"")})}function Wr(g,S){g.info(function(){return"TIMEOUT: "+S})}fi.prototype.info=function(){};function Cp(g,S){if(!g.g)return S;if(!S)return null;try{const X=JSON.parse(S);if(X){for(g=0;g<X.length;g++)if(Array.isArray(X[g])){var w=X[g];if(!(w.length<2)){var R=w[1];if(Array.isArray(R)&&!(R.length<1)){var $=R[0];if($!="noop"&&$!="stop"&&$!="close")for(let ce=1;ce<R.length;ce++)R[ce]=""}}}}return Hs(X)}catch{return S}}var Zr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},tu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},nu;function eo(){}T(eo,ad),eo.prototype.g=function(){return new XMLHttpRequest},nu=new eo;function as(g){return encodeURIComponent(String(g))}function fd(g){var S=1;g=g.split(":");const w=[];for(;S>0&&g.length;)w.push(g.shift()),S--;return g.length&&w.push(g.join(":")),w}function hi(g,S,w,R){this.j=g,this.i=S,this.l=w,this.S=R||1,this.V=new jr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pi}function pi(){this.i=null,this.g="",this.h=!1}var Lt={},jt={};function Li(g,S,w){g.M=1,g.A=to(Ot(S)),g.u=w,g.R=!0,aa(g,null)}function aa(g,S){g.F=Date.now(),Ui(g),g.B=Ot(g.A);var w=g.B,R=g.S;Array.isArray(R)||(R=[String(R)]),da(w.i,"t",R),g.C=0,w=g.j.L,g.h=new pi,g.g=bd(g.j,w?S:null,!g.u),g.P>0&&(g.O=new gn(p(g.Y,g,g.g),g.P)),S=g.V,w=g.g,R=g.ba;var $="readystatechange";Array.isArray($)||($&&(Zl[0]=$.toString()),$=Zl);for(let X=0;X<$.length;X++){const ce=_t(w,$[X],R||S.handleEvent,!1,S.h||S);if(!ce)break;S.g[ce.key]=ce}S=g.J?B(g.J):{},g.u?(g.v||(g.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,S)):(g.v="GET",g.g.ea(g.B,g.v,null,S)),Di(),wp(g.i,g.v,g.B,g.l,g.S,g.u)}hi.prototype.ba=function(g){g=g.target;const S=this.O;S&&yi(g)==3?S.j():this.Y(g)},hi.prototype.Y=function(g){try{if(g==this.g)e:{const Pe=yi(this.g),Rt=this.g.ya(),We=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||nn(this.g)))){this.K||Pe!=4||Rt==7||(Rt==8||We<=0?Di(3):Di(2)),Oi(this);var S=this.g.ca();this.X=S;var w=bp(this);if(this.o=S==200,dd(this.i,this.v,this.B,this.l,this.S,Pe,S),this.o){if(this.U&&!this.L){t:{if(this.g){var R,$=this.g;if((R=$.g?$.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(R)){var X=R;break t}}X=null}if(g=X)ki(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fi(this,g);else{this.o=!1,this.m=3,kt(12),Pn(this),Yn(this);break e}}if(this.R){g=!0;let vt;for(;!this.K&&this.C<w.length;)if(vt=pd(this,w),vt==jt){Pe==4&&(this.m=4,kt(14),g=!1),ki(this.i,this.l,null,"[Incomplete Response]");break}else if(vt==Lt){this.m=4,kt(15),ki(this.i,this.l,w,"[Invalid Chunk]"),g=!1;break}else ki(this.i,this.l,vt,null),Fi(this,vt);if(hd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||w.length!=0||this.h.h||(this.m=1,kt(16),g=!1),this.o=this.o&&g,!g)ki(this.i,this.l,w,"[Invalid Chunked Response]"),Pn(this),Yn(this);else if(w.length>0&&!this.W){this.W=!0;var ce=this.j;ce.g==this&&ce.aa&&!ce.P&&(ce.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),yu(ce),ce.P=!0,kt(11))}}else ki(this.i,this.l,w,null),Fi(this,w);Pe==4&&Pn(this),this.o&&!this.K&&(Pe==4?Ad(this.j,this):(this.o=!1,Ui(this)))}else us(this.g),S==400&&w.indexOf("Unknown SID")>0?(this.m=3,kt(12)):(this.m=0,kt(13)),Pn(this),Yn(this)}}}catch{}finally{}};function bp(g){if(!hd(g))return g.g.la();const S=nn(g.g);if(S==="")return"";let w="";const R=S.length,$=yi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Pn(g),Yn(g),"";g.h.i=new l.TextDecoder}for(let X=0;X<R;X++)g.h.h=!0,w+=g.h.i.decode(S[X],{stream:!($&&X==R-1)});return S.length=0,g.h.g+=w,g.C=0,g.h.g}function hd(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function pd(g,S){var w=g.C,R=S.indexOf(`
`,w);return R==-1?jt:(w=Number(S.substring(w,R)),isNaN(w)?Lt:(R+=1,R+w>S.length?jt:(S=S.slice(R,R+w),g.C=R+w,S)))}hi.prototype.cancel=function(){this.K=!0,Pn(this)};function Ui(g){g.T=Date.now()+g.H,la(g,g.H)}function la(g,S){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Vi(p(g.aa,g),S)}function Oi(g){g.D&&(l.clearTimeout(g.D),g.D=null)}hi.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Wr(this.i,this.B),this.M!=2&&(Di(),kt(17)),Pn(this),this.m=2,Yn(this)):la(this,this.T-g)};function Yn(g){g.j.I==0||g.K||Ad(g.j,g)}function Pn(g){Oi(g);var S=g.O;S&&typeof S.dispose=="function"&&S.dispose(),g.O=null,eu(g.V),g.g&&(S=g.g,g.g=null,S.abort(),S.dispose())}function Fi(g,S){try{var w=g.j;if(w.I!=0&&(w.g==g||Gi(w.h,g))){if(!g.L&&Gi(w.h,g)&&w.I==3){try{var R=w.Ba.g.parse(S)}catch{R=null}if(Array.isArray(R)&&R.length==3){var $=R;if($[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<g.F)ga(w),Ws(w);else break e;lo(w),kt(18)}}else w.xa=$[1],0<w.xa-w.K&&$[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Vi(p(w.Va,w),6e3));Bi(w.h)<=1&&w.ta&&(w.ta=void 0)}else $i(w,11)}else if((g.L||w.g==g)&&ga(w),!V(S))for($=w.Ba.g.parse(S),S=0;S<$.length;S++){let We=$[S];const vt=We[0];if(!(vt<=w.K))if(w.K=vt,We=We[1],w.I==2)if(We[0]=="c"){w.M=We[1],w.ba=We[2];const Xn=We[3];Xn!=null&&(w.ka=Xn,w.j.info("VER="+w.ka));const Yi=We[4];Yi!=null&&(w.za=Yi,w.j.info("SVER="+w.za));const _i=We[5];_i!=null&&typeof _i=="number"&&_i>0&&(R=1.5*_i,w.O=R,w.j.info("backChannelRequestTimeoutMs_="+R)),R=w;const vi=g.g;if(vi){const uo=vi.g?vi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uo){var X=R.h;X.g||uo.indexOf("spdy")==-1&&uo.indexOf("quic")==-1&&uo.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(ru(X,X.h),X.h=null))}if(R.G){const ya=vi.g?vi.g.getResponseHeader("X-HTTP-Session-Id"):null;ya&&(R.wa=ya,nt(R.J,R.G,ya))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-g.F,w.j.info("Handshake RTT: "+w.T+"ms")),R=w;var ce=g;if(R.na=Cd(R,R.L?R.ba:null,R.W),ce.L){ou(R.h,ce);var Pe=ce,Rt=R.O;Rt&&(Pe.H=Rt),Pe.D&&(Oi(Pe),Ui(Pe)),R.g=ce}else Ed(R);w.i.length>0&&Ji(w)}else We[0]!="stop"&&We[0]!="close"||$i(w,7);else w.I==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?$i(w,7):mu(w):We[0]!="noop"&&w.l&&w.l.qa(We),w.A=0)}}Di(4)}catch{}}var Ut=class{constructor(g,S){this.g=g,this.map=S}};function iu(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function su(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Bi(g){return g.h?1:g.g?g.g.size:0}function Gi(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function ru(g,S){g.g?g.g.add(S):g.h=S}function ou(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}iu.prototype.cancel=function(){if(this.i=au(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function au(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const w of g.g.values())S=S.concat(w.G);return S}return C(g.i)}var md=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ua(g,S){if(g){g=g.split("&");for(let w=0;w<g.length;w++){const R=g[w].indexOf("=");let $,X=null;R>=0?($=g[w].substring(0,R),X=g[w].substring(R+1)):$=g[w],S($,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function Vn(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;g instanceof Vn?(this.l=g.l,Xt(this,g.j),this.o=g.o,this.g=g.g,Ks(this,g.u),this.h=g.h,lu(this,vd(g.i)),this.m=g.m):g&&(S=String(g).match(md))?(this.l=!1,Xt(this,S[1]||"",!0),this.o=qi(S[2]||""),this.g=qi(S[3]||"",!0),Ks(this,S[4]),this.h=qi(S[5]||"",!0),lu(this,S[6]||"",!0),this.m=qi(S[7]||"")):(this.l=!1,this.i=new $s(null,this.l))}Vn.prototype.toString=function(){const g=[];var S=this.j;S&&g.push(no(S,ca,!0),":");var w=this.g;return(w||S=="file")&&(g.push("//"),(S=this.o)&&g.push(no(S,ca,!0),"@"),g.push(as(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&g.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&g.push("/"),g.push(no(w,w.charAt(0)=="/"?uu:gd,!0))),(w=this.i.toString())&&g.push("?",w),(w=this.m)&&g.push("#",no(w,yd)),g.join("")},Vn.prototype.resolve=function(g){const S=Ot(this);let w=!!g.j;w?Xt(S,g.j):w=!!g.o,w?S.o=g.o:w=!!g.g,w?S.g=g.g:w=g.u!=null;var R=g.h;if(w)Ks(S,g.u);else if(w=!!g.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var $=S.h.lastIndexOf("/");$!=-1&&(R=S.h.slice(0,$+1)+R)}if($=R,$==".."||$==".")R="";else if($.indexOf("./")!=-1||$.indexOf("/.")!=-1){R=$.lastIndexOf("/",0)==0,$=$.split("/");const X=[];for(let ce=0;ce<$.length;){const Pe=$[ce++];Pe=="."?R&&ce==$.length&&X.push(""):Pe==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),R&&ce==$.length&&X.push("")):(X.push(Pe),R=!0)}R=X.join("/")}else R=$}return w?S.h=R:w=g.i.toString()!=="",w?lu(S,vd(g.i)):w=!!g.m,w&&(S.m=g.m),S};function Ot(g){return new Vn(g)}function Xt(g,S,w){g.j=w?qi(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Ks(g,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);g.u=S}else g.u=null}function lu(g,S,w){S instanceof $s?(g.i=S,fa(g.i,g.l)):(w||(S=no(S,Js)),g.i=new $s(S,g.l))}function nt(g,S,w){g.i.set(S,w)}function to(g){return nt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function qi(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function no(g,S,w){return typeof g=="string"?(g=encodeURI(g).replace(S,An),w&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function An(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var ca=/[#\/\?@]/g,gd=/[#\?:]/g,uu=/[#\?]/g,Js=/[#\?@]/g,yd=/#/g;function $s(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function In(g){g.g||(g.g=new Map,g.h=0,g.i&&ua(g.i,function(S,w){g.add(decodeURIComponent(S.replace(/\+/g," ")),w)}))}n=$s.prototype,n.add=function(g,S){In(this),this.i=null,g=Ys(this,g);let w=this.g.get(g);return w||this.g.set(g,w=[]),w.push(S),this.h+=1,this};function _d(g,S){In(g),S=Ys(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function cu(g,S){return In(g),S=Ys(g,S),g.g.has(S)}n.forEach=function(g,S){In(this),this.g.forEach(function(w,R){w.forEach(function($){g.call(S,$,R,this)},this)},this)};function du(g,S){In(g);let w=[];if(typeof S=="string")cu(g,S)&&(w=w.concat(g.g.get(Ys(g,S))));else for(g=Array.from(g.g.values()),S=0;S<g.length;S++)w=w.concat(g[S]);return w}n.set=function(g,S){return In(this),this.i=null,g=Ys(this,g),cu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},n.get=function(g,S){return g?(g=du(this,g),g.length>0?String(g[0]):S):S};function da(g,S,w){_d(g,S),w.length>0&&(g.i=null,g.g.set(Ys(g,S),C(w)),g.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(let R=0;R<S.length;R++){var w=S[R];const $=as(w);w=du(this,w);for(let X=0;X<w.length;X++){let ce=$;w[X]!==""&&(ce+="="+as(w[X])),g.push(ce)}}return this.i=g.join("&")};function vd(g){const S=new $s;return S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),S}function Ys(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function fa(g,S){S&&!g.j&&(In(g),g.i=null,g.g.forEach(function(w,R){const $=R.toLowerCase();R!=$&&(_d(this,R),da(this,$,w))},g)),g.j=S}function mi(g,S){const w=new fi;if(l.Image){const R=new Image;R.onload=_(Qn,w,"TestLoadImage: loaded",!0,S,R),R.onerror=_(Qn,w,"TestLoadImage: error",!1,S,R),R.onabort=_(Qn,w,"TestLoadImage: abort",!1,S,R),R.ontimeout=_(Qn,w,"TestLoadImage: timeout",!1,S,R),l.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=g}else S(!1)}function fu(g,S){const w=new fi,R=new AbortController,$=setTimeout(()=>{R.abort(),Qn(w,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:R.signal}).then(X=>{clearTimeout($),X.ok?Qn(w,"TestPingServer: ok",!0,S):Qn(w,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout($),Qn(w,"TestPingServer: error",!1,S)})}function Qn(g,S,w,R,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),R(w)}catch{}}function Qs(){this.g=new od}function zi(g){this.i=g.Sb||null,this.h=g.ab||!1}T(zi,ad),zi.prototype.g=function(){return new io(this.i,this.h)};function io(g,S){Vt.call(this),this.H=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}T(io,Vt),n=io.prototype,n.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=S,this.readyState=1,gi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(S.body=g),(this.H||l).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,js(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,gi(this)),this.g&&(this.readyState=3,gi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ha(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function ha(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?js(this):gi(this),this.readyState==3&&ha(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,js(this))},n.Na=function(g){this.g&&(this.response=g,js(this))},n.ga=function(){this.g&&js(this)};function js(g){g.readyState=4,g.l=null,g.j=null,g.B=null,gi(g)}n.setRequestHeader=function(g,S){this.A.append(g,S)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var w=S.next();!w.done;)w=w.value,g.push(w[0]+": "+w[1]),w=S.next();return g.join(`\r
`)};function gi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(io.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function jn(g){let S="";return Fe(g,function(w,R){S+=R,S+=":",S+=w,S+=`\r
`}),S}function so(g,S,w){e:{for(R in w){var R=!1;break e}R=!0}R||(w=jn(w),typeof g=="string"?w!=null&&as(w):nt(g,S,w))}function lt(g){Vt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}T(lt,Vt);var Hi=/^https?$/i,hu=["POST","PUT"];n=lt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,S,w,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():nu.g(),this.g.onreadystatechange=E(p(this.Ca,this));try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(X){ro(this,X);return}if(g=w||"",w=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var $ in R)w.set($,R[$]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const X of R.keys())w.set(X,R.get(X));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(w.keys()).find(X=>X.toLowerCase()=="content-type"),$=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(hu,S,void 0)>=0)||R||$||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ce]of w)this.g.setRequestHeader(X,ce);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(X){ro(this,X)}};function ro(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.o=5,pu(g),ls(g)}function pu(g){g.A||(g.A=!0,Jt(g,"complete"),Jt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Jt(this,"complete"),Jt(this,"abort"),ls(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ls(this,!0)),lt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?oo(this):this.Xa())},n.Xa=function(){oo(this)};function oo(g){if(g.h&&typeof a<"u"){if(g.v&&yi(g)==4)setTimeout(g.Ca.bind(g),0);else if(Jt(g,"readystatechange"),yi(g)==4){g.h=!1;try{const X=g.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var w;if(!(w=S)){var R;if(R=X===0){let ce=String(g.D).match(md)[1]||null;!ce&&l.self&&l.self.location&&(ce=l.self.location.protocol.slice(0,-1)),R=!Hi.test(ce?ce.toLowerCase():"")}w=R}if(w)Jt(g,"complete"),Jt(g,"success");else{g.o=6;try{var $=yi(g)>2?g.g.statusText:""}catch{$=""}g.l=$+" ["+g.ca()+"]",pu(g)}}finally{ls(g)}}}}function ls(g,S){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const w=g.g;g.g=null,S||Jt(g,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function yi(g){return g.g?g.g.readyState:0}n.ca=function(){try{return yi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),Ip(S)}};function nn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function us(g){const S={};g=(g.g&&yi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<g.length;R++){if(V(g[R]))continue;var w=fd(g[R]);const $=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const X=S[$]||[];S[$]=X,X.push(w)}tt(S,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ki(g,S,w){return w&&w.internalChannelParams&&w.internalChannelParams[g]||S}function Xs(g){this.za=0,this.i=[],this.j=new fi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ki("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ki("baseRetryDelayMs",5e3,g),this.Za=Ki("retryDelaySeedMs",1e4,g),this.Ta=Ki("forwardChannelMaxRetries",2,g),this.va=Ki("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new iu(g&&g.concurrentRequestLimit),this.Ba=new Qs,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Xs.prototype,n.ka=8,n.I=1,n.connect=function(g,S,w,R){kt(0),this.W=g,this.H=S||{},w&&R!==void 0&&(this.H.OSID=w,this.H.OAID=R),this.F=this.X,this.J=Cd(this,null,this.W),Ji(this)};function mu(g){if(pa(g),g.I==3){var S=g.V++,w=Ot(g.J);if(nt(w,"SID",g.M),nt(w,"RID",S),nt(w,"TYPE","terminate"),ao(g,w),S=new hi(g,g.j,S),S.M=2,S.A=to(Ot(w)),w=!1,l.navigator&&l.navigator.sendBeacon)try{w=l.navigator.sendBeacon(S.A.toString(),"")}catch{}!w&&l.Image&&(new Image().src=S.A,w=!0),w||(S.g=bd(S.j,null),S.g.ea(S.A)),S.F=Date.now(),Ui(S)}wd(g)}function Ws(g){g.g&&(yu(g),g.g.cancel(),g.g=null)}function pa(g){Ws(g),g.v&&(l.clearTimeout(g.v),g.v=null),ga(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function Ji(g){if(!su(g.h)&&!g.m){g.m=!0;var S=g.Ea;ae||M(),z||(ae(),z=!0),N.add(S,g),g.D=0}}function ma(g,S){return Bi(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=S.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Vi(p(g.Ea,g,S),Id(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const $=new hi(this,this.j,g);let X=this.o;if(this.U&&(X?(X=B(X),pe(X,this.U)):X=this.U),this.u!==null||this.R||($.J=X,X=null),this.S)e:{for(var S=0,w=0;w<this.i.length;w++){t:{var R=this.i[w];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(S+=R,S>4096){S=w;break e}if(S===4096||w===this.i.length-1){S=w+1;break e}}S=1e3}else S=1e3;S=Td(this,$,S),w=Ot(this.J),nt(w,"RID",g),nt(w,"CVER",22),this.G&&nt(w,"X-HTTP-Session-Id",this.G),ao(this,w),X&&(this.R?S="headers="+as(jn(X))+"&"+S:this.u&&so(w,this.u,X)),ru(this.h,$),this.Ra&&nt(w,"TYPE","init"),this.S?(nt(w,"$req",S),nt(w,"SID","null"),$.U=!0,Li($,w,null)):Li($,w,S),this.I=2}}else this.I==3&&(g?gu(this,g):this.i.length==0||su(this.h)||gu(this))};function gu(g,S){var w;S?w=S.l:w=g.V++;const R=Ot(g.J);nt(R,"SID",g.M),nt(R,"RID",w),nt(R,"AID",g.K),ao(g,R),g.u&&g.o&&so(R,g.u,g.o),w=new hi(g,g.j,w,g.D+1),g.u===null&&(w.J=g.o),S&&(g.i=S.G.concat(g.i)),S=Td(g,w,1e3),w.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),ru(g.h,w),Li(w,R,S)}function ao(g,S){g.H&&Fe(g.H,function(w,R){nt(S,R,w)}),g.l&&Fe({},function(w,R){nt(S,R,w)})}function Td(g,S,w){w=Math.min(g.i.length,w);const R=g.l?p(g.l.Ka,g.l,g):null;e:{var $=g.i;let Pe=-1;for(;;){const Rt=["count="+w];Pe==-1?w>0?(Pe=$[0].g,Rt.push("ofs="+Pe)):Pe=0:Rt.push("ofs="+Pe);let We=!0;for(let vt=0;vt<w;vt++){var X=$[vt].g;const Xn=$[vt].map;if(X-=Pe,X<0)Pe=Math.max(0,$[vt].g-100),We=!1;else try{X="req"+X+"_"||"";try{var ce=Xn instanceof Map?Xn:Object.entries(Xn);for(const[Yi,_i]of ce){let vi=_i;c(_i)&&(vi=Hs(_i)),Rt.push(X+Yi+"="+encodeURIComponent(vi))}}catch(Yi){throw Rt.push(X+"type="+encodeURIComponent("_badmap")),Yi}}catch{R&&R(Xn)}}if(We){ce=Rt.join("&");break e}}ce=void 0}return g=g.i.splice(0,w),S.G=g,ce}function Ed(g){if(!g.g&&!g.v){g.Y=1;var S=g.Da;ae||M(),z||(ae(),z=!0),N.add(S,g),g.A=0}}function lo(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Vi(p(g.Da,g),Id(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Sd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Vi(p(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,kt(10),Ws(this),Sd(this))};function yu(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function Sd(g){g.g=new hi(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var S=Ot(g.na);nt(S,"RID","rpc"),nt(S,"SID",g.M),nt(S,"AID",g.K),nt(S,"CI",g.F?"0":"1"),!g.F&&g.ia&&nt(S,"TO",g.ia),nt(S,"TYPE","xmlhttp"),ao(g,S),g.u&&g.o&&so(S,g.u,g.o),g.O&&(g.g.H=g.O);var w=g.g;g=g.ba,w.M=1,w.A=to(Ot(S)),w.u=null,w.R=!0,aa(w,g)}n.Va=function(){this.C!=null&&(this.C=null,Ws(this),lo(this),kt(19))};function ga(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function Ad(g,S){var w=null;if(g.g==S){ga(g),yu(g),g.g=null;var R=2}else if(Gi(g.h,S))w=S.G,ou(g.h,S),R=1;else return;if(g.I!=0){if(S.o)if(R==1){w=S.u?S.u.length:0,S=Date.now()-S.F;var $=g.D;R=oa(),Jt(R,new Pi(R,w)),Ji(g)}else Ed(g);else if($=S.m,$==3||$==0&&S.X>0||!(R==1&&ma(g,S)||R==2&&lo(g)))switch(w&&w.length>0&&(S=g.h,S.i=S.i.concat(w)),$){case 1:$i(g,5);break;case 4:$i(g,10);break;case 3:$i(g,6);break;default:$i(g,2)}}}function Id(g,S){let w=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(w*=2),w*S}function $i(g,S){if(g.j.info("Error code "+S),S==2){var w=p(g.bb,g),R=g.Ua;const $=!R;R=new Vn(R||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Xt(R,"https"),to(R),$?mi(R.toString(),w):fu(R.toString(),w)}else kt(2);g.I=0,g.l&&g.l.pa(S),wd(g),pa(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),kt(2)):(this.j.info("Failed to ping google.com"),kt(1))};function wd(g){if(g.I=0,g.ja=[],g.l){const S=au(g.h);(S.length!=0||g.i.length!=0)&&(x(g.ja,S),x(g.ja,g.i),g.h.i.length=0,C(g.i),g.i.length=0),g.l.oa()}}function Cd(g,S,w){var R=w instanceof Vn?Ot(w):new Vn(w);if(R.g!="")S&&(R.g=S+"."+R.g),Ks(R,R.u);else{var $=l.location;R=$.protocol,S=S?S+"."+$.hostname:$.hostname,$=+$.port;const X=new Vn(null);R&&Xt(X,R),S&&(X.g=S),$&&Ks(X,$),w&&(X.h=w),R=X}return w=g.G,S=g.wa,w&&S&&nt(R,w,S),nt(R,"VER",g.ka),ao(g,R),R}function bd(g,S,w){if(S&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Aa&&!g.ma?new lt(new zi({ab:w})):new lt(g.ma),S.Fa(g.L),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rd(){}n=Rd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Zs(){}Zs.prototype.g=function(g,S){return new yn(g,S)};function yn(g,S){Vt.call(this),this.g=new Xs(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(g?g["X-WebChannel-Client-Profile"]=S.sa:g={"X-WebChannel-Client-Profile":S.sa}),this.g.U=g,(g=S&&S.Qb)&&!V(g)&&(this.g.u=g),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!V(S)&&(this.g.G=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new cs(this)}T(yn,Vt),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){mu(this.g)},yn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var w={};w.__data__=g,g=w}else this.v&&(w={},w.__data__=Hs(g),g=w);S.i.push(new Ut(S.Ya++,g)),S.I==3&&Ji(S)},yn.prototype.N=function(){this.g.l=null,delete this.j,mu(this.g),delete this.g,yn.Z.N.call(this)};function xd(g){tn.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const w in S){g=w;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}T(xd,tn);function Nd(){$n.call(this),this.status=1}T(Nd,$n);function cs(g){this.g=g}T(cs,Rd),cs.prototype.ra=function(){Jt(this.g,"a")},cs.prototype.qa=function(g){Jt(this.g,new xd(g))},cs.prototype.pa=function(g){Jt(this.g,new Nd)},cs.prototype.oa=function(){Jt(this.g,"b")},Zs.prototype.createWebChannel=Zs.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,tb=function(){return new Zs},eb=function(){return oa()},ZC=bt,yy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Zr.NO_ERROR=0,Zr.TIMEOUT=8,Zr.HTTP_ERROR=6,th=Zr,tu.COMPLETE="complete",WC=tu,ld.EventType=di,di.OPEN="a",di.CLOSE="b",di.ERROR="c",di.MESSAGE="d",Vt.prototype.listen=Vt.prototype.J,fc=ld,lt.prototype.listenOnce=lt.prototype.K,lt.prototype.getLastError=lt.prototype.Ha,lt.prototype.getLastErrorCode=lt.prototype.ya,lt.prototype.getStatus=lt.prototype.ca,lt.prototype.getResponseJson=lt.prototype.La,lt.prototype.getResponseText=lt.prototype.la,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Fa,XC=lt}).apply(typeof qf<"u"?qf:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl="12.9.0";function gO(n){zl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new a_("@firebase/firestore");function el(){return Jo.logLevel}function le(n,...e){if(Jo.logLevel<=He.DEBUG){const t=e.map(c_);Jo.debug(`Firestore (${zl}): ${n}`,...t)}}function Mt(n,...e){if(Jo.logLevel<=He.ERROR){const t=e.map(c_);Jo.error(`Firestore (${zl}): ${n}`,...t)}}function yl(n,...e){if(Jo.logLevel<=He.WARN){const t=e.map(c_);Jo.warn(`Firestore (${zl}): ${n}`,...t)}}function c_(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,nb(n,i,t)}function nb(n,e,t){let i=`FIRESTORE (${zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Mt(i),new Error(i)}function Ae(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||nb(e,r,i)}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Gs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _O{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class vO{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ae(this.o===void 0,42304);let i=this.i;const r=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let a=new Ds;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ds,e.enqueueRetryable((()=>r(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await r(this.currentUser)}))},c=f=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>c(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?c(f):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ds)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ae(typeof i.accessToken=="string",31837,{l:i}),new yO(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ae(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class TO{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class EO{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new TO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class JA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ii(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ae(this.o===void 0,3512);const i=a=>{a.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,le("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const r=a=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>r(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?r(a):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new JA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ae(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new JA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=AO(40);for(let a=0;a<r.length;++a)i.length<20&&r[a]<t&&(i+=e.charAt(r[a]%62))}return i}}function xe(n,e){return n<e?-1:n>e?1:0}function _y(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),a=e.charAt(i);if(r!==a)return Lg(r)===Lg(a)?xe(r,a):Lg(r)?1:-1}return xe(n.length,e.length)}const IO=55296,wO=57343;function Lg(n){const e=n.charCodeAt(0);return e>=IO&&e<=wO}function _l(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function ib(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A="__name__";class Zi{constructor(e,t,i){t===void 0?t=0:t>e.length&&_e(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&_e(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Zi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Zi?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const a=Zi.compareSegments(e.get(r),t.get(r));if(a!==0)return a}return xe(e.length,t.length)}static compareSegments(e,t){const i=Zi.isNumericId(e),r=Zi.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Zi.extractNumericId(e).compare(Zi.extractNumericId(t)):_y(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vr.fromString(e.substring(4,e.length-2))}}class et extends Zi{construct(e,t,i){return new et(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ue(ie.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new et(t)}static emptyPath(){return new et([])}}const CO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends Zi{construct(e,t,i){return new St(e,t,i)}static isValidIdentifier(e){return CO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$A}static keyField(){return new St([$A])}static fromServerFormat(e){const t=[];let i="",r=0;const a=()=>{if(i.length===0)throw new ue(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new ue(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[r+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ue(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,r+=2}else c==="`"?(l=!l,r++):c!=="."||l?(i+=c,r++):(a(),r++)}if(a(),l)throw new ue(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(t)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(et.fromString(e))}static fromName(e){return new he(et.fromString(e).popFirst(5))}static empty(){return new he(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return et.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new et(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(n,e,t){if(!t)throw new ue(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function bO(n,e,t,i){if(e===!0&&i===!0)throw new ue(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function YA(n){if(!he.isDocumentKey(n))throw new ue(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function QA(n){if(he.isDocumentKey(n))throw new ue(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rb(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ep(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":_e(12329,{type:typeof n})}function kr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ep(n);throw new ue(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yc(n,e){if(!rb(n))throw new ue(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(r&&typeof l!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new ue(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=-62135596800,XA=1e6;class rt{static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*XA);return new rt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jA)throw new ue(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/XA}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:rt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yc(e,rt._jsonSchema))return new rt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-jA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}rt._jsonSchemaVersion="firestore/timestamp/1.0",rt._jsonSchema={type:Ht("string",rt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new rt(0,0))}static max(){return new we(new rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=-1;class Ah{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function vy(n){return n.fields.find((e=>e.kind===2))}function Mo(n){return n.fields.filter((e=>e.kind!==2))}Ah.UNKNOWN_ID=-1;class nh{constructor(e,t){this.fieldPath=e,this.kind=t}}class Dc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Dc(0,Jn.min())}}function ob(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=we.fromTimestamp(i===1e9?new rt(t+1,0):new rt(t,i));return new Jn(r,he.empty(),e)}function ab(n){return new Jn(n.readTime,n.key,vl)}class Jn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Jn(we.min(),he.empty(),vl)}static max(){return new Jn(we.max(),he.empty(),vl)}}function f_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ub{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zr(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==lb)throw n;le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new J(((i,r)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,r)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof J?t:J.resolve(t)}catch(t){return J.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):J.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):J.reject(t)}static resolve(e){return new J(((t,i)=>{t(e)}))}static reject(e){return new J(((t,i)=>{i(e)}))}static waitFor(e){return new J(((t,i)=>{let r=0,a=0,l=!1;e.forEach((c=>{++r,c.next((()=>{++a,l&&a===r&&t()}),(f=>i(f)))})),l=!0,a===r&&t()}))}static or(e){let t=J.resolve(!1);for(const i of e)t=t.next((r=>r?J.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,a)=>{i.push(t.call(this,r,a))})),this.waitFor(i)}static mapArray(e,t){return new J(((i,r)=>{const a=e.length,l=new Array(a);let c=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((_=>{l[p]=_,++c,c===a&&i(l)}),(_=>r(_)))}}))}static doWhile(e,t){return new J(((i,r)=>{const a=()=>{e()===!0?t().next((()=>{a()}),r):i()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="SimpleDb";class tp{static open(e,t,i,r){try{return new tp(t,e.transaction(r,i))}catch(a){throw new _c(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ds,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new _c(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=h_(i.target.error);this.S.reject(new _c(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(le(zn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new xO(t)}}class Lr{static delete(e){return le(zn,"Removing database:",e),Po(LC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!zC())return!1;if(Lr.F())return!0;const e=Yt(),t=Lr.M(e),i=0<t&&t<10,r=cb(e),a=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Lr.M(Yt())===12.2&&Mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(le(zn,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=a=>{const l=a.target.result;t(l)},r.onblocked=()=>{i(new _c(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=a=>{const l=a.target.error;l.name==="VersionError"?i(new ue(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new ue(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new _c(e,l))},r.onupgradeneeded=a=>{le(zn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,r.transaction,a.oldVersion,this.version).next((()=>{le(zn,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const c=tp.open(this.db,e,a?"readonly":"readwrite",i),f=r(c).next((p=>(c.C(),p))).catch((p=>(c.abort(p),J.reject(p)))).toPromise();return f.catch((()=>{})),await c.D,f}catch(c){const f=c,p=f.name!=="FirebaseError"&&l<3;if(le(zn,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cb(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class RO{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Po(this.U.delete())}}class _c extends ue{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Hr(n){return n.name==="IndexedDbTransactionError"}class xO{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(le(zn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(le(zn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Po(i)}add(e){return le(zn,"ADD",this.store.name,e,e),Po(this.store.add(e))}get(e){return Po(this.store.get(e)).next((t=>(t===void 0&&(t=null),le(zn,"GET",this.store.name,e,t),t)))}delete(e){return le(zn,"DELETE",this.store.name,e),Po(this.store.delete(e))}count(){return le(zn,"COUNT",this.store.name),Po(this.store.count())}H(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const a=r.getAll(i.range);return new J(((l,c)=>{a.onerror=f=>{c(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(i),l=[];return this.J(a,((c,f)=>{l.push(f)})).next((()=>l))}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new J(((r,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{r(l.target.result)}}))}X(e,t){le(zn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.Y=!1;const r=this.cursor(i);return this.J(r,((a,l,c)=>c.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.J(r,t)}te(e){const t=this.cursor({});return new J(((i,r)=>{t.onerror=a=>{const l=h_(a.target.error);r(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((c=>{c?l.continue():i()})):i()}}))}J(e,t){const i=[];return new J(((r,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const c=l.target.result;if(!c)return void r();const f=new RO(c),p=t(c.primaryKey,c.value,f);if(p instanceof J){const _=p.catch((T=>(f.done(),J.reject(T))));i.push(_)}f.isDone?r():f.G===null?c.continue():c.continue(f.G)}})).next((()=>J.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Po(n){return new J(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=h_(i.target.error);t(r)}}))}let WA=!1;function h_(n){const e=Lr.M(Yt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return WA||(WA=!0,setTimeout((()=>{throw i}),0)),i}}return n}const vc="IndexBackfiller";class NO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){le(vc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();le(vc,`Documents written: ${t}`)}catch(t){Hr(t)?le(vc,"Ignoring IndexedDB error during index backfill: ",t):await zr(t)}await this.re(6e4)}))}}class MO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,a=!0;return J.doWhile((()=>a===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return le(vc,`Processing collection: ${l}`),this.oe(e,l,r).next((c=>{r-=c,i.add(l)}));a=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(r,a))).next((c=>(le(vc,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,a)=>{const l=ab(a);f_(l,i)>0&&(i=l)})),new Jn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Mn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo=-1;function np(n){return n==null}function Pc(n){return n===0&&1/n==-1/0}function db(n){return typeof n=="number"&&Number.isInteger(n)&&!Pc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="";function mn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ZA(e)),e=DO(n.get(t),e);return ZA(e)}function DO(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const a=n.charAt(r);switch(a){case"\0":t+="";break;case Ih:t+="";break;default:t+=a}}return t}function ZA(n){return n+Ih+""}function ts(n){const e=n.length;if(Ae(e>=2,64408,{path:n}),e===2)return Ae(n.charAt(0)===Ih&&n.charAt(1)==="",56145,{path:n}),et.emptyPath();const t=e-2,i=[];let r="";for(let a=0;a<e;){const l=n.indexOf(Ih,a);switch((l<0||l>t)&&_e(50515,{path:n}),n.charAt(l+1)){case"":const c=n.substring(a,l);let f;r.length===0?f=c:(r+=c,f=r,r=""),i.push(f);break;case"":r+=n.substring(a,l),r+="\0";break;case"":r+=n.substring(a,l+1);break;default:_e(61167,{path:n})}a=l+2}return new et(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do="remoteDocuments",Qc="owner",$a="owner",Vc="mutationQueues",PO="userId",Ai="mutations",eI="batchId",Uo="userMutationsIndex",tI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(n,e){return[n,mn(e)]}function fb(n,e,t){return[n,mn(e),t]}const VO={},Tl="documentMutations",wh="remoteDocumentsV14",kO=["prefixPath","collectionGroup","readTime","documentId"],sh="documentKeyIndex",LO=["prefixPath","collectionGroup","documentId"],hb="collectionGroupIndex",UO=["collectionGroup","readTime","prefixPath","documentId"],kc="remoteDocumentGlobal",Ty="remoteDocumentGlobalKey",El="targets",pb="queryTargetsIndex",OO=["canonicalId","targetId"],Sl="targetDocuments",FO=["targetId","path"],p_="documentTargetsIndex",BO=["path","targetId"],Ch="targetGlobalKey",Bo="targetGlobal",Lc="collectionParents",GO=["collectionId","parent"],Al="clientMetadata",qO="clientId",ip="bundles",zO="bundleId",sp="namedQueries",HO="name",m_="indexConfiguration",KO="indexId",Ey="collectionGroupIndex",JO="collectionGroup",Tc="indexState",$O=["indexId","uid"],mb="sequenceNumberIndex",YO=["uid","sequenceNumber"],Ec="indexEntries",QO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gb="documentKeyIndex",jO=["indexId","uid","orderedDocumentKey"],rp="documentOverlays",XO=["userId","collectionPath","documentId"],Sy="collectionPathOverlayIndex",WO=["userId","collectionPath","largestBatchId"],yb="collectionGroupOverlayIndex",ZO=["userId","collectionGroup","largestBatchId"],g_="globals",e5="name",_b=[Vc,Ai,Tl,Do,El,Qc,Bo,Sl,Al,kc,Lc,ip,sp],t5=[..._b,rp],vb=[Vc,Ai,Tl,wh,El,Qc,Bo,Sl,Al,kc,Lc,ip,sp,rp],Tb=vb,y_=[...Tb,m_,Tc,Ec],n5=y_,Eb=[...y_,g_],i5=Eb;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay extends ub{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qt(n,e){const t=Ee(n);return Lr.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ta(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Sb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||un.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zf(this.root,e,this.comparator,!1)}getReverseIterator(){return new zf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zf(this.root,e,this.comparator,!0)}}class zf{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,t,i,r,a){this.key=e,this.value=t,this.color=i??un.RED,this.left=r??un.EMPTY,this.right=a??un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,a){return new un(e??this.key,t??this.value,i??this.color,r??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const a=i(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,i),null):a===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return un.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _e(27949);return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1;un.EMPTY=new class{constructor(){this.size=0}get key(){throw _e(57766)}get value(){throw _e(16141)}get color(){throw _e(16727)}get left(){throw _e(29726)}get right(){throw _e(36894)}copy(e,t,i,r,a){return this}insert(e,t,i){return new un(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new iI(this.data.getIterator())}getIteratorFrom(e){return new iI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,a=i.getNext().key;if(this.comparator(r,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new at(this.comparator);return t.data=e,t}}class iI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ya(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new li([])}unionWith(e){let t=new at(St.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new li(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _l(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Ab("Invalid base64 string: "+a):a}})(e);return new Pt(t)}static fromUint8Array(e){const t=(function(r){let a="";for(let l=0;l<r.length;++l)a+=String.fromCharCode(r[l]);return a})(e);return new Pt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pt.EMPTY_BYTE_STRING=new Pt("");const s5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ks(n){if(Ae(!!n,39018),typeof n=="string"){let e=0;const t=s5.exec(n);if(Ae(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Et(n.seconds),nanos:Et(n.nanos)}}function Et(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ls(n){return typeof n=="string"?Pt.fromBase64String(n):Pt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib="server_timestamp",wb="__type__",Cb="__previous_value__",bb="__local_write_time__";function __(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[wb])==null?void 0:i.stringValue)===Ib}function op(n){const e=n.mapValue.fields[Cb];return __(e)?op(e):e}function Uc(n){const e=ks(n.mapValue.fields[bb].timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e,t,i,r,a,l,c,f,p,_,T){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_,this.apiKey=T}}const Iy="(default)";class $o{constructor(e,t){this.projectId=e,this.database=t||Iy}static empty(){return new $o("","")}get isDefaultDatabase(){return this.database===Iy}isEqual(e){return e instanceof $o&&e.projectId===this.projectId&&e.database===this.database}}function o5(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ue(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $o(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="__type__",Rb="__max__",Nr={mapValue:{fields:{__type__:{stringValue:Rb}}}},T_="__vector__",Il="value",rh={nullValue:"NULL_VALUE"};function Or(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?__(n)?4:xb(n)?9007199254740991:ap(n)?10:11:_e(28295,{value:n})}function rs(n,e){if(n===e)return!0;const t=Or(n);if(t!==Or(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Uc(n).isEqual(Uc(e));case 3:return(function(r,a){if(typeof r.timestampValue=="string"&&typeof a.timestampValue=="string"&&r.timestampValue.length===a.timestampValue.length)return r.timestampValue===a.timestampValue;const l=ks(r.timestampValue),c=ks(a.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,a){return Ls(r.bytesValue).isEqual(Ls(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,a){return Et(r.geoPointValue.latitude)===Et(a.geoPointValue.latitude)&&Et(r.geoPointValue.longitude)===Et(a.geoPointValue.longitude)})(n,e);case 2:return(function(r,a){if("integerValue"in r&&"integerValue"in a)return Et(r.integerValue)===Et(a.integerValue);if("doubleValue"in r&&"doubleValue"in a){const l=Et(r.doubleValue),c=Et(a.doubleValue);return l===c?Pc(l)===Pc(c):isNaN(l)&&isNaN(c)}return!1})(n,e);case 9:return _l(n.arrayValue.values||[],e.arrayValue.values||[],rs);case 10:case 11:return(function(r,a){const l=r.mapValue.fields||{},c=a.mapValue.fields||{};if(nI(l)!==nI(c))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(c[f]===void 0||!rs(l[f],c[f])))return!1;return!0})(n,e);default:return _e(52216,{left:n})}}function Oc(n,e){return(n.values||[]).find((t=>rs(t,e)))!==void 0}function Fr(n,e){if(n===e)return 0;const t=Or(n),i=Or(e);if(t!==i)return xe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const c=Et(a.integerValue||a.doubleValue),f=Et(l.integerValue||l.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1})(n,e);case 3:return sI(n.timestampValue,e.timestampValue);case 4:return sI(Uc(n),Uc(e));case 5:return _y(n.stringValue,e.stringValue);case 6:return(function(a,l){const c=Ls(a),f=Ls(l);return c.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const c=a.split("/"),f=l.split("/");for(let p=0;p<c.length&&p<f.length;p++){const _=xe(c[p],f[p]);if(_!==0)return _}return xe(c.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const c=xe(Et(a.latitude),Et(l.latitude));return c!==0?c:xe(Et(a.longitude),Et(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return rI(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var E,C,x,P;const c=a.fields||{},f=l.fields||{},p=(E=c[Il])==null?void 0:E.arrayValue,_=(C=f[Il])==null?void 0:C.arrayValue,T=xe(((x=p==null?void 0:p.values)==null?void 0:x.length)||0,((P=_==null?void 0:_.values)==null?void 0:P.length)||0);return T!==0?T:rI(p,_)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Nr.mapValue&&l===Nr.mapValue)return 0;if(a===Nr.mapValue)return 1;if(l===Nr.mapValue)return-1;const c=a.fields||{},f=Object.keys(c),p=l.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let T=0;T<f.length&&T<_.length;++T){const E=_y(f[T],_[T]);if(E!==0)return E;const C=Fr(c[f[T]],p[_[T]]);if(C!==0)return C}return xe(f.length,_.length)})(n.mapValue,e.mapValue);default:throw _e(23264,{he:t})}}function sI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=ks(n),i=ks(e),r=xe(t.seconds,i.seconds);return r!==0?r:xe(t.nanos,i.nanos)}function rI(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const a=Fr(t[r],i[r]);if(a)return a}return xe(t.length,i.length)}function wl(n){return wy(n)}function wy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ks(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ls(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return he.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const a of t.values||[])r?r=!1:i+=",",i+=wy(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",a=!0;for(const l of i)a?a=!1:r+=",",r+=`${l}:${wy(t.fields[l])}`;return r+"}"})(n.mapValue):_e(61005,{value:n})}function oh(n){switch(Or(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=op(n);return e?16+oh(e):16;case 5:return 2*n.stringValue.length;case 6:return Ls(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,a)=>r+oh(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return ta(i.fields,((a,l)=>{r+=a.length+oh(l)})),r})(n.mapValue);default:throw _e(13486,{value:n})}}function Fc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Cy(n){return!!n&&"integerValue"in n}function Bc(n){return!!n&&"arrayValue"in n}function oI(n){return!!n&&"nullValue"in n}function aI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ah(n){return!!n&&"mapValue"in n}function ap(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[v_])==null?void 0:i.stringValue)===T_}function Sc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ta(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Sc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Sc(n.arrayValue.values[t]);return e}return{...n}}function xb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Rb}const Nb={mapValue:{fields:{[v_]:{stringValue:T_},[Il]:{arrayValue:{}}}}};function a5(n){return"nullValue"in n?rh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Fc($o.empty(),he.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?ap(n)?Nb:{mapValue:{}}:_e(35942,{value:n})}function l5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Fc($o.empty(),he.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Nb:"mapValue"in n?ap(n)?{mapValue:{}}:Nr:_e(61959,{value:n})}function lI(n,e){const t=Fr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function uI(n,e){const t=Fr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ah(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Sc(t)}setAll(e){let t=St.emptyPath(),i={},r=[];e.forEach(((l,c)=>{if(!t.isImmediateParentOf(c)){const f=this.getFieldsMap(t);this.applyChanges(f,i,r),i={},r=[],t=c.popLast()}l?i[c.lastSegment()]=Sc(l):r.push(c.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,r)}delete(e){const t=this.field(e.popLast());ah(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];ah(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ta(t,((r,a)=>e[r]=a));for(const r of i)delete e[r]}clone(){return new Nn(Sc(this.value))}}function Mb(n){const e=[];return ta(n.fields,((t,i)=>{const r=new St([t]);if(ah(i)){const a=Mb(i.mapValue).fields;if(a.length===0)e.push(r);else for(const l of a)e.push(r.child(l))}else e.push(r)})),new li(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t,i,r,a,l,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=a,this.data=l,this.documentState=c}static newInvalidDocument(e){return new Ct(e,0,we.min(),we.min(),we.min(),Nn.empty(),0)}static newFoundDocument(e,t,i,r){return new Ct(e,1,t,we.min(),i,r,0)}static newNoDocument(e,t){return new Ct(e,2,t,we.min(),we.min(),Nn.empty(),0)}static newUnknownDocument(e,t){return new Ct(e,3,t,we.min(),we.min(),Nn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,t){this.position=e,this.inclusive=t}}function cI(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const a=e[r],l=n.position[r];if(a.field.isKeyField()?i=he.comparator(he.fromName(l.referenceValue),t.key):i=Fr(l,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function dI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!rs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,t="asc"){this.field=e,this.dir=t}}function u5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{}class Ke extends Db{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new c5(e,t,i):t==="array-contains"?new h5(e,i):t==="in"?new Ob(e,i):t==="not-in"?new p5(e,i):t==="array-contains-any"?new m5(e,i):new Ke(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new d5(e,i):new f5(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fr(t,this.value)):t!==null&&Or(this.value)===Or(t)&&this.matchesComparison(Fr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ot extends Db{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ot(e,t)}matches(e){return bl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function bl(n){return n.op==="and"}function by(n){return n.op==="or"}function E_(n){return Pb(n)&&bl(n)}function Pb(n){for(const e of n.filters)if(e instanceof ot)return!1;return!0}function Ry(n){if(n instanceof Ke)return n.field.canonicalString()+n.op.toString()+wl(n.value);if(E_(n))return n.filters.map((e=>Ry(e))).join(",");{const e=n.filters.map((t=>Ry(t))).join(",");return`${n.op}(${e})`}}function Vb(n,e){return n instanceof Ke?(function(i,r){return r instanceof Ke&&i.op===r.op&&i.field.isEqual(r.field)&&rs(i.value,r.value)})(n,e):n instanceof ot?(function(i,r){return r instanceof ot&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((a,l,c)=>a&&Vb(l,r.filters[c])),!0):!1})(n,e):void _e(19439)}function kb(n,e){const t=n.filters.concat(e);return ot.create(t,n.op)}function Lb(n){return n instanceof Ke?(function(t){return`${t.field.canonicalString()} ${t.op} ${wl(t.value)}`})(n):n instanceof ot?(function(t){return t.op.toString()+" {"+t.getFilters().map(Lb).join(" ,")+"}"})(n):"Filter"}class c5 extends Ke{constructor(e,t,i){super(e,t,i),this.key=he.fromName(i.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class d5 extends Ke{constructor(e,t){super(e,"in",t),this.keys=Ub("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class f5 extends Ke{constructor(e,t){super(e,"not-in",t),this.keys=Ub("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ub(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>he.fromName(i.referenceValue)))}class h5 extends Ke{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Bc(t)&&Oc(t.arrayValue,this.value)}}class Ob extends Ke{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Oc(this.value.arrayValue,t)}}class p5 extends Ke{constructor(e,t){super(e,"not-in",t)}matches(e){if(Oc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Oc(this.value.arrayValue,t)}}class m5 extends Ke{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Bc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Oc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,t=null,i=[],r=[],a=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=a,this.startAt=l,this.endAt=c,this.Te=null}}function xy(n,e=null,t=[],i=[],r=null,a=null,l=null){return new g5(n,e,t,i,r,a,l)}function Yo(n){const e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ry(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),np(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>wl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>wl(i))).join(",")),e.Te=t}return e.Te}function jc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!u5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Vb(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!dI(n.startAt,e.startAt)&&dI(n.endAt,e.endAt)}function bh(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Rh(n,e){return n.filters.filter((t=>t instanceof Ke&&t.field.isEqual(e)))}function fI(n,e,t){let i=rh,r=!0;for(const a of Rh(n,e)){let l=rh,c=!0;switch(a.op){case"<":case"<=":l=a5(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,c=!1;break;case"!=":case"not-in":l=rh}lI({value:i,inclusive:r},{value:l,inclusive:c})<0&&(i=l,r=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];lI({value:i,inclusive:r},{value:l,inclusive:t.inclusive})<0&&(i=l,r=t.inclusive);break}}return{value:i,inclusive:r}}function hI(n,e,t){let i=Nr,r=!0;for(const a of Rh(n,e)){let l=Nr,c=!0;switch(a.op){case">=":case">":l=l5(a.value),c=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,c=!1;break;case"!=":case"not-in":l=Nr}uI({value:i,inclusive:r},{value:l,inclusive:c})>0&&(i=l,r=c)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];uI({value:i,inclusive:r},{value:l,inclusive:t.inclusive})>0&&(i=l,r=t.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,t=null,i=[],r=[],a=null,l="F",c=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=a,this.limitType=l,this.startAt=c,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Fb(n,e,t,i,r,a,l,c){return new Hl(n,e,t,i,r,a,l,c)}function Xc(n){return new Hl(n)}function pI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function y5(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Bb(n){return n.collectionGroup!==null}function Ac(n){const e=Ee(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new at(St.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(c=c.add(p.field))}))})),c})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Gc(a,i))})),t.has(St.keyField().canonicalString())||e.Ie.push(new Gc(St.keyField(),i))}return e.Ie}function Kn(n){const e=Ee(n);return e.Ee||(e.Ee=_5(e,Ac(n))),e.Ee}function _5(n,e){if(n.limitType==="F")return xy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const a=r.dir==="desc"?"asc":"desc";return new Gc(r.field,a)}));const t=n.endAt?new Cl(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Cl(n.startAt.position,n.startAt.inclusive):null;return xy(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Ny(n,e){const t=n.filters.concat([e]);return new Hl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function v5(n,e){const t=n.explicitOrderBy.concat([e]);return new Hl(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function xh(n,e,t){return new Hl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function lp(n,e){return jc(Kn(n),Kn(e))&&n.limitType===e.limitType}function Gb(n){return`${Yo(Kn(n))}|lt:${n.limitType}`}function tl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>Lb(r))).join(", ")}]`),np(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>wl(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>wl(r))).join(",")),`Target(${i})`})(Kn(n))}; limitType=${n.limitType})`}function Wc(n,e){return e.isFoundDocument()&&(function(i,r){const a=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):he.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,r){for(const a of Ac(i))if(!a.field.isKeyField()&&r.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const a of i.filters)if(!a.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(l,c,f){const p=cI(l,c,f);return l.inclusive?p<=0:p<0})(i.startAt,Ac(i),r)||i.endAt&&!(function(l,c,f){const p=cI(l,c,f);return l.inclusive?p>=0:p>0})(i.endAt,Ac(i),r))})(n,e)}function qb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function zb(n){return(e,t)=>{let i=!1;for(const r of Ac(n)){const a=T5(r,e,t);if(a!==0)return a;i=i||r.field.isKeyField()}return 0}}function T5(n,e,t){const i=n.field.isKeyField()?he.comparator(e.key,t.key):(function(a,l,c){const f=l.data.field(a),p=c.data.field(a);return f!==null&&p!==null?Fr(f,p):_e(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return _e(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,a]of i)if(this.equalsFn(r,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ta(this.inner,((t,i)=>{for(const[r,a]of i)e(r,a)}))}isEmpty(){return Sb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5=new pt(he.comparator);function Hn(){return E5}const Hb=new pt(he.comparator);function hc(...n){let e=Hb;for(const t of n)e=e.insert(t.key,t);return e}function Kb(n){let e=Hb;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ns(){return Ic()}function Jb(){return Ic()}function Ic(){return new qs((n=>n.toString()),((n,e)=>n.isEqual(e)))}const S5=new pt(he.comparator),A5=new at(he.comparator);function Oe(...n){let e=A5;for(const t of n)e=e.add(t);return e}const I5=new at(xe);function S_(){return I5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pc(e)?"-0":e}}function $b(n){return{integerValue:""+n}}function w5(n,e){return db(e)?$b(e):A_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this._=void 0}}function C5(n,e,t){return n instanceof Rl?(function(r,a){const l={fields:{[wb]:{stringValue:Ib},[bb]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return a&&__(a)&&(a=op(a)),a&&(l.fields[Cb]=a),{mapValue:l}})(t,e):n instanceof xl?Qb(n,e):n instanceof Nl?jb(n,e):(function(r,a){const l=Yb(r,a),c=mI(l)+mI(r.Ae);return Cy(l)&&Cy(r.Ae)?$b(c):A_(r.serializer,c)})(n,e)}function b5(n,e,t){return n instanceof xl?Qb(n,e):n instanceof Nl?jb(n,e):t}function Yb(n,e){return n instanceof qc?(function(i){return Cy(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class Rl extends up{}class xl extends up{constructor(e){super(),this.elements=e}}function Qb(n,e){const t=Xb(e);for(const i of n.elements)t.some((r=>rs(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Nl extends up{constructor(e){super(),this.elements=e}}function jb(n,e){let t=Xb(e);for(const i of n.elements)t=t.filter((r=>!rs(r,i)));return{arrayValue:{values:t}}}class qc extends up{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function mI(n){return Et(n.integerValue||n.doubleValue)}function Xb(n){return Bc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,t){this.field=e,this.transform=t}}function R5(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof xl&&r instanceof xl||i instanceof Nl&&r instanceof Nl?_l(i.elements,r.elements,rs):i instanceof qc&&r instanceof qc?rs(i.Ae,r.Ae):i instanceof Rl&&r instanceof Rl})(n.transform,e.transform)}class x5{constructor(e,t){this.version=e,this.transformResults=t}}class Dn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dn}static exists(e){return new Dn(void 0,e)}static updateTime(e){return new Dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class cp{}function Zb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new I_(n.key,Dn.none()):new Kl(n.key,n.data,Dn.none());{const t=n.data,i=Nn.empty();let r=new at(St.comparator);for(let a of e.fields)if(!r.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?i.delete(a):i.set(a,l),r=r.add(a)}return new Kr(n.key,i,new li(r.toArray()),Dn.none())}}function N5(n,e,t){n instanceof Kl?(function(r,a,l){const c=r.value.clone(),f=yI(r.fieldTransforms,a,l.transformResults);c.setAll(f),a.convertToFoundDocument(l.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Kr?(function(r,a,l){if(!lh(r.precondition,a))return void a.convertToUnknownDocument(l.version);const c=yI(r.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(eR(r)),f.setAll(c),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(r,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function wc(n,e,t,i){return n instanceof Kl?(function(a,l,c,f){if(!lh(a.precondition,l))return c;const p=a.value.clone(),_=_I(a.fieldTransforms,f,l);return p.setAll(_),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof Kr?(function(a,l,c,f){if(!lh(a.precondition,l))return c;const p=_I(a.fieldTransforms,f,l),_=l.data;return _.setAll(eR(a)),_.setAll(p),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((T=>T.field)))})(n,e,t,i):(function(a,l,c){return lh(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c})(n,e,t)}function M5(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),a=Yb(i.transform,r||null);a!=null&&(t===null&&(t=Nn.empty()),t.set(i.field,a))}return t||null}function gI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&_l(i,r,((a,l)=>R5(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Kl extends cp{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Kr extends cp{constructor(e,t,i,r,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function eR(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function yI(n,e,t){const i=new Map;Ae(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){const a=n[r],l=a.transform,c=e.data.field(a.field);i.set(a.field,b5(l,c,t[r]))}return i}function _I(n,e,t){const i=new Map;for(const r of n){const a=r.transform,l=t.data.field(r.field);i.set(r.field,C5(a,l,e))}return i}class I_ extends cp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tR extends cp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const a=this.mutations[r];a.key.isEqual(e.key)&&N5(a,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=wc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=wc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=Jb();return this.mutations.forEach((r=>{const a=e.get(r.key),l=a.overlayedDocument;let c=this.applyToLocalView(l,a.mutatedFields);c=t.has(r.key)?null:c;const f=Zb(l,c);f!==null&&i.set(r.key,f),l.isValidDocument()||l.convertToNoDocument(we.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Oe())}isEqual(e){return this.batchId===e.batchId&&_l(this.mutations,e.mutations,((t,i)=>gI(t,i)))&&_l(this.baseMutations,e.baseMutations,((t,i)=>gI(t,i)))}}class C_{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ae(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return S5})();const a=e.mutations;for(let l=0;l<a.length;l++)r=r.insert(a[l].key,i[l].version);return new C_(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt,Ye;function P5(n){switch(n){case ie.OK:return _e(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return _e(15467,{code:n})}}function nR(n){if(n===void 0)return Mt("GRPC error has no .code"),ie.UNKNOWN;switch(n){case zt.OK:return ie.OK;case zt.CANCELLED:return ie.CANCELLED;case zt.UNKNOWN:return ie.UNKNOWN;case zt.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case zt.INTERNAL:return ie.INTERNAL;case zt.UNAVAILABLE:return ie.UNAVAILABLE;case zt.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case zt.NOT_FOUND:return ie.NOT_FOUND;case zt.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case zt.ABORTED:return ie.ABORTED;case zt.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case zt.DATA_LOSS:return ie.DATA_LOSS;default:return _e(39323,{code:n})}}(Ye=zt||(zt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5=new Vr([4294967295,4294967295],0);function vI(n){const e=V5().encode(n),t=new jC;return t.update(e),new Uint8Array(t.digest())}function TI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Vr([t,i],0),new Vr([r,a],0)]}class R_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new pc(`Invalid padding: ${t}`);if(i<0)throw new pc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new pc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new pc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Vr.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Vr.fromNumber(i)));return r.compare(k5)===1&&(r=new Vr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=vI(e),[i,r]=TI(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,r,a);if(!this.we(l))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new R_(a,r,t);return i.forEach((c=>l.insert(c))),l}insert(e){if(this.ge===0)return;const t=vI(e),[i,r]=TI(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,r,a);this.be(l)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t,i,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,ed.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Zc(we.min(),r,new pt(xe),Hn(),Oe())}}class ed{constructor(e,t,i,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new ed(i,t,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}}class iR{constructor(e,t){this.targetId=e,this.Ce=t}}class sR{constructor(e,t,i=Pt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class EI{constructor(){this.ve=0,this.Fe=SI(),this.Me=Pt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Oe(),t=Oe(),i=Oe();return this.Fe.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:_e(38017,{changeType:a})}})),new ed(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=SI()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ae(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class L5{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hn(),this.He=Hf(),this.Je=Hf(),this.Ze=new pt(xe)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:_e(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const a=r.target;if(bh(a))if(i===0){const l=new he(a.path);this.et(t,l,Ct.newNoDocument(l,we.min()))}else Ae(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const c=this.ut(e),f=c?this.ct(c,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:a=0}=t;let l,c;try{l=Ls(i).toUint8Array()}catch(f){if(f instanceof Ab)return yl("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{c=new R_(l,r,a)}catch(f){return yl(f instanceof pc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return c.ge===0?null:c}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((a=>{const l=this.Ge.ht(),c=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.et(t,a,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const c=this.ot(l);if(c){if(a.current&&bh(c.target)){const f=new he(c.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,Ct.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.Ke())}}));let i=Oe();this.Je.forEach(((a,l)=>{let c=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(i=i.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const r=new Zc(e,t,this.Ze,this.je,i);return this.je=Hn(),this.He=Hf(),this.Je=Hf(),this.Ze=new pt(xe),r}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new EI,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new at(xe),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new at(xe),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||le("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new EI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Hf(){return new pt(he.comparator)}function SI(){return new pt(he.comparator)}const U5={asc:"ASCENDING",desc:"DESCENDING"},O5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},F5={and:"AND",or:"OR"};class B5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function My(n,e){return n.useProto3Json||np(e)?e:{value:e}}function Ml(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function G5(n,e){return Ml(n,e.toTimestamp())}function Tn(n){return Ae(!!n,49232),we.fromTimestamp((function(t){const i=ks(t);return new rt(i.seconds,i.nanos)})(n))}function x_(n,e){return Dy(n,e).canonicalString()}function Dy(n,e){const t=(function(r){return new et(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function oR(n){const e=et.fromString(n);return Ae(mR(e),10190,{key:e.toString()}),e}function Nh(n,e){return x_(n.databaseId,e.path)}function Go(n,e){const t=oR(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(uR(t))}function aR(n,e){return x_(n.databaseId,e)}function lR(n){const e=oR(n);return e.length===4?et.emptyPath():uR(e)}function Py(n){return new et(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function uR(n){return Ae(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function AI(n,e,t){return{name:Nh(n,e),fields:t.value.mapValue.fields}}function q5(n,e,t){const i=Go(n,e.name),r=Tn(e.updateTime),a=e.createTime?Tn(e.createTime):we.min(),l=new Nn({mapValue:{fields:e.fields}}),c=Ct.newFoundDocument(i,r,a,l);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function z5(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:_e(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],a=(function(p,_){return p.useProto3Json?(Ae(_===void 0||typeof _=="string",58123),Pt.fromBase64String(_||"")):(Ae(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Pt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,c=l&&(function(p){const _=p.code===void 0?ie.UNKNOWN:nR(p.code);return new ue(_,p.message||"")})(l);t=new sR(i,r,a,c||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Go(n,i.document.name),a=Tn(i.document.updateTime),l=i.document.createTime?Tn(i.document.createTime):we.min(),c=new Nn({mapValue:{fields:i.document.fields}}),f=Ct.newFoundDocument(r,a,l,c),p=i.targetIds||[],_=i.removedTargetIds||[];t=new uh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Go(n,i.document),a=i.readTime?Tn(i.readTime):we.min(),l=Ct.newNoDocument(r,a),c=i.removedTargetIds||[];t=new uh([],c,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Go(n,i.document),a=i.removedTargetIds||[];t=new uh([],a,r,null)}else{if(!("filter"in e))return _e(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:a}=i,l=new D5(r,a),c=i.targetId;t=new iR(c,l)}}return t}function Mh(n,e){let t;if(e instanceof Kl)t={update:AI(n,e.key,e.value)};else if(e instanceof I_)t={delete:Nh(n,e.key)};else if(e instanceof Kr)t={update:AI(n,e.key,e.data),updateMask:Q5(e.fieldMask)};else{if(!(e instanceof tR))return _e(16599,{dt:e.type});t={verify:Nh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,l){const c=l.transform;if(c instanceof Rl)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof xl)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Nl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof qc)return{fieldPath:l.field.canonicalString(),increment:c.Ae};throw _e(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,a){return a.updateTime!==void 0?{updateTime:G5(r,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:_e(27497)})(n,e.precondition)),t}function Vy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Dn.updateTime(Tn(a.updateTime)):a.exists!==void 0?Dn.exists(a.exists):Dn.none()})(e.currentDocument):Dn.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(l,c){let f=null;if("setToServerValue"in c)Ae(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),f=new Rl;else if("appendMissingElements"in c){const _=c.appendMissingElements.values||[];f=new xl(_)}else if("removeAllFromArray"in c){const _=c.removeAllFromArray.values||[];f=new Nl(_)}else"increment"in c?f=new qc(l,c.increment):_e(16584,{proto:c});const p=St.fromServerFormat(c.fieldPath);return new Wb(p,f)})(n,r))):[];if(e.update){e.update.name;const r=Go(n,e.update.name),a=new Nn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new li(p.map((_=>St.fromServerFormat(_))))})(e.updateMask);return new Kr(r,a,l,t,i)}return new Kl(r,a,t,i)}if(e.delete){const r=Go(n,e.delete);return new I_(r,t)}if(e.verify){const r=Go(n,e.verify);return new tR(r,t)}return _e(1463,{proto:e})}function H5(n,e){return n&&n.length>0?(Ae(e!==void 0,14353),n.map((t=>(function(r,a){let l=r.updateTime?Tn(r.updateTime):Tn(a);return l.isEqual(we.min())&&(l=Tn(a)),new x5(l,r.transformResults||[])})(t,e)))):[]}function cR(n,e){return{documents:[aR(n,e.path)]}}function dR(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=aR(n,r);const a=(function(p){if(p.length!==0)return pR(ot.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((_=>(function(E){return{field:nl(E.field),direction:J5(E.dir)}})(_)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const c=My(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function fR(n){let e=lR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ae(i===1,65062);const _=t.from[0];_.allDescendants?r=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(T){const E=hR(T);return E instanceof ot&&E_(E)?E.getFilters():[E]})(t.where));let l=[];t.orderBy&&(l=(function(T){return T.map((E=>(function(x){return new Gc(il(x.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(x.direction))})(E)))})(t.orderBy));let c=null;t.limit&&(c=(function(T){let E;return E=typeof T=="object"?T.value:T,np(E)?null:E})(t.limit));let f=null;t.startAt&&(f=(function(T){const E=!!T.before,C=T.values||[];return new Cl(C,E)})(t.startAt));let p=null;return t.endAt&&(p=(function(T){const E=!T.before,C=T.values||[];return new Cl(C,E)})(t.endAt)),Fb(e,r,l,a,c,"F",f,p)}function K5(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function hR(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=il(t.unaryFilter.field);return Ke.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=il(t.unaryFilter.field);return Ke.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=il(t.unaryFilter.field);return Ke.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=il(t.unaryFilter.field);return Ke.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _e(61313);default:return _e(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ke.create(il(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _e(58110);default:return _e(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ot.create(t.compositeFilter.filters.map((i=>hR(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return _e(1026)}})(t.compositeFilter.op))})(n):_e(30097,{filter:n})}function J5(n){return U5[n]}function $5(n){return O5[n]}function Y5(n){return F5[n]}function nl(n){return{fieldPath:n.canonicalString()}}function il(n){return St.fromServerFormat(n.fieldPath)}function pR(n){return n instanceof Ke?(function(t){if(t.op==="=="){if(aI(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NAN"}};if(oI(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(aI(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NOT_NAN"}};if(oI(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nl(t.field),op:$5(t.op),value:t.value}}})(n):n instanceof ot?(function(t){const i=t.getFilters().map((r=>pR(r)));return i.length===1?i[0]:{compositeFilter:{op:Y5(t.op),filters:i}}})(n):_e(54877,{filter:n})}function Q5(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function mR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function gR(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t,i,r,a=we.min(),l=we.min(),c=Pt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=c,this.expectedCount=f}withSequenceNumber(e){return new xs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new xs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.yt=e}}function j5(n,e){let t;if(e.document)t=q5(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=he.fromSegments(e.noDocument.path),r=jo(e.noDocument.readTime);t=Ct.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return _e(56709);{const i=he.fromSegments(e.unknownDocument.path),r=jo(e.unknownDocument.version);t=Ct.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const a=new rt(r[0],r[1]);return we.fromTimestamp(a)})(e.readTime)),t}function II(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(a,l){return{name:Nh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Ml(a,l.version.toTimestamp()),createTime:Ml(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Qo(e.version)};else{if(!e.isUnknownDocument())return _e(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Qo(e.version)}}return i}function Dh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Qo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function jo(n){const e=new rt(n.seconds,n.nanoseconds);return we.fromTimestamp(e)}function Vo(n,e){const t=(e.baseMutations||[]).map((a=>Vy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];l.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const i=e.mutations.map((a=>Vy(n.yt,a))),r=rt.fromMillis(e.localWriteTimeMs);return new w_(e.batchId,r,t,i)}function mc(n){const e=jo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?jo(n.lastLimboFreeSnapshotVersion):we.min();let i;return i=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Ae(l===1,1966,{count:l}),Kn(Xc(lR(a.documents[0])))})(n.query):(function(a){return Kn(fR(a))})(n.query),new xs(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Pt.fromBase64String(n.resumeToken))}function _R(n,e){const t=Qo(e.snapshotVersion),i=Qo(e.lastLimboFreeSnapshotVersion);let r;r=bh(e.target)?cR(n.yt,e.target):dR(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Yo(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function vR(n){const e=fR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xh(e,e.limit,"L"):e}function Ug(n,e){return new b_(e.largestBatchId,Vy(n.yt,e.overlayMutation))}function wI(n,e){const t=e.path.lastSegment();return[n,mn(e.path.popLast()),t]}function CI(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Qo(i.readTime),documentKey:mn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{getBundleMetadata(e,t){return bI(e).get(t).next((i=>{if(i)return(function(a){return{id:a.bundleId,createTime:jo(a.createTime),version:a.version}})(i)}))}saveBundleMetadata(e,t){return bI(e).put((function(r){return{bundleId:r.id,createTime:Qo(Tn(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return RI(e).get(t).next((i=>{if(i)return(function(a){return{name:a.name,query:vR(a.bundledQuery),readTime:jo(a.readTime)}})(i)}))}saveNamedQuery(e,t){return RI(e).put((function(r){return{name:r.name,readTime:Qo(Tn(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function bI(n){return Qt(n,ip)}function RI(n){return Qt(n,sp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new dp(e,i)}getOverlay(e,t){return rc(e).get(wI(this.userId,t)).next((i=>i?Ug(this.serializer,i):null))}getOverlays(e,t){const i=ns();return J.forEach(t,(r=>this.getOverlay(e,r).next((a=>{a!==null&&i.set(r,a)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((a,l)=>{const c=new b_(t,l);r.push(this.bt(e,c))})),J.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((l=>r.add(mn(l.getCollectionPath()))));const a=[];return r.forEach((l=>{const c=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);a.push(rc(e).X(Sy,c))})),J.waitFor(a)}getOverlaysForCollection(e,t,i){const r=ns(),a=mn(t),l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return rc(e).H(Sy,l).next((c=>{for(const f of c){const p=Ug(this.serializer,f);r.set(p.getKey(),p)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const a=ns();let l;const c=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return rc(e).ee({index:yb,range:c},((f,p,_)=>{const T=Ug(this.serializer,p);a.size()<r||T.largestBatchId===l?(a.set(T.getKey(),T),l=T.largestBatchId):_.done()})).next((()=>a))}bt(e,t){return rc(e).put((function(r,a,l){const[c,f,p]=wI(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Mh(r.yt,l.mutation)}})(this.serializer,this.userId,t))}}function rc(n){return Qt(n,rp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{St(e){return Qt(e,g_)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Pt.fromUint8Array(i):Pt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Et(e.integerValue));else if("doubleValue"in e){const i=Et(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Pc(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=ks(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ls(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?xb(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):ap(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):_e(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){var l,c;const i=e.fields||{};this.Ft(t,53);const r=Il,a=((c=(l=i[r].arrayValue)==null?void 0:l.values)==null?void 0:c.length)||0;this.Ft(t,15),t.Mt(Et(a)),this.Ot(r,t),this.Ct(i[r],t)}qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),he.fromName(e).path.forEach((i=>{this.Ft(t,60),this.$t(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ko.Wt=new ko;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=255;function Z5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function xI(n){const e=64-(function(i){let r=0;for(let a=0;a<8;++a){const l=Z5(255&i[a]);if(r+=l,l!==8)break}return r})(n);return Math.ceil(e/8)}class e3{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ht(i.value),i=t.next();this.Jt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ht(i);else if(i<2048)this.Ht(960|i>>>6),this.Ht(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i);else{const r=t.codePointAt(0);this.Ht(240|r>>>18),this.Ht(128|63&r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r)}}this.Jt()}Yt(e){const t=this.en(e),i=xI(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=xI(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(Qa),this.sn(255)}_n(){this.an(Qa),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Qa?(this.sn(Qa),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Qa?(this.an(Qa),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class t3{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class n3{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class oc{constructor(){this.cn=new e3,this.ascending=new t3(this.cn),this.descending=new n3(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t,i,r){this.hn=e,this.Pn=t,this.Tn=i,this.In=r}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.In,0),t!==e?i.set([0],this.In.length):++i[i.length-1],new Lo(this.hn,this.Pn,this.Tn,i)}Rn(e,t,i){return{indexId:this.hn,uid:e,arrayValue:ch(this.Tn),directionalValue:ch(this.In),orderedDocumentKey:ch(t),documentKey:i.path.toArray()}}An(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function Sr(n,e){let t=n.hn-e.hn;return t!==0?t:(t=NI(n.Tn,e.Tn),t!==0?t:(t=NI(n.In,e.In),t!==0?t:he.comparator(n.Pn,e.Pn)))}function NI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function ch(n){return qC()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function MI(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class DI{constructor(e){this.Vn=new at(((t,i)=>St.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Vn=this.Vn.add(i):this.mn.push(i)}}get fn(){return this.Vn.size>1}gn(e){if(Ae(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=vy(e);if(t!==void 0&&!this.pn(t))return!1;const i=Mo(e);let r=new Set,a=0,l=0;for(;a<i.length&&this.pn(i[a]);++a)r=r.add(i[a].fieldPath.canonicalString());if(a===i.length)return!0;if(this.Vn.size>0){const c=this.Vn.getIterator().getNext();if(!r.has(c.field.canonicalString())){const f=i[a];if(!this.yn(c,f)||!this.wn(this.dn[l++],f))return!1}++a}for(;a<i.length;++a){const c=i[a];if(l>=this.dn.length||!this.wn(this.dn[l++],c))return!1}return!0}bn(){if(this.fn)return null;let e=new at(St.comparator);const t=[];for(const i of this.mn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new nh(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new nh(i.field,0))}for(const i of this.dn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new nh(i.field,i.dir==="asc"?0:1)));return new Ah(Ah.UNKNOWN_ID,this.collectionId,t,Dc.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(n){var t,i;if(Ae(n instanceof Ke||n instanceof ot,20012),n instanceof Ke){if(n instanceof Ob){const r=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((a=>Ke.create(n.field,"==",a))))||[];return ot.create(r,"or")}return n}const e=n.filters.map((r=>TR(r)));return ot.create(e,n.op)}function i3(n){if(n.getFilters().length===0)return[];const e=Uy(TR(n));return Ae(ER(e),7391),ky(e)||Ly(e)?[e]:e.getFilters()}function ky(n){return n instanceof Ke}function Ly(n){return n instanceof ot&&E_(n)}function ER(n){return ky(n)||Ly(n)||(function(t){if(t instanceof ot&&by(t)){for(const i of t.getFilters())if(!ky(i)&&!Ly(i))return!1;return!0}return!1})(n)}function Uy(n){if(Ae(n instanceof Ke||n instanceof ot,34018),n instanceof Ke)return n;if(n.filters.length===1)return Uy(n.filters[0]);const e=n.filters.map((i=>Uy(i)));let t=ot.create(e,n.op);return t=Ph(t),ER(t)?t:(Ae(t instanceof ot,64498),Ae(bl(t),40251),Ae(t.filters.length>1,57927),t.filters.reduce(((i,r)=>N_(i,r))))}function N_(n,e){let t;return Ae(n instanceof Ke||n instanceof ot,38388),Ae(e instanceof Ke||e instanceof ot,25473),t=n instanceof Ke?e instanceof Ke?(function(r,a){return ot.create([r,a],"and")})(n,e):PI(n,e):e instanceof Ke?PI(e,n):(function(r,a){if(Ae(r.filters.length>0&&a.filters.length>0,48005),bl(r)&&bl(a))return kb(r,a.getFilters());const l=by(r)?r:a,c=by(r)?a:r,f=l.filters.map((p=>N_(p,c)));return ot.create(f,"or")})(n,e),Ph(t)}function PI(n,e){if(bl(e))return kb(e,n.getFilters());{const t=e.filters.map((i=>N_(n,i)));return ot.create(t,"or")}}function Ph(n){if(Ae(n instanceof Ke||n instanceof ot,11850),n instanceof Ke)return n;const e=n.getFilters();if(e.length===1)return Ph(e[0]);if(Pb(n))return n;const t=e.map((r=>Ph(r))),i=[];return t.forEach((r=>{r instanceof Ke?i.push(r):r instanceof ot&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:ot.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(){this.Sn=new M_}addToCollectionParentIndex(e,t){return this.Sn.add(t),J.resolve()}getCollectionParents(e,t){return J.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return J.resolve()}deleteFieldIndex(e,t){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,t){return J.resolve()}getDocumentsMatchingTarget(e,t){return J.resolve(null)}getIndexType(e,t){return J.resolve(0)}getFieldIndexes(e,t){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,t){return J.resolve(Jn.min())}getMinOffsetFromCollectionGroup(e,t){return J.resolve(Jn.min())}updateCollectionGroup(e,t,i){return J.resolve()}updateIndexEntries(e,t){return J.resolve()}}class M_{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new at(et.comparator),a=!r.has(i);return this.index[t]=r.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new at(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="IndexedDbIndexManager",Kf=new Uint8Array(0);class r3{constructor(e,t){this.databaseId=t,this.Dn=new M_,this.Cn=new qs((i=>Yo(i)),((i,r)=>jc(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const a={collectionId:i,parent:mn(r)};return kI(e).put(a)}return J.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[ib(t),""],!1,!0);return kI(e).H(r).next((a=>{for(const l of a){if(l.collectionId!==t)break;i.push(ts(l.parent))}return i}))}addFieldIndex(e,t){const i=ac(e),r=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete r.indexId;const a=i.add(r);if(t.indexState){const l=Xa(e);return a.next((c=>{l.put(CI(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const i=ac(e),r=Xa(e),a=ja(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=ac(e),i=ja(e),r=Xa(e);return t.X().next((()=>i.X())).next((()=>r.X()))}createTargetIndexes(e,t){return J.forEach(this.vn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const a=new DI(i).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const i=ja(e);let r=!0;const a=new Map;return J.forEach(this.vn(t),(l=>this.Fn(e,l).next((c=>{r&&(r=!!c),a.set(l,c)})))).next((()=>{if(r){let l=Oe();const c=[];return J.forEach(a,((f,p)=>{le(VI,`Using index ${(function(q){return`id=${q.indexId}|cg=${q.collectionGroup}|f=${q.fields.map((ee=>`${ee.fieldPath}:${ee.kind}`)).join(",")}`})(f)} to execute ${Yo(t)}`);const _=(function(q,ee){const ae=vy(ee);if(ae===void 0)return null;for(const z of Rh(q,ae.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null})(p,f),T=(function(q,ee){const ae=new Map;for(const z of Mo(ee))for(const N of Rh(q,z.fieldPath))switch(N.op){case"==":case"in":ae.set(z.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return ae.set(z.fieldPath.canonicalString(),N.value),Array.from(ae.values())}return null})(p,f),E=(function(q,ee){const ae=[];let z=!0;for(const N of Mo(ee)){const M=N.kind===0?fI(q,N.fieldPath,q.startAt):hI(q,N.fieldPath,q.startAt);ae.push(M.value),z&&(z=M.inclusive)}return new Cl(ae,z)})(p,f),C=(function(q,ee){const ae=[];let z=!0;for(const N of Mo(ee)){const M=N.kind===0?hI(q,N.fieldPath,q.endAt):fI(q,N.fieldPath,q.endAt);ae.push(M.value),z&&(z=M.inclusive)}return new Cl(ae,z)})(p,f),x=this.Mn(f,p,E),P=this.Mn(f,p,C),k=this.xn(f,p,T),K=this.On(f.indexId,_,x,E.inclusive,P,C.inclusive,k);return J.forEach(K,(W=>i.Z(W,t.limit).next((q=>{q.forEach((ee=>{const ae=he.fromSegments(ee.documentKey);l.has(ae)||(l=l.add(ae),c.push(ae))}))}))))})).next((()=>c))}return J.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=i3(ot.create(e.filters,"and")).map((i=>xy(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,i,r,a,l,c){const f=(t!=null?t.length:1)*Math.max(i.length,a.length),p=f/(t!=null?t.length:1),_=[];for(let T=0;T<f;++T){const E=t?this.Nn(t[T/p]):Kf,C=this.Bn(e,E,i[T%p],r),x=this.Ln(e,E,a[T%p],l),P=c.map((k=>this.Bn(e,E,k,!0)));_.push(...this.createRange(C,x,P))}return _}Bn(e,t,i,r){const a=new Lo(e,he.empty(),t,i);return r?a:a.En()}Ln(e,t,i,r){const a=new Lo(e,he.empty(),t,i);return r?a.En():a}Fn(e,t){const i=new DI(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((a=>{let l=null;for(const c of a)i.gn(c)&&(!l||c.fields.length>l.fields.length)&&(l=c);return l}))}getIndexType(e,t){let i=2;const r=this.vn(t);return J.forEach(r,(a=>this.Fn(e,a).next((l=>{l?i!==0&&l.fields.length<(function(f){let p=new at(St.comparator),_=!1;for(const T of f.filters)for(const E of T.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?_=!0:p=p.add(E.field));for(const T of f.orderBy)T.field.isKeyField()||(p=p.add(T.field));return p.size+(_?1:0)})(a)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&r.length>1&&i===2?1:i))}kn(e,t){const i=new oc;for(const r of Mo(e)){const a=t.data.field(r.fieldPath);if(a==null)return null;const l=i.ln(r.kind);ko.Wt.Dt(a,l)}return i.un()}Nn(e){const t=new oc;return ko.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const i=new oc;return ko.Wt.Dt(Fc(this.databaseId,t),i.ln((function(a){const l=Mo(a);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}xn(e,t,i){if(i===null)return[];let r=[];r.push(new oc);let a=0;for(const l of Mo(e)){const c=i[a++];for(const f of r)if(this.qn(t,l.fieldPath)&&Bc(c))r=this.Un(r,l,c);else{const p=f.ln(l.kind);ko.Wt.Dt(c,p)}}return this.$n(r)}Mn(e,t,i){return this.xn(e,t,i.position)}$n(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Un(e,t,i){const r=[...e],a=[];for(const l of i.arrayValue.values||[])for(const c of r){const f=new oc;f.seed(c.un()),ko.Wt.Dt(l,f.ln(t.kind)),a.push(f)}return a}qn(e,t){return!!e.filters.find((i=>i instanceof Ke&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=ac(e),r=Xa(e);return(t?i.H(Ey,IDBKeyRange.bound(t,t)):i.H()).next((a=>{const l=[];return J.forEach(a,(c=>r.get([c.indexId,this.uid]).next((f=>{l.push((function(_,T){const E=T?new Dc(T.sequenceNumber,new Jn(jo(T.readTime),new he(ts(T.documentKey)),T.largestBatchId)):Dc.empty(),C=_.fields.map((([x,P])=>new nh(St.fromServerFormat(x),P)));return new Ah(_.indexId,_.collectionGroup,C,E)})(c,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const a=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return a!==0?a:xe(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=ac(e),a=Xa(e);return this.Wn(e).next((l=>r.H(Ey,IDBKeyRange.bound(t,t)).next((c=>J.forEach(c,(f=>a.put(CI(f.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return J.forEach(t,((r,a)=>{const l=i.get(r.collectionGroup);return(l?J.resolve(l):this.getFieldIndexes(e,r.collectionGroup)).next((c=>(i.set(r.collectionGroup,c),J.forEach(c,(f=>this.Qn(e,r,f).next((p=>{const _=this.Gn(a,f);return p.isEqual(_)?J.resolve():this.zn(e,a,f,p,_)})))))))}))}jn(e,t,i,r){return ja(e).put(r.Rn(this.uid,this.Kn(i,t.key),t.key))}Hn(e,t,i,r){return ja(e).delete(r.An(this.uid,this.Kn(i,t.key),t.key))}Qn(e,t,i){const r=ja(e);let a=new at(Sr);return r.ee({index:gb,range:IDBKeyRange.only([i.indexId,this.uid,ch(this.Kn(i,t))])},((l,c)=>{a=a.add(new Lo(i.indexId,t,MI(c.arrayValue),MI(c.directionalValue)))})).next((()=>a))}Gn(e,t){let i=new at(Sr);const r=this.kn(t,e);if(r==null)return i;const a=vy(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Bc(l))for(const c of l.arrayValue.values||[])i=i.add(new Lo(t.indexId,e.key,this.Nn(c),r))}else i=i.add(new Lo(t.indexId,e.key,Kf,r));return i}zn(e,t,i,r,a){le(VI,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,_,T,E){const C=f.getIterator(),x=p.getIterator();let P=Ya(C),k=Ya(x);for(;P||k;){let K=!1,W=!1;if(P&&k){const q=_(P,k);q<0?W=!0:q>0&&(K=!0)}else P!=null?W=!0:K=!0;K?(T(k),k=Ya(x)):W?(E(P),P=Ya(C)):(P=Ya(C),k=Ya(x))}})(r,a,Sr,(c=>{l.push(this.jn(e,t,i,c))}),(c=>{l.push(this.Hn(e,t,i,c))})),J.waitFor(l)}Wn(e){let t=1;return Xa(e).ee({index:mb,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,a)=>{a.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,c)=>Sr(l,c))).filter(((l,c,f)=>!c||Sr(l,f[c-1])!==0));const r=[];r.push(e);for(const l of i){const c=Sr(l,e),f=Sr(l,t);if(c===0)r[0]=e.En();else if(c>0&&f<0)r.push(l),r.push(l.En());else if(f>0)break}r.push(t);const a=[];for(let l=0;l<r.length;l+=2){if(this.Jn(r[l],r[l+1]))return[];const c=r[l].An(this.uid,Kf,he.empty()),f=r[l+1].An(this.uid,Kf,he.empty());a.push(IDBKeyRange.bound(c,f))}return a}Jn(e,t){return Sr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(LI)}getMinOffset(e,t){return J.mapArray(this.vn(t),(i=>this.Fn(e,i).next((r=>r||_e(44426))))).next(LI)}}function kI(n){return Qt(n,Lc)}function ja(n){return Qt(n,Ec)}function ac(n){return Qt(n,m_)}function Xa(n){return Qt(n,Tc)}function LI(n){Ae(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;f_(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Jn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},SR=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AR(n,e,t){const i=n.store(Ai),r=n.store(Tl),a=[],l=IDBKeyRange.only(t.batchId);let c=0;const f=i.ee({range:l},((_,T,E)=>(c++,E.delete())));a.push(f.next((()=>{Ae(c===1,47070,{batchId:t.batchId})})));const p=[];for(const _ of t.mutations){const T=fb(e,_.key.path,t.batchId);a.push(r.delete(T)),p.push(_.key)}return J.waitFor(a).next((()=>p))}function Vh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw _e(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(SR,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class fp{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Zn={}}static wt(e,t,i,r){Ae(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new fp(a,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).ee({index:Uo,range:i},((r,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const a=sl(e),l=Ar(e);return l.add({}).next((c=>{Ae(typeof c=="number",49019);const f=new w_(c,t,i,r),p=(function(C,x,P){const k=P.baseMutations.map((W=>Mh(C.yt,W))),K=P.mutations.map((W=>Mh(C.yt,W)));return{userId:x,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:k,mutations:K}})(this.serializer,this.userId,f),_=[];let T=new at(((E,C)=>xe(E.canonicalString(),C.canonicalString())));for(const E of r){const C=fb(this.userId,E.key.path,c);T=T.add(E.key.path.popLast()),_.push(l.put(p)),_.push(a.put(C,VO))}return T.forEach((E=>{_.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Zn[c]=f.keys()})),J.waitFor(_).next((()=>f))}))}lookupMutationBatch(e,t){return Ar(e).get(t).next((i=>i?(Ae(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Vo(this.serializer,i)):null))}Xn(e,t){return this.Zn[t]?J.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Zn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return Ar(e).ee({index:Uo,range:r},((l,c,f)=>{c.userId===this.userId&&(Ae(c.batchId>=i,47524,{Yn:i}),a=Vo(this.serializer,c)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Fo;return Ar(e).ee({index:Uo,range:t,reverse:!0},((r,a,l)=>{i=a.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Fo],[this.userId,Number.POSITIVE_INFINITY]);return Ar(e).H(Uo,t).next((i=>i.map((r=>Vo(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=ih(this.userId,t.path),r=IDBKeyRange.lowerBound(i),a=[];return sl(e).ee({range:r},((l,c,f)=>{const[p,_,T]=l,E=ts(_);if(p===this.userId&&t.path.isEqual(E))return Ar(e).get(T).next((C=>{if(!C)throw _e(61480,{er:l,batchId:T});Ae(C.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:C.userId,batchId:T}),a.push(Vo(this.serializer,C))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(xe);const r=[];return t.forEach((a=>{const l=ih(this.userId,a.path),c=IDBKeyRange.lowerBound(l),f=sl(e).ee({range:c},((p,_,T)=>{const[E,C,x]=p,P=ts(C);E===this.userId&&a.path.isEqual(P)?i=i.add(x):T.done()}));r.push(f)})),J.waitFor(r).next((()=>this.tr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,a=ih(this.userId,i),l=IDBKeyRange.lowerBound(a);let c=new at(xe);return sl(e).ee({range:l},((f,p,_)=>{const[T,E,C]=f,x=ts(E);T===this.userId&&i.isPrefixOf(x)?x.length===r&&(c=c.add(C)):_.done()})).next((()=>this.tr(e,c)))}tr(e,t){const i=[],r=[];return t.forEach((a=>{r.push(Ar(e).get(a).next((l=>{if(l===null)throw _e(35274,{batchId:a});Ae(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),i.push(Vo(this.serializer,l))})))})),J.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return AR(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),J.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return J.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),r=[];return sl(e).ee({range:i},((a,l,c)=>{if(a[0]===this.userId){const f=ts(a[1]);r.push(f)}else c.done()})).next((()=>{Ae(r.length===0,56720,{rr:r.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return IR(e,this.userId,t)}ir(e){return wR(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Fo,lastStreamToken:""}))}}function IR(n,e,t){const i=ih(e,t.path),r=i[1],a=IDBKeyRange.lowerBound(i);let l=!1;return sl(n).ee({range:a,Y:!0},((c,f,p)=>{const[_,T,E]=c;_===e&&T===r&&(l=!0),p.done()})).next((()=>l))}function Ar(n){return Qt(n,Ai)}function sl(n){return Qt(n,Tl)}function wR(n){return Qt(n,Vc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Xo(0)}static ar(){return new Xo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const i=new Xo(t.highestTargetId);return t.highestTargetId=i.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>we.fromTimestamp(new rt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.ur(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.cr(e,r))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((i=>(i.targetCount+=1,this.hr(t,i),this.cr(e,i))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Wa(e).delete(t.targetId))).next((()=>this.ur(e))).next((i=>(Ae(i.targetCount>0,8065),i.targetCount-=1,this.cr(e,i))))}removeTargets(e,t,i){let r=0;const a=[];return Wa(e).ee(((l,c)=>{const f=mc(c);f.sequenceNumber<=t&&i.get(f.targetId)===null&&(r++,a.push(this.removeTargetData(e,f)))})).next((()=>J.waitFor(a))).next((()=>r))}forEachTarget(e,t){return Wa(e).ee(((i,r)=>{const a=mc(r);t(a)}))}ur(e){return OI(e).get(Ch).next((t=>(Ae(t!==null,2888),t)))}cr(e,t){return OI(e).put(Ch,t)}lr(e,t){return Wa(e).put(_R(this.serializer,t))}hr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Yo(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return Wa(e).ee({range:r,index:pb},((l,c,f)=>{const p=mc(c);jc(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,i){const r=[],a=Cr(e);return t.forEach((l=>{const c=mn(l.path);r.push(a.put({targetId:i,path:c})),r.push(this.referenceDelegate.addReference(e,i,l))})),J.waitFor(r)}removeMatchingKeys(e,t,i){const r=Cr(e);return J.forEach(t,(a=>{const l=mn(a.path);return J.waitFor([r.delete([i,l]),this.referenceDelegate.removeReference(e,i,a)])}))}removeMatchingKeysForTargetId(e,t){const i=Cr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Cr(e);let a=Oe();return r.ee({range:i,Y:!0},((l,c,f)=>{const p=ts(l[1]),_=new he(p);a=a.add(_)})).next((()=>a))}containsKey(e,t){const i=mn(t.path),r=IDBKeyRange.bound([i],[ib(i)],!1,!0);let a=0;return Cr(e).ee({index:p_,Y:!0,range:r},(([l,c],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return Wa(e).get(t).next((i=>i?mc(i):null))}}function Wa(n){return Qt(n,El)}function OI(n){return Qt(n,Bo)}function Cr(n){return Qt(n,Sl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="LruGarbageCollector",CR=1048576;function BI([n,e],[t,i]){const r=xe(n,t);return r===0?xe(e,i):r}class a3{constructor(e){this.Pr=e,this.buffer=new at(BI),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();BI(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class bR{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){le(FI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hr(t)?le(FI,"Ignoring IndexedDB error during garbage collection: ",t):await zr(t)}await this.Ar(3e5)}))}}class l3{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return J.resolve(Mn.ce);const i=new a3(t);return this.Vr.forEachTarget(e,(r=>i.Er(r.sequenceNumber))).next((()=>this.Vr.mr(e,(r=>i.Er(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(le("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(UI)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),UI):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,a,l,c,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),r=this.params.maximumSequenceNumbersToCollect):r=T,l=Date.now(),this.nthSequenceNumber(e,r)))).next((T=>(i=T,c=Date.now(),this.removeTargets(e,i,t)))).next((T=>(a=T,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((T=>(p=Date.now(),el()<=He.DEBUG&&le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${r} in `+(c-l)+`ms
	Removed ${a} targets in `+(f-c)+`ms
	Removed ${T} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:T}))))}}function RR(n,e){return new l3(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,t){this.db=e,this.garbageCollector=RR(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((i,r)=>t(r)))}addReference(e,t,i){return Jf(e,i)}removeReference(e,t,i){return Jf(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Jf(e,t)}wr(e,t){return(function(r,a){let l=!1;return wR(r).te((c=>IR(r,c,a).next((f=>(f&&(l=!0),J.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let a=0;return this.yr(e,((l,c)=>{if(c<=t){const f=this.wr(e,l).next((p=>{if(!p)return a++,i.getEntry(e,l).next((()=>(i.removeEntry(l,we.min()),Cr(e).delete((function(T){return[0,mn(T.path)]})(l)))))}));r.push(f)}})).next((()=>J.waitFor(r))).next((()=>i.apply(e))).next((()=>a))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Jf(e,t)}yr(e,t){const i=Cr(e);let r,a=Mn.ce;return i.ee({index:p_},(([l,c],{path:f,sequenceNumber:p})=>{l===0?(a!==Mn.ce&&t(new he(ts(r)),a),a=p,r=f):a=Mn.ce})).next((()=>{a!==Mn.ce&&t(new he(ts(r)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Jf(n,e){return Cr(n).put((function(i,r){return{targetId:0,path:mn(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.changes=new qs((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ct.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?J.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return bo(e).put(i)}removeEntry(e,t,i){return bo(e).delete((function(a,l){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Dh(l),c[c.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.br(e,i))))}getEntry(e,t){let i=Ct.newInvalidDocument(t);return bo(e).ee({index:sh,range:IDBKeyRange.only(lc(t))},((r,a)=>{i=this.Sr(t,a)})).next((()=>i))}Dr(e,t){let i={size:0,document:Ct.newInvalidDocument(t)};return bo(e).ee({index:sh,range:IDBKeyRange.only(lc(t))},((r,a)=>{i={document:this.Sr(t,a),size:Vh(a)}})).next((()=>i))}getEntries(e,t){let i=Hn();return this.Cr(e,t,((r,a)=>{const l=this.Sr(r,a);i=i.insert(r,l)})).next((()=>i))}vr(e,t){let i=Hn(),r=new pt(he.comparator);return this.Cr(e,t,((a,l)=>{const c=this.Sr(a,l);i=i.insert(a,c),r=r.insert(a,Vh(l))})).next((()=>({documents:i,Fr:r})))}Cr(e,t,i){if(t.isEmpty())return J.resolve();let r=new at(zI);t.forEach((f=>r=r.add(f)));const a=IDBKeyRange.bound(lc(r.first()),lc(r.last())),l=r.getIterator();let c=l.getNext();return bo(e).ee({index:sh,range:a},((f,p,_)=>{const T=he.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;c&&zI(c,T)<0;)i(c,null),c=l.getNext();c&&c.isEqual(T)&&(i(c,p),c=l.hasNext()?l.getNext():null),c?_.j(lc(c)):_.done()})).next((()=>{for(;c;)i(c,null),c=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,a){const l=t.path,c=[l.popLast().toArray(),l.lastSegment(),Dh(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return bo(e).H(IDBKeyRange.bound(c,f,!0)).next((p=>{a==null||a.incrementDocumentReadCount(p.length);let _=Hn();for(const T of p){const E=this.Sr(he.fromSegments(T.prefixPath.concat(T.collectionGroup,T.documentId)),T);E.isFoundDocument()&&(Wc(t,E)||r.has(E.key))&&(_=_.insert(E.key,E))}return _}))}getAllFromCollectionGroup(e,t,i,r){let a=Hn();const l=qI(t,i),c=qI(t,Jn.max());return bo(e).ee({index:hb,range:IDBKeyRange.bound(l,c,!0)},((f,p,_)=>{const T=this.Sr(he.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(T.key,T),a.size===r&&_.done()})).next((()=>a))}newChangeBuffer(e){return new d3(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return GI(e).get(Ty).next((t=>(Ae(!!t,20021),t)))}br(e,t){return GI(e).put(Ty,t)}Sr(e,t){if(t){const i=j5(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(we.min())))return i}return Ct.newInvalidDocument(e)}}function NR(n){return new c3(n)}class d3 extends xR{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new qs((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new at(((a,l)=>xe(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const c=this.Or.get(a);if(t.push(this.Mr.removeEntry(e,a,c.readTime)),l.isValidDocument()){const f=II(this.Mr.serializer,l);r=r.add(a.path.popLast());const p=Vh(f);i+=p-c.size,t.push(this.Mr.addEntry(e,a,f))}else if(i-=c.size,this.trackRemovals){const f=II(this.Mr.serializer,l.convertToNoDocument(we.min()));t.push(this.Mr.addEntry(e,a,f))}})),r.forEach((a=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Mr.updateMetadata(e,i)),J.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((i=>(this.Or.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:i,Fr:r})=>(r.forEach(((a,l)=>{this.Or.set(a,{size:l,readTime:i.get(a).readTime})})),i)))}}function GI(n){return Qt(n,kc)}function bo(n){return Qt(n,wh)}function lc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function qI(n,e){const t=e.documentKey.path.toArray();return[n,Dh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function zI(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let a=0;a<t.length-2&&a<i.length-2;++a)if(r=xe(t[a],i[a]),r)return r;return r=xe(t.length,i.length),r||(r=xe(t[t.length-2],i[i.length-2]),r||xe(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&wc(i.mutation,r,li.empty(),rt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Oe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Oe()){const r=ns();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((a=>{let l=hc();return a.forEach(((c,f)=>{l=l.insert(c,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=ns();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Oe())))}populateOverlays(e,t,i){const r=[];return i.forEach((a=>{t.has(a)||r.push(a)})),this.documentOverlayCache.getOverlays(e,r).next((a=>{a.forEach(((l,c)=>{t.set(l,c)}))}))}computeViews(e,t,i,r){let a=Hn();const l=Ic(),c=(function(){return Ic()})();return t.forEach(((f,p)=>{const _=i.get(p.key);r.has(p.key)&&(_===void 0||_.mutation instanceof Kr)?a=a.insert(p.key,p):_!==void 0?(l.set(p.key,_.mutation.getFieldMask()),wc(_.mutation,p,_.mutation.getFieldMask(),rt.now())):l.set(p.key,li.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,_)=>l.set(p,_))),t.forEach(((p,_)=>c.set(p,new f3(_,l.get(p)??null)))),c)))}recalculateAndSaveOverlays(e,t){const i=Ic();let r=new pt(((l,c)=>l-c)),a=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const c of l)c.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let _=i.get(f)||li.empty();_=c.applyToLocalView(p,_),i.set(f,_);const T=(r.get(c.batchId)||Oe()).add(f);r=r.insert(c.batchId,T)}))})).next((()=>{const l=[],c=r.getReverseIterator();for(;c.hasNext();){const f=c.getNext(),p=f.key,_=f.value,T=Jb();_.forEach((E=>{if(!a.has(E)){const C=Zb(t.get(E),i.get(E));C!==null&&T.set(E,C),a=a.add(E)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,T))}return J.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return y5(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((a=>{const l=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-a.size):J.resolve(ns());let c=vl,f=a;return l.next((p=>J.forEach(p,((_,T)=>(c<T.largestBatchId&&(c=T.largestBatchId),a.get(_)?J.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{f=f.insert(_,E)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Oe()))).next((_=>({batchId:c,changes:Kb(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next((i=>{let r=hc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const a=t.collectionGroup;let l=hc();return this.indexManager.getCollectionParents(e,a).next((c=>J.forEach(c,(f=>{const p=(function(T,E){return new Hl(E,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next((_=>{_.forEach(((T,E)=>{l=l.insert(T,E)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,r)))).next((l=>{a.forEach(((f,p)=>{const _=p.getKey();l.get(_)===null&&(l=l.insert(_,Ct.newInvalidDocument(_)))}));let c=hc();return l.forEach(((f,p)=>{const _=a.get(f);_!==void 0&&wc(_.mutation,p,li.empty(),rt.now()),Wc(t,p)&&(c=c.insert(f,p))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return J.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Tn(r.createTime)}})(t)),J.resolve()}getNamedQuery(e,t){return J.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:vR(r.bundledQuery),readTime:Tn(r.readTime)}})(t)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(){this.overlays=new pt(he.comparator),this.Lr=new Map}getOverlay(e,t){return J.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ns();return J.forEach(t,(r=>this.getOverlay(e,r).next((a=>{a!==null&&i.set(r,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,a)=>{this.bt(e,t,a)})),J.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Lr.get(i);return r!==void 0&&(r.forEach((a=>this.overlays=this.overlays.remove(a))),this.Lr.delete(i)),J.resolve()}getOverlaysForCollection(e,t,i){const r=ns(),a=t.length+1,l=new he(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const f=c.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>i&&r.set(f.getKey(),f)}return J.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let a=new pt(((p,_)=>p-_));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=a.get(p.largestBatchId);_===null&&(_=ns(),a=a.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const c=ns(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>c.set(p,_))),!(c.size()>=r)););return J.resolve(c)}bt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const l=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new b_(t,i));let a=this.Lr.get(t);a===void 0&&(a=Oe(),this.Lr.set(t,a)),this.Lr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(){this.sessionToken=Pt.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(){this.kr=new at(Zt.Kr),this.qr=new at(Zt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Zt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Zt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new he(new et([])),i=new Zt(t,e),r=new Zt(t,e+1),a=[];return this.qr.forEachInRange([i,r],(l=>{this.Wr(l),a.push(l.key)})),a}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new he(new et([])),i=new Zt(t,e),r=new Zt(t,e+1);let a=Oe();return this.qr.forEachInRange([i,r],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Zt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Zt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return he.comparator(e.key,t.key)||xe(e.Hr,t.Hr)}static Ur(e,t){return xe(e.Hr,t.Hr)||he.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new at(Zt.Kr)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const a=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new w_(a,t,i,r);this.mutationQueue.push(l);for(const c of r)this.Jr=this.Jr.add(new Zt(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return J.resolve(l)}lookupMutationBatch(e,t){return J.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Xr(i),a=r<0?0:r;return J.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?Fo:this.Yn-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Zt(t,0),r=new Zt(t,Number.POSITIVE_INFINITY),a=[];return this.Jr.forEachInRange([i,r],(l=>{const c=this.Zr(l.Hr);a.push(c)})),J.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(xe);return t.forEach((r=>{const a=new Zt(r,0),l=new Zt(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([a,l],(c=>{i=i.add(c.Hr)}))})),J.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let a=i;he.isDocumentKey(a)||(a=a.child(""));const l=new Zt(new he(a),0);let c=new at(xe);return this.Jr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(c=c.add(f.Hr)),!0)}),l),J.resolve(this.Yr(c))}Yr(e){const t=[];return e.forEach((i=>{const r=this.Zr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ae(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return J.forEach(t.mutations,(r=>{const a=new Zt(r.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Zt(t,0),r=this.Jr.firstAfterOrEqual(i);return J.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3{constructor(e){this.ti=e,this.docs=(function(){return new pt(he.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),a=r?r.size:0,l=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return J.resolve(i?i.document.mutableCopy():Ct.newInvalidDocument(t))}getEntries(e,t){let i=Hn();return t.forEach((r=>{const a=this.docs.get(r);i=i.insert(r,a?a.document.mutableCopy():Ct.newInvalidDocument(r))})),J.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let a=Hn();const l=t.path,c=new he(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(c);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||f_(ab(_),i)<=0||(r.has(_.key)||Wc(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return J.resolve(a)}getAllFromCollectionGroup(e,t,i,r){_e(9500)}ni(e,t){return J.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new _3(this)}getSize(e){return J.resolve(this.size)}}class _3 extends xR{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)})),J.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e){this.persistence=e,this.ri=new qs((t=>Yo(t)),jc),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.ii=0,this.si=new D_,this.targetCount=0,this.oi=Xo._r()}forEachTarget(e,t){return this.ri.forEach(((i,r)=>t(r))),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),J.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Xo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,J.resolve()}updateTargetData(e,t){return this.lr(t),J.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,t,i){let r=0;const a=[];return this.ri.forEach(((l,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.ri.delete(l),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)})),J.waitFor(a).next((()=>r))}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return J.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),J.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((l=>{a.push(r.markPotentiallyOrphaned(e,l))})),J.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),J.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return J.resolve(i)}containsKey(e,t){return J.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,t){this._i={},this.overlays={},this.ai=new Mn(0),this.ui=!1,this.ui=!0,this.ci=new m3,this.referenceDelegate=e(this),this.li=new v3(this),this.indexManager=new s3,this.remoteDocumentCache=(function(r){return new y3(r)})((i=>this.referenceDelegate.hi(i))),this.serializer=new yR(t),this.Pi=new h3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new p3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new g3(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){le("MemoryPersistence","Starting transaction:",e);const r=new T3(this.ai.next());return this.referenceDelegate.Ti(),i(r).next((a=>this.referenceDelegate.Ii(r).next((()=>a)))).toPromise().then((a=>(r.raiseOnCommittedEvent(),a)))}Ei(e,t){return J.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class T3 extends ub{constructor(e){super(),this.currentSequenceNumber=e}}class hp{constructor(e){this.persistence=e,this.Ri=new D_,this.Ai=null}static Vi(e){return new hp(e)}get di(){if(this.Ai)return this.Ai;throw _e(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),J.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),J.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),J.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((r=>this.di.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((a=>this.di.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.di,(i=>{const r=he.fromPath(i);return this.mi(e,r).next((a=>{a||t.removeEntry(r,we.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return J.or([()=>J.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class kh{constructor(e,t){this.persistence=e,this.fi=new qs((i=>mn(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=RR(this,t)}static Vi(e,t){return new kh(e,t)}Ti(){}Ii(e){return J.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return J.forEach(this.fi,((i,r)=>this.wr(e,i,r).next((a=>a?J.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ni(e,(l=>this.wr(e,l,t).next((c=>{c||(i++,a.removeEntry(l,we.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),J.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),J.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),J.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),J.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=oh(e.data.value)),t}wr(e,t,i){return J.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.fi.get(t);return J.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(e){this.serializer=e}k(e,t,i,r){const a=new tp("createOrUpgrade",t);i<1&&r>=1&&((function(f){f.createObjectStore(Qc)})(e),(function(f){f.createObjectStore(Vc,{keyPath:PO}),f.createObjectStore(Ai,{keyPath:eI,autoIncrement:!0}).createIndex(Uo,tI,{unique:!0}),f.createObjectStore(Tl)})(e),HI(e),(function(f){f.createObjectStore(Do)})(e));let l=J.resolve();return i<3&&r>=3&&(i!==0&&((function(f){f.deleteObjectStore(Sl),f.deleteObjectStore(El),f.deleteObjectStore(Bo)})(e),HI(e)),l=l.next((()=>(function(f){const p=f.store(Bo),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:we.min().toTimestamp(),targetCount:0};return p.put(Ch,_)})(a)))),i<4&&r>=4&&(i!==0&&(l=l.next((()=>(function(f,p){return p.store(Ai).H().next((T=>{f.deleteObjectStore(Ai),f.createObjectStore(Ai,{keyPath:eI,autoIncrement:!0}).createIndex(Uo,tI,{unique:!0});const E=p.store(Ai),C=T.map((x=>E.put(x)));return J.waitFor(C)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Al,{keyPath:qO})})(e)}))),i<5&&r>=5&&(l=l.next((()=>this.gi(a)))),i<6&&r>=6&&(l=l.next((()=>((function(f){f.createObjectStore(kc)})(e),this.pi(a))))),i<7&&r>=7&&(l=l.next((()=>this.yi(a)))),i<8&&r>=8&&(l=l.next((()=>this.wi(e,a)))),i<9&&r>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(l=l.next((()=>this.bi(a)))),i<11&&r>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(ip,{keyPath:zO})})(e),(function(f){f.createObjectStore(sp,{keyPath:HO})})(e)}))),i<12&&r>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(rp,{keyPath:XO});p.createIndex(Sy,WO,{unique:!1}),p.createIndex(yb,ZO,{unique:!1})})(e)}))),i<13&&r>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(wh,{keyPath:kO});p.createIndex(sh,LO),p.createIndex(hb,UO)})(e))).next((()=>this.Si(e,a))).next((()=>e.deleteObjectStore(Do)))),i<14&&r>=14&&(l=l.next((()=>this.Di(e,a)))),i<15&&r>=15&&(l=l.next((()=>(function(f){f.createObjectStore(m_,{keyPath:KO,autoIncrement:!0}).createIndex(Ey,JO,{unique:!1}),f.createObjectStore(Tc,{keyPath:$O}).createIndex(mb,YO,{unique:!1}),f.createObjectStore(Ec,{keyPath:QO}).createIndex(gb,jO,{unique:!1})})(e)))),i<16&&r>=16&&(l=l.next((()=>{t.objectStore(Tc).clear()})).next((()=>{t.objectStore(Ec).clear()}))),i<17&&r>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(g_,{keyPath:e5})})(e)}))),i<18&&r>=18&&qC()&&(l=l.next((()=>{t.objectStore(Tc).clear()})).next((()=>{t.objectStore(Ec).clear()}))),l}pi(e){let t=0;return e.store(Do).ee(((i,r)=>{t+=Vh(r)})).next((()=>{const i={byteSize:t};return e.store(kc).put(Ty,i)}))}gi(e){const t=e.store(Vc),i=e.store(Ai);return t.H().next((r=>J.forEach(r,(a=>{const l=IDBKeyRange.bound([a.userId,Fo],[a.userId,a.lastAcknowledgedBatchId]);return i.H(Uo,l).next((c=>J.forEach(c,(f=>{Ae(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Vo(this.serializer,f);return AR(e,a.userId,p).next((()=>{}))}))))}))))}yi(e){const t=e.store(Sl),i=e.store(Do);return e.store(Bo).get(Ch).next((r=>{const a=[];return i.ee(((l,c)=>{const f=new et(l),p=(function(T){return[0,mn(T)]})(f);a.push(t.get(p).next((_=>_?J.resolve():(T=>t.put({targetId:0,path:mn(T),sequenceNumber:r.highestListenSequenceNumber}))(f))))})).next((()=>J.waitFor(a)))}))}wi(e,t){e.createObjectStore(Lc,{keyPath:GO});const i=t.store(Lc),r=new M_,a=l=>{if(r.add(l)){const c=l.lastSegment(),f=l.popLast();return i.put({collectionId:c,parent:mn(f)})}};return t.store(Do).ee({Y:!0},((l,c)=>{const f=new et(l);return a(f.popLast())})).next((()=>t.store(Tl).ee({Y:!0},(([l,c,f],p)=>{const _=ts(c);return a(_.popLast())}))))}bi(e){const t=e.store(El);return t.ee(((i,r)=>{const a=mc(r),l=_R(this.serializer,a);return t.put(l)}))}Si(e,t){const i=t.store(Do),r=[];return i.ee(((a,l)=>{const c=t.store(wh),f=(function(T){return T.document?new he(et.fromString(T.document.name).popFirst(5)):T.noDocument?he.fromSegments(T.noDocument.path):T.unknownDocument?he.fromSegments(T.unknownDocument.path):_e(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};r.push(c.put(p))})).next((()=>J.waitFor(r)))}Di(e,t){const i=t.store(Ai),r=NR(this.serializer),a=new P_(hp.Vi,this.serializer.yt);return i.H().next((l=>{const c=new Map;return l.forEach((f=>{let p=c.get(f.userId)??Oe();Vo(this.serializer,f).keys().forEach((_=>p=p.add(_))),c.set(f.userId,p)})),J.forEach(c,((f,p)=>{const _=new fn(p),T=dp.wt(this.serializer,_),E=a.getIndexManager(_),C=fp.wt(_,this.serializer,E,a.referenceDelegate);return new MR(r,C,T,E).recalculateAndSaveOverlaysForDocumentKeys(new Ay(t,Mn.ce),f).next()}))}))}}function HI(n){n.createObjectStore(Sl,{keyPath:FO}).createIndex(p_,BO,{unique:!0}),n.createObjectStore(El,{keyPath:"targetId"}).createIndex(pb,OO,{unique:!0}),n.createObjectStore(Bo)}const Ir="IndexedDbPersistence",Og=18e5,Fg=5e3,Bg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",S3="main";class V_{constructor(e,t,i,r,a,l,c,f,p,_,T=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Ci=a,this.window=l,this.document=c,this.Fi=p,this.Mi=_,this.xi=T,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=E=>Promise.resolve(),!V_.v())throw new ue(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new u3(this,r),this.Ki=t+S3,this.serializer=new yR(f),this.qi=new Lr(this.Ki,this.xi,new E3(this.serializer)),this.ci=new W5,this.li=new o3(this.referenceDelegate,this.serializer),this.remoteDocumentCache=NR(this.serializer),this.Pi=new X5,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,_===!1&&Mt(Ir,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ue(ie.FAILED_PRECONDITION,Bg);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new Mn(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>$f(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Hr(e))return le(Ir,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return le(Ir,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return uc(e).get($a).next((t=>J.resolve(this.Xi(t))))}Yi(e){return $f(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Og)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Qt(t,Al);return i.H().next((r=>{const a=this.ns(r,Og),l=r.filter((c=>a.indexOf(c)===-1));return J.forEach(l,(c=>i.delete(c.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?J.resolve(!0):uc(e).get($a).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Fg)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new ue(ie.FAILED_PRECONDITION,Bg);return!1}}return!(!this.networkEnabled||!this.inForeground)||$f(e).H().next((i=>this.ns(i,Fg).find((r=>{if(this.clientId!==r.clientId){const a=!this.networkEnabled&&r.networkEnabled,l=!this.inForeground&&r.inForeground,c=this.networkEnabled===r.networkEnabled;if(a||l&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&le(Ir,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Qc,Al],(e=>{const t=new Ay(e,Mn.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((i=>this.ts(i.updateTimeMs,t)&&!this.ss(i.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>$f(e).H().next((t=>this.ns(t,Og).map((i=>i.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return fp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new r3(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return dp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,i){le(Ir,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?i5:f===17?Eb:f===16?n5:f===15?y_:f===14?Tb:f===13?vb:f===12?t5:f===11?_b:void _e(60245)})(this.xi);let l;return this.qi.runTransaction(e,r,a,(c=>(l=new Ay(c,this.ai?this.ai.next():Mn.ce),t==="readwrite-primary"?this.ji(l).next((f=>!!f||this.Hi(l))).next((f=>{if(!f)throw Mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new ue(ie.FAILED_PRECONDITION,lb);return i(l)})).next((f=>this.Zi(l).next((()=>f)))):this.Ps(l).next((()=>i(l)))))).then((c=>(l.raiseOnCommittedEvent(),c)))}Ps(e){return uc(e).get($a).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Fg)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ue(ie.FAILED_PRECONDITION,Bg)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return uc(e).put($a,t)}static v(){return Lr.v()}Ji(e){const t=uc(e);return t.get($a).next((i=>this.Xi(i)?(le(Ir,"Releasing primary lease."),t.delete($a)):J.resolve()))}ts(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Mt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;GC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const i=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return le(Ir,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Mt(Ir,"Failed to get zombied client id.",i),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Mt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function uc(n){return Qt(n,Qc)}function $f(n){return Qt(n,Al)}function DR(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=Oe(),r=Oe();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new k_(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return GC()?8:cb(Yt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const a={result:null};return this.gs(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ps(e,t,r,i).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new A3;return this.ys(e,t,l).next((c=>{if(a.result=c,this.As)return this.ws(e,t,l,c.size)}))})).next((()=>a.result))}ws(e,t,i,r){return i.documentReadCount<this.Vs?(el()<=He.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",tl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),J.resolve()):(el()<=He.DEBUG&&le("QueryEngine","Query:",tl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(el()<=He.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",tl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kn(t))):J.resolve())}gs(e,t){if(pI(t))return J.resolve(null);let i=Kn(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=xh(t,null,"F"),i=Kn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const l=Oe(...a);return this.fs.getDocuments(e,l).next((c=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.bs(t,c);return this.Ss(t,p,l,f.readTime)?this.gs(e,xh(t,null,"F")):this.Ds(e,p,t,f)}))))})))))}ps(e,t,i,r){return pI(t)||r.isEqual(we.min())?J.resolve(null):this.fs.getDocuments(e,i).next((a=>{const l=this.bs(t,a);return this.Ss(t,l,i,r)?J.resolve(null):(el()<=He.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),tl(t)),this.Ds(e,l,t,ob(r,vl)).next((c=>c)))}))}bs(e,t){let i=new at(zb(e));return t.forEach(((r,a)=>{Wc(e,a)&&(i=i.add(a))})),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}ys(e,t,i){return el()<=He.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",tl(t)),this.fs.getDocumentsMatchingQuery(e,t,Jn.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="LocalStore",I3=3e8;class w3{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new pt(xe),this.Fs=new qs((a=>Yo(a)),jc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MR(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function VR(n,e,t,i){return new w3(n,e,t,i)}async function kR(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((a=>(r=a,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const l=[],c=[];let f=Oe();for(const p of r){l.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of a){c.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(i,f).next((p=>({Ns:p,removedBatchIds:l,addedBatchIds:c})))}))}))}function C3(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),a=t.xs.newChangeBuffer({trackRemovals:!0});return(function(c,f,p,_){const T=p.batch,E=T.keys();let C=J.resolve();return E.forEach((x=>{C=C.next((()=>_.getEntry(f,x))).next((P=>{const k=p.docVersions.get(x);Ae(k!==null,48541),P.version.compareTo(k)<0&&(T.applyToRemoteDocument(P,p),P.isValidDocument()&&(P.setReadTime(p.commitVersion),_.addEntry(P)))}))})),C.next((()=>c.mutationQueue.removeMutationBatch(f,T)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(c){let f=Oe();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(f=f.add(c.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function LR(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function b3(n,e){const t=Ee(n),i=e.snapshotVersion;let r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;const c=[];e.targetChanges.forEach(((_,T)=>{const E=r.get(T);if(!E)return;c.push(t.li.removeMatchingKeys(a,_.removedDocuments,T).next((()=>t.li.addMatchingKeys(a,_.addedDocuments,T))));let C=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(T)!==null?C=C.withResumeToken(Pt.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,i)),r=r.insert(T,C),(function(P,k,K){return P.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=I3?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(E,C,_)&&c.push(t.li.updateTargetData(a,C))}));let f=Hn(),p=Oe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),c.push(R3(a,l,e.documentUpdates).next((_=>{f=_.Bs,p=_.Ls}))),!i.isEqual(we.min())){const _=t.li.getLastRemoteSnapshotVersion(a).next((T=>t.li.setTargetsMetadata(a,a.currentSequenceNumber,i)));c.push(_)}return J.waitFor(c).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.vs=r,a)))}function R3(n,e,t){let i=Oe(),r=Oe();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let l=Hn();return t.forEach(((c,f)=>{const p=a.get(c);f.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(c)),f.isNoDocument()&&f.version.isEqual(we.min())?(e.removeEntry(c,f.readTime),l=l.insert(c,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(c,f)):le(L_,"Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",f.version)})),{Bs:l,Ls:r}}))}function x3(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Fo),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Lh(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.li.getTargetData(i,e).next((a=>a?(r=a,J.resolve(r)):t.li.allocateTargetId(i).next((l=>(r=new xs(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Dl(n,e,t){const i=Ee(n),r=i.vs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(l=>i.persistence.referenceDelegate.removeTarget(l,r)))}catch(l){if(!Hr(l))throw l;le(L_,`Failed to update sequence numbers for target ${e}: ${l}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function Oy(n,e,t){const i=Ee(n);let r=we.min(),a=Oe();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,_){const T=Ee(f),E=T.Fs.get(_);return E!==void 0?J.resolve(T.vs.get(E)):T.li.getTargetData(p,_)})(i,l,Kn(e)).next((c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(l,c.targetId).next((f=>{a=f}))})).next((()=>i.Cs.getDocumentsMatchingQuery(l,e,t?r:we.min(),t?a:Oe()))).next((c=>(FR(i,qb(e),c),{documents:c,ks:a})))))}function UR(n,e){const t=Ee(n),i=Ee(t.li),r=t.vs.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",(a=>i.At(a,e).next((l=>l?l.target:null))))}function OR(n,e){const t=Ee(n),i=t.Ms.get(e)||we.min();return t.persistence.runTransaction("Get new document changes","readonly",(r=>t.xs.getAllFromCollectionGroup(r,e,ob(i,vl),Number.MAX_SAFE_INTEGER))).then((r=>(FR(t,e,r),r)))}function FR(n,e,t){let i=n.Ms.get(e)||we.min();t.forEach(((r,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Ms.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR="firestore_clients";function KI(n,e){return`${BR}_${n}_${e}`}const GR="firestore_mutations";function JI(n,e,t){let i=`${GR}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const qR="firestore_targets";function Gg(n,e){return`${qR}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="SharedClientState";class Uh{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static $s(e,t,i){const r=JSON.parse(i);let a,l=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(a=new ue(r.error.code,r.error.message))),l?new Uh(e,t,r.state,a):(Mt(es,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cc{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static $s(e,t){const i=JSON.parse(t);let r,a=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(r=new ue(i.error.code,i.error.message))),a?new Cc(e,i.state,r):(Mt(es,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Oh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const i=JSON.parse(t);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,a=S_();for(let l=0;r&&l<i.activeTargetIds.length;++l)r=db(i.activeTargetIds[l]),a=a.add(i.activeTargetIds[l]);return r?new Oh(e,a):(Mt(es,`Failed to parse client data for instance '${e}': ${t}`),null)}}class U_{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new U_(t.clientId,t.onlineState):(Mt(es,`Failed to parse online state: ${e}`),null)}}class Fy{constructor(){this.activeTargetIds=S_()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qg{constructor(e,t,i,r,a){this.window=e,this.Ci=t,this.persistenceKey=i,this.zs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new pt(xe),this.started=!1,this.Zs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Xs=KI(this.persistenceKey,this.zs),this.Ys=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Fy),this.eo=new RegExp(`^${BR}_${l}_([^_]*)$`),this.no=new RegExp(`^${GR}_${l}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${qR}_${l}_(\\d+)$`),this.io=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.so=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const i of e){if(i===this.zs)continue;const r=this.getItem(KI(this.persistenceKey,i));if(r){const a=Oh.$s(i,r);a&&(this.Js=this.Js.insert(a.clientId,a))}}this.oo();const t=this.storage.getItem(this.io);if(t){const i=this._o(t);i&&this.ao(i)}for(const i of this.Zs)this.Hs(i);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,i){this.co(e,t,i),this.lo(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Gg(this.persistenceKey,e));if(r){const a=Cc.$s(e,r);a&&(i=a.state)}}return t&&this.ho.Qs(e),this.oo(),i}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Gg(this.persistenceKey,e))}updateQueryState(e,t,i){this.Po(e,t,i)}handleUserChange(e,t,i){t.forEach((r=>{this.lo(r)})),this.currentUser=e,i.forEach((r=>{this.addPendingMutation(r)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return le(es,"READ",e,t),t}setItem(e,t){le(es,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){le(es,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(le(es,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Mt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const i=this.Eo(t.key);return this.Ro(i,null)}{const i=this.Ao(t.key,t.newValue);if(i)return this.Ro(i.clientId,i)}}else if(this.no.test(t.key)){if(t.newValue!==null){const i=this.Vo(t.key,t.newValue);if(i)return this.mo(i)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(t.key===this.io){if(t.newValue!==null){const i=this._o(t.newValue);if(i)return this.ao(i)}}else if(t.key===this.Ys){const i=(function(a){let l=Mn.ce;if(a!=null)try{const c=JSON.parse(a);Ae(typeof c=="number",30636,{yo:a}),l=c}catch(c){Mt(es,"Failed to read sequence number from WebStorage",c)}return l})(t.newValue);i!==Mn.ce&&this.sequenceNumberHandler(i)}else if(t.key===this.so){const i=this.wo(t.newValue);await Promise.all(i.map((r=>this.syncEngine.bo(r))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,i){const r=new Uh(this.currentUser,e,t,i),a=JI(this.persistenceKey,this.currentUser,e);this.setItem(a,r.Ws())}lo(e){const t=JI(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,i){const r=Gg(this.persistenceKey,e),a=new Cc(e,t,i);this.setItem(r,a.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const i=this.Eo(e);return Oh.$s(i,t)}Vo(e,t){const i=this.no.exec(e),r=Number(i[1]),a=i[2]!==void 0?i[2]:null;return Uh.$s(new fn(a),r,t)}fo(e,t){const i=this.ro.exec(e),r=Number(i[1]);return Cc.$s(r,t)}_o(e){return U_.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);le(es,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const i=t?this.Js.insert(e,t):this.Js.remove(e),r=this.uo(this.Js),a=this.uo(i),l=[],c=[];return a.forEach((f=>{r.has(f)||l.push(f)})),r.forEach((f=>{a.has(f)||c.push(f)})),this.syncEngine.Co(l,c).then((()=>{this.Js=i}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=S_();return e.forEach(((i,r)=>{t=t.unionWith(r.activeTargetIds)})),t}}class zR{constructor(){this.vo=new Fy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Fy,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="ConnectivityMonitor";class YI{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){le($I,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){le($I,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yf=null;function By(){return Yf===null?Yf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Yf++,"0x"+Yf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="RestConnection",M3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class D3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===Iy?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,a){const l=By(),c=this.Qo(e,t.toUriEncodedString());le(zg,`Sending RPC '${e}' ${l}:`,c,i);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,r,a);const{host:p}=new URL(c),_=Gl(p);return this.zo(e,c,f,i,_).then((T=>(le(zg,`Received RPC '${e}' ${l}: `,T),T)),(T=>{throw yl(zg,`RPC '${e}' ${l} failed with error: `,T,"url: ",c,"request:",i),T}))}jo(e,t,i,r,a,l){return this.Wo(e,t,i,r,a)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,a)=>e[a]=r)),i&&i.headers.forEach(((r,a)=>e[a]=r))}Qo(e,t){const i=M3[e];let r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection",cc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(r){setTimeout((()=>{throw r}),0)}}))};class cl extends D3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!cl.c_){const e=eb();cc(e,ZC.STAT_EVENT,(t=>{t.stat===yy.PROXY?le(dn,"STAT_EVENT: detected buffering proxy"):t.stat===yy.NOPROXY&&le(dn,"STAT_EVENT: detected no buffering proxy")})),cl.c_=!0}}zo(e,t,i,r,a){const l=By();return new Promise(((c,f)=>{const p=new XC;p.setWithCredentials(!0),p.listenOnce(WC.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case th.NO_ERROR:const T=p.getResponseJson();le(dn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(T)),c(T);break;case th.TIMEOUT:le(dn,`RPC '${e}' ${l} timed out`),f(new ue(ie.DEADLINE_EXCEEDED,"Request time out"));break;case th.HTTP_ERROR:const E=p.getStatus();if(le(dn,`RPC '${e}' ${l} failed with status:`,E,"response text:",p.getResponseText()),E>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const x=C==null?void 0:C.error;if(x&&x.status&&x.message){const P=(function(K){const W=K.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(W)>=0?W:ie.UNKNOWN})(x.status);f(new ue(P,x.message))}else f(new ue(ie.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ue(ie.UNAVAILABLE,"Connection failed."));break;default:_e(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{le(dn,`RPC '${e}' ${l} completed.`)}}));const _=JSON.stringify(r);le(dn,`RPC '${e}' ${l} sending request:`,r),p.send(t,"POST",_,i,15)}))}T_(e,t,i){const r=By(),a=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(c.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const p=a.join("");le(dn,`Creating RPC '${e}' stream ${r}: ${p}`,c);const _=l.createWebChannel(p,c);this.I_(_);let T=!1,E=!1;const C=new P3({Ho:x=>{E?le(dn,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(T||(le(dn,`Opening RPC '${e}' stream ${r} transport.`),_.open(),T=!0),le(dn,`RPC '${e}' stream ${r} sending:`,x),_.send(x))},Jo:()=>_.close()});return cc(_,fc.EventType.OPEN,(()=>{E||(le(dn,`RPC '${e}' stream ${r} transport opened.`),C.i_())})),cc(_,fc.EventType.CLOSE,(()=>{E||(E=!0,le(dn,`RPC '${e}' stream ${r} transport closed`),C.o_(),this.E_(_))})),cc(_,fc.EventType.ERROR,(x=>{E||(E=!0,yl(dn,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),C.o_(new ue(ie.UNAVAILABLE,"The operation could not be completed")))})),cc(_,fc.EventType.MESSAGE,(x=>{var P;if(!E){const k=x.data[0];Ae(!!k,16349);const K=k,W=(K==null?void 0:K.error)||((P=K[0])==null?void 0:P.error);if(W){le(dn,`RPC '${e}' stream ${r} received error:`,W);const q=W.status;let ee=(function(N){const M=zt[N];if(M!==void 0)return nR(M)})(q),ae=W.message;q==="NOT_FOUND"&&ae.includes("database")&&ae.includes("does not exist")&&ae.includes(this.databaseId.database)&&yl(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),ee===void 0&&(ee=ie.INTERNAL,ae="Unknown error status: "+q+" with message "+W.message),E=!0,C.o_(new ue(ee,ae)),_.close()}else le(dn,`RPC '${e}' stream ${r} received:`,k),C.__(k)}})),cl.u_(),setTimeout((()=>{C.s_()}),0),C}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return tb()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(n){return new cl(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){return typeof window<"u"?window:null}function dh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(n){return new B5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cl.c_=!1;class KR{constructor(e,t,i=1e3,r=1.5,a=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=a,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&le("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="PersistentStream";class JR{constructor(e,t,i,r,a,l,c,f){this.Ci=e,this.b_=i,this.S_=r,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KR(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new ue(ie.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.H_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return le(QI,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(le(QI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class k3 extends JR{constructor(e,t,i,r,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=z5(this.serializer,e),i=(function(a){if(!("targetChange"in a))return we.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?we.min():l.readTime?Tn(l.readTime):we.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Py(this.serializer),t.addTarget=(function(a,l){let c;const f=l.target;if(c=bh(f)?{documents:cR(a,f)}:{query:dR(a,f).ft},c.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){c.resumeToken=rR(a,l.resumeToken);const p=My(a,l.expectedCount);p!==null&&(c.expectedCount=p)}else if(l.snapshotVersion.compareTo(we.min())>0){c.readTime=Ml(a,l.snapshotVersion.toTimestamp());const p=My(a,l.expectedCount);p!==null&&(c.expectedCount=p)}return c})(this.serializer,e);const i=K5(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Py(this.serializer),t.removeTarget=e,this.K_(t)}}class L3 extends JR{constructor(e,t,i,r,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,l),this.serializer=a}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ae(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ae(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ae(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=H5(e.writeResults,e.commitTime),i=Tn(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Py(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Mh(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{}class O3 extends U3{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ue(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(e,Dy(t,i),r,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ue(ie.UNKNOWN,a.toString())}))}jo(e,t,i,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.jo(e,Dy(t,i),r,l,c,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ue(ie.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function F3(n,e,t,i){return new O3(n,e,t,i)}class B3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mt(t),this.aa=!1):le("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo="RemoteStore";class G3{constructor(e,t,i,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=a,this.Aa.Mo((l=>{i.enqueueAndForget((async()=>{na(this)&&(le(Wo,"Restarting streams for network reachability change."),await(async function(f){const p=Ee(f);p.Ea.add(4),await td(p),p.Va.set("Unknown"),p.Ea.delete(4),await mp(p)})(this))}))})),this.Va=new B3(i,r)}}async function mp(n){if(na(n))for(const e of n.Ra)await e(!0)}async function td(n){for(const e of n.Ra)await e(!1)}function gp(n,e){const t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),B_(t)?F_(t):$l(t).O_()&&O_(t,e))}function Pl(n,e){const t=Ee(n),i=$l(t);t.Ia.delete(e),i.O_()&&$R(t,e),t.Ia.size===0&&(i.O_()?i.L_():na(t)&&t.Va.set("Unknown"))}function O_(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$l(n).Z_(e)}function $R(n,e){n.da.$e(e),$l(n).X_(e)}function F_(n){n.da=new L5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),$l(n).start(),n.Va.ua()}function B_(n){return na(n)&&!$l(n).x_()&&n.Ia.size>0}function na(n){return Ee(n).Ea.size===0}function YR(n){n.da=void 0}async function q3(n){n.Va.set("Online")}async function z3(n){n.Ia.forEach(((e,t)=>{O_(n,e)}))}async function H3(n,e){YR(n),B_(n)?(n.Va.ha(e),F_(n)):n.Va.set("Unknown")}async function K3(n,e,t){if(n.Va.set("Online"),e instanceof sR&&e.state===2&&e.cause)try{await(async function(r,a){const l=a.cause;for(const c of a.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,l),r.Ia.delete(c),r.da.removeTarget(c))})(n,e)}catch(i){le(Wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Fh(n,i)}else if(e instanceof uh?n.da.Xe(e):e instanceof iR?n.da.st(e):n.da.tt(e),!t.isEqual(we.min()))try{const i=await LR(n.localStore);t.compareTo(i)>=0&&await(function(a,l){const c=a.da.Tt(l);return c.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(p);_&&a.Ia.set(p,_.withResumeToken(f.resumeToken,l))}})),c.targetMismatches.forEach(((f,p)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(Pt.EMPTY_BYTE_STRING,_.snapshotVersion)),$R(a,f);const T=new xs(_.target,f,p,_.sequenceNumber);O_(a,T)})),a.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(i){le(Wo,"Failed to raise snapshot:",i),await Fh(n,i)}}async function Fh(n,e,t){if(!Hr(e))throw e;n.Ea.add(1),await td(n),n.Va.set("Offline"),t||(t=()=>LR(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{le(Wo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await mp(n)}))}function QR(n,e){return e().catch((t=>Fh(n,t,e)))}async function Jl(n){const e=Ee(n),t=Br(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fo;for(;J3(e);)try{const r=await x3(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,$3(e,r)}catch(r){await Fh(e,r)}jR(e)&&XR(e)}function J3(n){return na(n)&&n.Ta.length<10}function $3(n,e){n.Ta.push(e);const t=Br(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function jR(n){return na(n)&&!Br(n).x_()&&n.Ta.length>0}function XR(n){Br(n).start()}async function Y3(n){Br(n).ra()}async function Q3(n){const e=Br(n);for(const t of n.Ta)e.ea(t.mutations)}async function j3(n,e,t){const i=n.Ta.shift(),r=C_.from(i,e,t);await QR(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Jl(n)}async function X3(n,e){e&&Br(n).Y_&&await(async function(i,r){if((function(l){return P5(l)&&l!==ie.ABORTED})(r.code)){const a=i.Ta.shift();Br(i).B_(),await QR(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,r))),await Jl(i)}})(n,e),jR(n)&&XR(n)}async function jI(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),le(Wo,"RemoteStore received new credentials");const i=na(t);t.Ea.add(3),await td(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await mp(t)}async function Gy(n,e){const t=Ee(n);e?(t.Ea.delete(2),await mp(t)):e||(t.Ea.add(2),await td(t),t.Va.set("Unknown"))}function $l(n){return n.ma||(n.ma=(function(t,i,r){const a=Ee(t);return a.sa(),new k3(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(n.datastore,n.asyncQueue,{Zo:q3.bind(null,n),Yo:z3.bind(null,n),t_:H3.bind(null,n),J_:K3.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),B_(n)?F_(n):n.Va.set("Unknown")):(await n.ma.stop(),YR(n))}))),n.ma}function Br(n){return n.fa||(n.fa=(function(t,i,r){const a=Ee(t);return a.sa(),new L3(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Y3.bind(null,n),t_:X3.bind(null,n),ta:Q3.bind(null,n),na:j3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Jl(n)):(await n.fa.stop(),n.Ta.length>0&&(le(Wo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,t,i,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=a,this.deferred=new Ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,a){const l=Date.now()+i,c=new G_(e,t,l,r,a);return c.start(i),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function q_(n,e){if(Mt("AsyncQueue",`${e}: ${n}`),Hr(n))return new ue(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{static emptySet(e){return new dl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||he.comparator(t.key,i.key):(t,i)=>he.comparator(t.key,i.key),this.keyedMap=hc(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof dl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,a=i.getNext().key;if(!r.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new dl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(){this.ga=new pt(he.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_e(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Vl{constructor(e,t,i,r,a,l,c,f,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=c,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,r,a){const l=[];return t.forEach((c=>{l.push({type:0,doc:c})})),new Vl(e,t,dl.emptySet(t),l,i,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Z3{constructor(){this.queries=WI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Ee(t),a=r.queries;r.queries=WI(),a.forEach(((l,c)=>{for(const f of c.ba)f.onError(i)}))})(this,new ue(ie.ABORTED,"Firestore shutting down"))}}function WI(){return new qs((n=>Gb(n)),lp)}async function WR(n,e){const t=Ee(n);let i=3;const r=e.query;let a=t.queries.get(r);a?!a.Sa()&&e.Da()&&(i=2):(a=new W3,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(r,!0);break;case 1:a.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(l){const c=q_(l,`Initialization of query '${tl(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,a),a.ba.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&z_(t)}async function ZR(n,e){const t=Ee(n),i=e.query;let r=3;const a=t.queries.get(i);if(a){const l=a.ba.indexOf(e);l>=0&&(a.ba.splice(l,1),a.ba.length===0?r=e.Da()?0:1:!a.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function e6(n,e){const t=Ee(n);let i=!1;for(const r of e){const a=r.query,l=t.queries.get(a);if(l){for(const c of l.ba)c.Fa(r)&&(i=!0);l.wa=r}}i&&z_(t)}function t6(n,e,t){const i=Ee(n),r=i.queries.get(e);if(r)for(const a of r.ba)a.onError(t);i.queries.delete(e)}function z_(n){n.Ca.forEach((e=>{e.next()}))}var qy,ZI;(ZI=qy||(qy={})).Ma="default",ZI.Cache="cache";class ex{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Vl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e){this.key=e}}class nx{constructor(e){this.key=e}}class n6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Oe(),this.mutatedKeys=Oe(),this.eu=zb(e),this.tu=new dl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new XI,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=r,c=!1;const f=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((_,T)=>{const E=r.get(_),C=Wc(this.query,T)?T:null,x=!!E&&this.mutatedKeys.has(E.key),P=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let k=!1;E&&C?E.data.isEqual(C.data)?x!==P&&(i.track({type:3,doc:C}),k=!0):this.su(E,C)||(i.track({type:2,doc:C}),k=!0,(f&&this.eu(C,f)>0||p&&this.eu(C,p)<0)&&(c=!0)):!E&&C?(i.track({type:0,doc:C}),k=!0):E&&!C&&(i.track({type:1,doc:E}),k=!0,(f||p)&&(c=!0)),k&&(C?(l=l.add(C),a=P?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{tu:l,iu:i,Ss:c,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((_,T)=>(function(C,x){const P=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e(20277,{Vt:k})}};return P(C)-P(x)})(_.type,T.type)||this.eu(_.doc,T.doc))),this.ou(i),r=r??!1;const c=t&&!r?this._u():[],f=this.Ya.size===0&&this.current&&!r?1:0,p=f!==this.Xa;return this.Xa=f,l.length!==0||p?{snapshot:new Vl(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new XI,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Oe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new nx(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new tx(i))})),t}cu(e){this.Za=e.ks,this.Ya=Oe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Vl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Yl="SyncEngine";class i6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class s6{constructor(e){this.key=e,this.hu=!1}}class r6{constructor(e,t,i,r,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new qs((c=>Gb(c)),lp),this.Iu=new Map,this.Eu=new Set,this.Ru=new pt(he.comparator),this.Au=new Map,this.Vu=new D_,this.du={},this.mu=new Map,this.fu=Xo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function o6(n,e,t=!0){const i=yp(n);let r;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.lu()):r=await ix(i,e,t,!0),r}async function a6(n,e){const t=yp(n);await ix(t,e,!0,!1)}async function ix(n,e,t,i){const r=await Lh(n.localStore,Kn(e)),a=r.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let c;return i&&(c=await H_(n,e,a,l==="current",r.resumeToken)),n.isPrimaryClient&&t&&gp(n.remoteStore,r),c}async function H_(n,e,t,i,r){n.pu=(T,E,C)=>(async function(P,k,K,W){let q=k.view.ru(K);q.Ss&&(q=await Oy(P.localStore,k.query,!1).then((({documents:N})=>k.view.ru(N,q))));const ee=W&&W.targetChanges.get(k.targetId),ae=W&&W.targetMismatches.get(k.targetId)!=null,z=k.view.applyChanges(q,P.isPrimaryClient,ee,ae);return zy(P,k.targetId,z.au),z.snapshot})(n,T,E,C);const a=await Oy(n.localStore,e,!0),l=new n6(e,a.ks),c=l.ru(a.documents),f=ed.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),p=l.applyChanges(c,n.isPrimaryClient,f);zy(n,t,p.au);const _=new i6(e,t,l);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function l6(n,e,t){const i=Ee(n),r=i.Tu.get(e),a=i.Iu.get(r.targetId);if(a.length>1)return i.Iu.set(r.targetId,a.filter((l=>!lp(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Dl(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Pl(i.remoteStore,r.targetId),kl(i,r.targetId)})).catch(zr)):(kl(i,r.targetId),await Dl(i.localStore,r.targetId,!0))}async function u6(n,e){const t=Ee(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Pl(t.remoteStore,i.targetId))}async function c6(n,e,t){const i=Y_(n);try{const r=await(function(l,c){const f=Ee(l),p=rt.now(),_=c.reduce(((C,x)=>C.add(x.key)),Oe());let T,E;return f.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let x=Hn(),P=Oe();return f.xs.getEntries(C,_).next((k=>{x=k,x.forEach(((K,W)=>{W.isValidDocument()||(P=P.add(K))}))})).next((()=>f.localDocuments.getOverlayedDocuments(C,x))).next((k=>{T=k;const K=[];for(const W of c){const q=M5(W,T.get(W.key).overlayedDocument);q!=null&&K.push(new Kr(W.key,q,Mb(q.value.mapValue),Dn.exists(!0)))}return f.mutationQueue.addMutationBatch(C,p,K,c)})).next((k=>{E=k;const K=k.applyToLocalDocumentSet(T,P);return f.documentOverlayCache.saveOverlays(C,k.batchId,K)}))})).then((()=>({batchId:E.batchId,changes:Kb(T)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(l,c,f){let p=l.du[l.currentUser.toKey()];p||(p=new pt(xe)),p=p.insert(c,f),l.du[l.currentUser.toKey()]=p})(i,r.batchId,t),await Jr(i,r.changes),await Jl(i.remoteStore)}catch(r){const a=q_(r,"Failed to persist write");t.reject(a)}}async function sx(n,e){const t=Ee(n);try{const i=await b3(t.localStore,e);e.targetChanges.forEach(((r,a)=>{const l=t.Au.get(a);l&&(Ae(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?l.hu=!0:r.modifiedDocuments.size>0?Ae(l.hu,14607):r.removedDocuments.size>0&&(Ae(l.hu,42227),l.hu=!1))})),await Jr(t,i,e)}catch(i){await zr(i)}}function ew(n,e,t){const i=Ee(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((a,l)=>{const c=l.view.va(e);c.snapshot&&r.push(c.snapshot)})),(function(l,c){const f=Ee(l);f.onlineState=c;let p=!1;f.queries.forEach(((_,T)=>{for(const E of T.ba)E.va(c)&&(p=!0)})),p&&z_(f)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function d6(n,e,t){const i=Ee(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),a=r&&r.key;if(a){let l=new pt(he.comparator);l=l.insert(a,Ct.newNoDocument(a,we.min()));const c=Oe().add(a),f=new Zc(we.min(),new Map,new pt(xe),l,c);await sx(i,f),i.Ru=i.Ru.remove(a),i.Au.delete(e),$_(i)}else await Dl(i.localStore,e,!1).then((()=>kl(i,e,t))).catch(zr)}async function f6(n,e){const t=Ee(n),i=e.batch.batchId;try{const r=await C3(t.localStore,e);J_(t,i,null),K_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Jr(t,r)}catch(r){await zr(r)}}async function h6(n,e,t){const i=Ee(n);try{const r=await(function(l,c){const f=Ee(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,c).next((T=>(Ae(T!==null,37113),_=T.keys(),f.mutationQueue.removeMutationBatch(p,T)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,c))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);J_(i,e,t),K_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Jr(i,r)}catch(r){await zr(r)}}function K_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function J_(n,e,t){const i=Ee(n);let r=i.du[i.currentUser.toKey()];if(r){const a=r.get(e);a&&(t?a.reject(t):a.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function kl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||rx(n,i)}))}function rx(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(Pl(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),$_(n))}function zy(n,e,t){for(const i of t)i instanceof tx?(n.Vu.addReference(i.key,e),p6(n,i)):i instanceof nx?(le(Yl,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||rx(n,i.key)):_e(19791,{wu:i})}function p6(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(le(Yl,"New document in limbo: "+t),n.Eu.add(i),$_(n))}function $_(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new he(et.fromString(e)),i=n.fu.next();n.Au.set(i,new s6(t)),n.Ru=n.Ru.insert(t,i),gp(n.remoteStore,new xs(Kn(Xc(t.path)),i,"TargetPurposeLimboResolution",Mn.ce))}}async function Jr(n,e,t){const i=Ee(n),r=[],a=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((c,f)=>{l.push(i.pu(f,e,t).then((p=>{var _;if((p||t)&&i.isPrimaryClient){const T=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(f.targetId,T?"current":"not-current")}if(p){r.push(p);const T=k_.Es(f.targetId,p);a.push(T)}})))})),await Promise.all(l),i.Pu.J_(r),await(async function(f,p){const _=Ee(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>J.forEach(p,(E=>J.forEach(E.Ts,(C=>_.persistence.referenceDelegate.addReference(T,E.targetId,C))).next((()=>J.forEach(E.Is,(C=>_.persistence.referenceDelegate.removeReference(T,E.targetId,C)))))))))}catch(T){if(!Hr(T))throw T;le(L_,"Failed to update sequence numbers: "+T)}for(const T of p){const E=T.targetId;if(!T.fromCache){const C=_.vs.get(E),x=C.snapshotVersion,P=C.withLastLimboFreeSnapshotVersion(x);_.vs=_.vs.insert(E,P)}}})(i.localStore,a))}async function m6(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){le(Yl,"User change. New user:",e.toKey());const i=await kR(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((c=>{c.forEach((f=>{f.reject(new ue(ie.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Jr(t,i.Ns)}}function g6(n,e){const t=Ee(n),i=t.Au.get(e);if(i&&i.hu)return Oe().add(i.key);{let r=Oe();const a=t.Iu.get(e);if(!a)return r;for(const l of a){const c=t.Tu.get(l);r=r.unionWith(c.view.nu)}return r}}async function y6(n,e){const t=Ee(n),i=await Oy(t.localStore,e.query,!0),r=e.view.cu(i);return t.isPrimaryClient&&zy(t,e.targetId,r.au),r}async function _6(n,e){const t=Ee(n);return OR(t.localStore,e).then((i=>Jr(t,i)))}async function v6(n,e,t,i){const r=Ee(n),a=await(function(c,f){const p=Ee(c),_=Ee(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(T=>_.Xn(T,f).next((E=>E?p.localDocuments.getDocuments(T,E):J.resolve(null)))))})(r.localStore,e);a!==null?(t==="pending"?await Jl(r.remoteStore):t==="acknowledged"||t==="rejected"?(J_(r,e,i||null),K_(r,e),(function(c,f){Ee(Ee(c).mutationQueue).nr(f)})(r.localStore,e)):_e(6720,"Unknown batchState",{bu:t}),await Jr(r,a)):le(Yl,"Cannot apply mutation batch with id: "+e)}async function T6(n,e){const t=Ee(n);if(yp(t),Y_(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),r=await tw(t,i.toArray());t.gu=!0,await Gy(t.remoteStore,!0);for(const a of r)gp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const i=[];let r=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):r=r.then((()=>(kl(t,l),Dl(t.localStore,l,!0)))),Pl(t.remoteStore,l)})),await r,await tw(t,i),(function(l){const c=Ee(l);c.Au.forEach(((f,p)=>{Pl(c.remoteStore,p)})),c.Vu.zr(),c.Au=new Map,c.Ru=new pt(he.comparator)})(t),t.gu=!1,await Gy(t.remoteStore,!1)}}async function tw(n,e,t){const i=Ee(n),r=[],a=[];for(const l of e){let c;const f=i.Iu.get(l);if(f&&f.length!==0){c=await Lh(i.localStore,Kn(f[0]));for(const p of f){const _=i.Tu.get(p),T=await y6(i,_);T.snapshot&&a.push(T.snapshot)}}else{const p=await UR(i.localStore,l);c=await Lh(i.localStore,p),await H_(i,ox(p),l,!1,c.resumeToken)}r.push(c)}return i.Pu.J_(a),r}function ox(n){return Fb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function E6(n){return(function(t){return Ee(Ee(t).persistence).hs()})(Ee(n).localStore)}async function S6(n,e,t,i){const r=Ee(n);if(r.gu)return void le(Yl,"Ignoring unexpected query state notification.");const a=r.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await OR(r.localStore,qb(a[0])),c=Zc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Pt.EMPTY_BYTE_STRING);await Jr(r,l,c);break}case"rejected":await Dl(r.localStore,e,!0),kl(r,e,i);break;default:_e(64155,t)}}async function A6(n,e,t){const i=yp(n);if(i.gu){for(const r of e){if(i.Iu.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){le(Yl,"Adding an already active target "+r);continue}const a=await UR(i.localStore,r),l=await Lh(i.localStore,a);await H_(i,ox(a),l.targetId,!1,l.resumeToken),gp(i.remoteStore,l)}for(const r of t)i.Iu.has(r)&&await Dl(i.localStore,r,!1).then((()=>{Pl(i.remoteStore,r),kl(i,r)})).catch(zr)}}function yp(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=sx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=g6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=d6.bind(null,e),e.Pu.J_=e6.bind(null,e.eventManager),e.Pu.yu=t6.bind(null,e.eventManager),e}function Y_(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=h6.bind(null,e),e}class zc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return VR(this.persistence,new PR,e.initialUser,this.serializer)}Cu(e){return new P_(hp.Vi,this.serializer)}Du(e){return new zR}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zc.provider={build:()=>new zc};class I6 extends zc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ae(this.persistence.referenceDelegate instanceof kh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new bR(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new P_((i=>kh.Vi(i,t)),this.serializer)}}class ax extends zc{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Y_(this.xu.syncEngine),await Jl(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return VR(this.persistence,new PR,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new bR(i,e.asyncQueue,t)}Mu(e,t){const i=new MO(t,this.persistence);return new NO(e.asyncQueue,i)}Cu(e){const t=DR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new V_(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,HR(),dh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new zR}}class w6 extends ax{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof qg&&(this.sharedClientState.syncEngine={So:v6.bind(null,t),Do:S6.bind(null,t),Co:A6.bind(null,t),hs:E6.bind(null,t),bo:_6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async i=>{await T6(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=HR();if(!qg.v(t))throw new ue(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=DR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qg(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Hc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ew(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=m6.bind(null,this.syncEngine),await Gy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Z3})()}createDatastore(e){const t=pp(e.databaseInfo.databaseId),i=V3(e.databaseInfo);return F3(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,a,l,c){return new G3(i,r,a,l,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>ew(this.syncEngine,t,0)),(function(){return YI.v()?new YI:new N3})())}createSyncEngine(e,t){return(function(r,a,l,c,f,p,_){const T=new r6(r,a,l,c,f,p);return _&&(T.gu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const a=Ee(r);le(Wo,"RemoteStore shutting down."),a.Ea.add(5),await td(a),a.Aa.shutdown(),a.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Hc.provider={build:()=>new Hc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="FirestoreClient";class C6{constructor(e,t,i,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=fn.UNAUTHENTICATED,this.clientId=d_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async l=>{le(Gr,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(le(Gr,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=q_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Hg(n,e){n.asyncQueue.verifyOperationInProgress(),le(Gr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await kR(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function nw(n,e){n.asyncQueue.verifyOperationInProgress();const t=await b6(n);le(Gr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>jI(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>jI(e.remoteStore,r))),n._onlineComponents=e}async function b6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){le(Gr,"Using user provided OfflineComponentProvider");try{await Hg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ie.FAILED_PRECONDITION||r.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;yl("Error using user provided cache. Falling back to memory cache: "+t),await Hg(n,new zc)}}else le(Gr,"Using default OfflineComponentProvider"),await Hg(n,new I6(void 0));return n._offlineComponents}async function ux(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(le(Gr,"Using user provided OnlineComponentProvider"),await nw(n,n._uninitializedComponentsProvider._online)):(le(Gr,"Using default OnlineComponentProvider"),await nw(n,new Hc))),n._onlineComponents}function R6(n){return ux(n).then((e=>e.syncEngine))}async function Hy(n){const e=await ux(n),t=e.eventManager;return t.onListen=o6.bind(null,e.syncEngine),t.onUnlisten=l6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=a6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=u6.bind(null,e.syncEngine),t}function x6(n,e,t,i){const r=new lx(i),a=new ex(e,r,t);return n.asyncQueue.enqueueAndForget((async()=>WR(await Hy(n),a))),()=>{r.Nu(),n.asyncQueue.enqueueAndForget((async()=>ZR(await Hy(n),a)))}}function N6(n,e,t={}){const i=new Ds;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,c,f,p){const _=new lx({next:E=>{_.Nu(),l.enqueueAndForget((()=>ZR(a,T)));const C=E.docs.has(c);!C&&E.fromCache?p.reject(new ue(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&E.fromCache&&f&&f.source==="server"?p.reject(new ue(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),T=new ex(Xc(c.path),_,{includeMetadataChanges:!0,Ka:!0});return WR(a,T)})(await Hy(n),n.asyncQueue,e,t,i))),i.promise}function M6(n,e){const t=new Ds;return n.asyncQueue.enqueueAndForget((async()=>c6(await R6(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6="ComponentProvider",iw=new Map;function P6(n,e,t,i,r){return new r5(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,cx(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6="firestore.googleapis.com",sw=!0;class rw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ue(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=V6,this.ssl=sw}else this.host=e.host,this.ssl=e.ssl??sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=SR;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CR)throw new ue(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cx(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Q_{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new _O;switch(i.type){case"firstParty":return new EO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ue(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=iw.get(t);i&&(le(D6,"Removing Datastore"),iw.delete(t),i.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new $r(this.firestore,e,this._query)}}class Dt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dt(this.firestore,e,this._key)}toJSON(){return{type:Dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Yc(t,Dt._jsonSchema))return new Dt(e,i||null,new he(et.fromString(t.referencePath)))}}Dt._jsonSchemaVersion="firestore/documentReference/1.0",Dt._jsonSchema={type:Ht("string",Dt._jsonSchemaVersion),referencePath:Ht("string")};class Ur extends $r{constructor(e,t,i){super(e,t,Xc(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dt(this.firestore,null,new he(e))}withConverter(e){return new Ur(this.firestore,e,this._path)}}function Qf(n,e,...t){if(n=Sn(n),sb("collection","path",e),n instanceof Q_){const i=et.fromString(e,...t);return QA(i),new Ur(n,null,i)}{if(!(n instanceof Dt||n instanceof Ur))throw new ue(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(et.fromString(e,...t));return QA(i),new Ur(n.firestore,null,i)}}function al(n,e,...t){if(n=Sn(n),arguments.length===1&&(e=d_.newId()),sb("doc","path",e),n instanceof Q_){const i=et.fromString(e,...t);return YA(i),new Dt(n,null,new he(i))}{if(!(n instanceof Dt||n instanceof Ur))throw new ue(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(et.fromString(e,...t));return YA(i),new Dt(n.firestore,n instanceof Ur?n.converter:null,new he(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="AsyncQueue";class aw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KR(this,"async_queue_retry"),this._c=()=>{const i=dh();i&&le(ow,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=dh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=dh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ds;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Hr(e))throw e;le(ow,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Mt("INTERNAL UNHANDLED ERROR: ",lw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=G_.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(r),r}uc(){this.nc&&_e(47125,{Pc:lw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function lw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ll extends Q_{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new aw,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aw(e),this._firestoreClient=void 0,await e}}}function k6(n,e,t){const i=u_(n,"firestore");if(i.isInitialized(t)){const r=i.getImmediate({identifier:t}),a=i.getOptions(t);if(Ho(a,e))return r;throw new ue(ie.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ue(ie.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CR)throw new ue(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Gl(e.host)&&FC(e.host),i.initialize({options:e,instanceIdentifier:t})}function j_(n){if(n._terminated)throw new ue(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||L6(n),n._firestoreClient}function L6(n){var i,r,a,l;const e=n._freezeSettings(),t=P6(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(r=n._app)==null?void 0:r.options.apiKey,e);n._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new C6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const p=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(p),_online:p}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ai(Pt.fromBase64String(e))}catch(t){throw new ue(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ai(Pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ai._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yc(e,ai._jsonSchema))return ai.fromBase64String(e.bytes)}}ai._jsonSchemaVersion="firestore/bytes/1.0",ai._jsonSchema={type:Ht("string",ai._jsonSchemaVersion),bytes:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:is._jsonSchemaVersion}}static fromJSON(e){if(Yc(e,is._jsonSchema))return new is(e.latitude,e.longitude)}}is._jsonSchemaVersion="firestore/geoPoint/1.0",is._jsonSchema={type:Ht("string",is._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==r[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ri._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yc(e,Ri._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ri(e.vectorValues);throw new ue(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ri._jsonSchemaVersion="firestore/vectorValue/1.0",Ri._jsonSchema={type:Ht("string",Ri._jsonSchemaVersion),vectorValues:Ht("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=/^__.*__$/;class O6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Kl(e,this.data,t,this.fieldTransforms)}}function fx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e(40011,{dataSource:n})}}class W_{constructor(e,t,i,r,a,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,a===void 0&&this.validatePath(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new W_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Bh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(fx(this.dataSource)&&U6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class F6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||pp(e)}createContext(e,t,i,r=!1){return new W_({dataSource:e,methodName:t,targetDoc:i,path:St.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Z_(n){const e=n._freezeSettings(),t=pp(n._databaseId);return new F6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hx(n,e,t,i,r,a={}){const l=n.createContext(a.merge||a.mergeFields?2:0,e,t,r);gx("Data must be an object, but it was:",l,i);const c=px(i,l);let f,p;if(a.merge)f=new li(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const T of a.mergeFields){const E=_p(e,T,t);if(!l.contains(E))throw new ue(ie.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);z6(_,E)||_.push(E)}f=new li(_),p=l.fieldTransforms.filter((T=>f.covers(T.field)))}else f=null,p=l.fieldTransforms;return new O6(new Nn(c),f,p)}class ev extends X_{_toFieldTransform(e){return new Wb(e.path,new Rl)}isEqual(e){return e instanceof ev}}function B6(n,e,t,i=!1){return tv(t,n.createContext(i?4:3,e))}function tv(n,e){if(mx(n=Sn(n)))return gx("Unsupported field value:",e,n),px(n,e);if(n instanceof X_)return(function(i,r){if(!fx(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(r);a&&r.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){const a=[];let l=0;for(const c of i){let f=tv(c,r.childContextForArray(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(i,r){if((i=Sn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return w5(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=rt.fromDate(i);return{timestampValue:Ml(r.serializer,a)}}if(i instanceof rt){const a=new rt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ml(r.serializer,a)}}if(i instanceof is)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ai)return{bytesValue:rR(r.serializer,i._byteString)};if(i instanceof Dt){const a=r.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw r.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:x_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ri)return(function(l,c){const f=l instanceof Ri?l.toArray():l;return{mapValue:{fields:{[v_]:{stringValue:T_},[Il]:{arrayValue:{values:f.map((_=>{if(typeof _!="number")throw c.createError("VectorValues must only contain numeric values.");return A_(c.serializer,_)}))}}}}}})(i,r);if(gR(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${ep(i)}`)})(n,e)}function px(n,e){const t={};return Sb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(n,((i,r)=>{const a=tv(r,e.childContextForField(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function mx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof rt||n instanceof is||n instanceof ai||n instanceof Dt||n instanceof X_||n instanceof Ri||gR(n))}function gx(n,e,t){if(!mx(t)||!rb(t)){const i=ep(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function _p(n,e,t){if((e=Sn(e))instanceof dx)return e._internalPath;if(typeof e=="string")return q6(n,e);throw Bh("Field path arguments must be of type string or ",n,!1,void 0,t)}const G6=new RegExp("[~\\*/\\[\\]]");function q6(n,e,t){if(e.search(G6)>=0)throw Bh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new dx(...e.split("."))._internalPath}catch{throw Bh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Bh(n,e,t,i,r){const a=i&&!i.isEmpty(),l=r!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${i}`),l&&(f+=` in document ${r}`),f+=")"),new ue(ie.INVALID_ARGUMENT,c+n+f)}function z6(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{convertValue(e,t="none"){switch(Or(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ta(e,((r,a)=>{i[r]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,r,a;const t=(a=(r=(i=e.fields)==null?void 0:i[Il].arrayValue)==null?void 0:r.values)==null?void 0:a.map((l=>Et(l.doubleValue)));return new Ri(t)}convertGeoPoint(e){return new is(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=op(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Uc(e));default:return null}}convertTimestamp(e){const t=ks(e);return new rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=et.fromString(e);Ae(mR(i),9688,{name:e});const r=new $o(i.get(1),i.get(3)),a=new he(i.popFirst(5));return r.isEqual(t)||Mt(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx extends H6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ai(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Dt(this.firestore,null,t)}}function K6(){return new ev("serverTimestamp")}const uw="@firebase/firestore",cw="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const a of i)if(a in r&&typeof r[a]=="function")return!0;return!1})(n,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,t,i,r,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new J6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(_p("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class J6 extends _x{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nv{}class iv extends nv{}function Kg(n,e,...t){let i=[];e instanceof nv&&i.push(e),i=i.concat(t),(function(a){const l=a.filter((f=>f instanceof rv)).length,c=a.filter((f=>f instanceof sv)).length;if(l>1||l>0&&c>0)throw new ue(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class sv extends iv{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new sv(e,t,i)}_apply(e){const t=this._parse(e);return vx(e._query,t),new $r(e.firestore,e.converter,Ny(e._query,t))}_parse(e){const t=Z_(e.firestore);return(function(a,l,c,f,p,_,T){let E;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ue(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){hw(T,_);const x=[];for(const P of T)x.push(fw(f,a,P));E={arrayValue:{values:x}}}else E=fw(f,a,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||hw(T,_),E=B6(c,l,T,_==="in"||_==="not-in");return Ke.create(p,_,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class rv extends nv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new rv(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ot.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,a){let l=r;const c=a.getFlattenedFilters();for(const f of c)vx(l,f),l=Ny(l,f)})(e._query,t),new $r(e.firestore,e.converter,Ny(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ov extends iv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ov(e,t)}_apply(e){const t=(function(r,a,l){if(r.startAt!==null)throw new ue(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ue(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Gc(a,l)})(e._query,this._field,this._direction);return new $r(e.firestore,e.converter,v5(e._query,t))}}function Jg(n,e="asc"){const t=e,i=_p("orderBy",n);return ov._create(i,t)}class av extends iv{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new av(e,t,i)}_apply(e){return new $r(e.firestore,e.converter,xh(e._query,this._limit,this._limitType))}}function Y6(n){return av._create("limit",n,"F")}function fw(n,e,t){if(typeof(t=Sn(t))=="string"){if(t==="")throw new ue(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bb(e)&&t.indexOf("/")!==-1)throw new ue(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(et.fromString(t));if(!he.isDocumentKey(i))throw new ue(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Fc(n,new he(i))}if(t instanceof Dt)return Fc(n,t._key);throw new ue(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ep(t)}.`)}function hw(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vx(n,e){const t=(function(r,a){for(const l of r)for(const c of l.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ue(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Tx(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Q6{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=Z6(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function j6(n){return new Q6(n)}class X6{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Hc.provider,this._offlineComponentProvider={build:t=>new ax(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class W6{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Hc.provider,this._offlineComponentProvider={build:t=>new w6(t,e==null?void 0:e.cacheSizeBytes)}}}function Z6(n){return new X6(n==null?void 0:n.forceOwnership)}function eF(){return new W6}class gc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qo extends _x{constructor(e,t,i,r,a,l){super(e,t,i,r,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new fh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_p("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=qo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",qo._jsonSchema={type:Ht("string",qo._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class fh extends qo{data(e={}){return super.data(e)}}class fl{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new gc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new fh(this._firestore,this._userDataWriter,i.key,i,new gc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,a){if(r._snapshot.oldDocs.isEmpty()){let l=0;return r._snapshot.docChanges.map((c=>{const f=new fh(r._firestore,r._userDataWriter,c.doc.key,c.doc,new gc(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((c=>a||c.type!==3)).map((c=>{const f=new fh(r._firestore,r._userDataWriter,c.doc.key,c.doc,new gc(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,_=-1;return c.type!==0&&(p=l.indexOf(c.doc.key),l=l.delete(c.doc.key)),c.type!==1&&(l=l.add(c.doc),_=l.indexOf(c.doc.key)),{type:tF(c.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ue(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=d_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),r.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function tF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fl._jsonSchemaVersion="firestore/querySnapshot/1.0",fl._jsonSchema={type:Ht("string",fl._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(n){n=kr(n,Dt);const e=kr(n.firestore,Ll),t=j_(e);return N6(t,n._key).then((i=>Sx(e,n,i)))}function jf(n,e,t){n=kr(n,Dt);const i=kr(n.firestore,Ll),r=Tx(n.converter,e,t),a=Z_(i);return Ex(i,[hx(a,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Dn.none())])}function iF(n,e){const t=kr(n.firestore,Ll),i=al(n),r=Tx(n.converter,e),a=Z_(n.firestore);return Ex(t,[hx(a,"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Dn.exists(!1))]).then((()=>i))}function $g(n,...e){var p,_,T;n=Sn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||dw(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(dw(e[i])){const E=e[i];e[i]=(p=E.next)==null?void 0:p.bind(E),e[i+1]=(_=E.error)==null?void 0:_.bind(E),e[i+2]=(T=E.complete)==null?void 0:T.bind(E)}let a,l,c;if(n instanceof Dt)l=kr(n.firestore,Ll),c=Xc(n._key.path),a={next:E=>{e[i]&&e[i](Sx(l,n,E))},error:e[i+1],complete:e[i+2]};else{const E=kr(n,$r);l=kr(E.firestore,Ll),c=E._query;const C=new yx(l);a={next:x=>{e[i]&&e[i](new fl(l,C,E,x))},error:e[i+1],complete:e[i+2]},$6(n._query)}const f=j_(l);return x6(f,c,r,a)}function Ex(n,e){const t=j_(n);return M6(t,e)}function Sx(n,e,t){const i=t.docs.get(e._key),r=new yx(n);return new qo(n,r,e._key,i,new gc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){gO(ql),gl(new Ko("firestore",((i,{instanceIdentifier:r,options:a})=>{const l=i.getProvider("app").getImmediate(),c=new Ll(new vO(i.getProvider("auth-internal")),new SO(l,i.getProvider("app-check-internal")),o5(l,r),l);return a={useFetchStreams:t,...a},c._setSettings(a),c}),"PUBLIC").setMultipleInstances(!0)),Pr(uw,cw,e),Pr(uw,cw,"esm2020")})();function Ax(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sF=Ax,Ix=new Jc("auth","Firebase",Ax());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gh=new a_("@firebase/auth");function rF(n,...e){Gh.logLevel<=He.WARN&&Gh.warn(`Auth (${ql}): ${n}`,...e)}function hh(n,...e){Gh.logLevel<=He.ERROR&&Gh.error(`Auth (${ql}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(n,...e){throw uv(n,...e)}function xi(n,...e){return uv(n,...e)}function lv(n,e,t){const i={...sF(),[e]:t};return new Jc("auth","Firebase",i).create(e,{appName:n.name})}function zo(n){return lv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oF(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&os(n,"argument-error"),lv(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function uv(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Ix.create(n,...e)}function be(n,e,...t){if(!n)throw uv(e,...t)}function Ns(n){const e="INTERNAL ASSERTION FAILED: "+n;throw hh(e),new Error(e)}function Us(n,e){n||Ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function aF(){return pw()==="http:"||pw()==="https:"}function pw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aF()||YU()||"connection"in navigator)?navigator.onLine:!0}function uF(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Us(t>e,"Short delay should be less than long delay!"),this.isMobile=JU()||QU()}get(){return lF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(n,e){Us(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fF=new nd(3e4,6e4);function dv(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ql(n,e,t,i,r={}){return Cx(n,r,async()=>{let a={},l={};i&&(e==="GET"?l=i:a={body:JSON.stringify(i)});const c=$c({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return $U()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Gl(n.emulatorConfig.host)&&(p.credentials="include"),wx.fetch()(await bx(n,n.config.apiHost,t,c),p)})}async function Cx(n,e,t){n._canInitEmulator=!1;const i={...cF,...e};try{const r=new pF(n),a=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Xf(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const c=a.ok?l.errorMessage:l.error.message,[f,p]=c.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xf(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Xf(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw Xf(n,"user-disabled",l);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw lv(n,_,p);os(n,_)}}catch(r){if(r instanceof Gs)throw r;os(n,"network-request-failed",{message:String(r)})}}async function hF(n,e,t,i,r={}){const a=await Ql(n,e,t,i,r);return"mfaPendingCredential"in a&&os(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function bx(n,e,t,i){const r=`${e}${t}?${i}`,a=n,l=a.config.emulator?cv(n.config,r):`${n.config.apiScheme}://${r}`;return dF.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class pF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(xi(this.auth,"network-request-failed")),fF.get())})}}function Xf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=xi(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(n,e){return Ql(n,"POST","/v1/accounts:delete",e)}async function qh(n,e){return Ql(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gF(n,e=!1){const t=Sn(n),i=await t.getIdToken(e),r=fv(i);be(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const a=typeof r.firebase=="object"?r.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:r,token:i,authTime:bc(Yg(r.auth_time)),issuedAtTime:bc(Yg(r.iat)),expirationTime:bc(Yg(r.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Yg(n){return Number(n)*1e3}function fv(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return hh("JWT malformed, contained fewer than 3 sections"),null;try{const r=kC(t);return r?JSON.parse(r):(hh("Failed to decode base64 JWT payload"),null)}catch(r){return hh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function mw(n){const e=fv(n);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Gs&&yF(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function yF({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bc(this.lastLoginAt),this.creationTime=bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zh(n){var T;const e=n.auth,t=await n.getIdToken(),i=await Kc(n,qh(e,{idToken:t}));be(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const a=(T=r.providerUserInfo)!=null&&T.length?Rx(r.providerUserInfo):[],l=TF(n.providerData,a),c=n.isAnonymous,f=!(n.email&&r.passwordHash)&&!(l!=null&&l.length),p=c?f:!1,_={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new Jy(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function vF(n){const e=Sn(n);await zh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function TF(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function Rx(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EF(n,e){const t=await Cx(n,{},async()=>{const i=$c({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:a}=n.config,l=await bx(n,r,"/v1/token",`key=${a}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:c,body:i};return n.emulatorConfig&&Gl(n.emulatorConfig.host)&&(f.credentials="include"),wx.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function SF(n,e){return Ql(n,"POST","/v2/accounts:revokeToken",dv(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):mw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){be(e.length!==0,"internal-error");const t=mw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:a}=await EF(e,t);this.updateTokensAndExpiration(i,r,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:a}=t,l=new hl;return i&&(be(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),r&&(be(typeof r=="string","internal-error",{appName:e}),l.accessToken=r),a&&(be(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hl,this.toJSON())}_performRefresh(){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(n,e){be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wi{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new _F(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Jy(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Kc(this,this.stsTokenManager.getToken(this.auth,e));return be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return gF(this,e)}reload(){return vF(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await zh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ii(this.auth.app))return Promise.reject(zo(this.auth));const e=await this.getIdToken();return await Kc(this,mF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:T,emailVerified:E,isAnonymous:C,providerData:x,stsTokenManager:P}=t;be(T&&P,e,"internal-error");const k=hl.fromJSON(this.name,P);be(typeof T=="string",e,"internal-error"),wr(i,e.name),wr(r,e.name),be(typeof E=="boolean",e,"internal-error"),be(typeof C=="boolean",e,"internal-error"),wr(a,e.name),wr(l,e.name),wr(c,e.name),wr(f,e.name),wr(p,e.name),wr(_,e.name);const K=new wi({uid:T,auth:e,email:r,emailVerified:E,displayName:i,isAnonymous:C,photoURL:l,phoneNumber:a,tenantId:c,stsTokenManager:k,createdAt:p,lastLoginAt:_});return x&&Array.isArray(x)&&(K.providerData=x.map(W=>({...W}))),f&&(K._redirectEventId=f),K}static async _fromIdTokenResponse(e,t,i=!1){const r=new hl;r.updateFromServerResponse(t);const a=new wi({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await zh(a),a}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];be(r.localId!==void 0,"internal-error");const a=r.providerUserInfo!==void 0?Rx(r.providerUserInfo):[],l=!(r.email&&r.passwordHash)&&!(a!=null&&a.length),c=new hl;c.updateFromIdToken(i);const f=new wi({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:l}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Jy(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw=new Map;function Ms(n){Us(n instanceof Function,"Expected a class definition");let e=gw.get(n);return e?(Us(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,gw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}xx.type="NONE";const yw=xx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ph(n,e,t){return`firebase:${n}:${e}:${t}`}class pl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:a}=this.auth;this.fullUserKey=ph(this.userKey,r.apiKey,a),this.fullPersistenceKey=ph("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await qh(this.auth,{idToken:e}).catch(()=>{});return t?wi._fromGetAccountInfoResponse(this.auth,t,e):null}return wi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new pl(Ms(yw),e,i);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=r[0]||Ms(yw);const l=ph(i,e.config.apiKey,e.name);let c=null;for(const p of t)try{const _=await p._get(l);if(_){let T;if(typeof _=="string"){const E=await qh(e,{idToken:_}).catch(()=>{});if(!E)break;T=await wi._fromGetAccountInfoResponse(e,E,_)}else T=wi._fromJSON(e,_);p!==a&&(c=T),a=p;break}}catch{}const f=r.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new pl(a,e,i):(a=f[0],c&&await a._set(l,c.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new pl(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Px(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Nx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kx(e))return"Blackberry";if(Lx(e))return"Webos";if(Mx(e))return"Safari";if((e.includes("chrome/")||Dx(e))&&!e.includes("edge/"))return"Chrome";if(Vx(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Nx(n=Yt()){return/firefox\//i.test(n)}function Mx(n=Yt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dx(n=Yt()){return/crios\//i.test(n)}function Px(n=Yt()){return/iemobile/i.test(n)}function Vx(n=Yt()){return/android/i.test(n)}function kx(n=Yt()){return/blackberry/i.test(n)}function Lx(n=Yt()){return/webos/i.test(n)}function hv(n=Yt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function AF(n=Yt()){var e;return hv(n)&&!!((e=window.navigator)!=null&&e.standalone)}function IF(){return jU()&&document.documentMode===10}function Ux(n=Yt()){return hv(n)||Vx(n)||Lx(n)||kx(n)||/windows phone/i.test(n)||Px(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(n,e=[]){let t;switch(n){case"Browser":t=_w(Yt());break;case"Worker":t=`${_w(Yt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ql}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((l,c)=>{try{const f=e(a);l(f)}catch(f){c(f)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CF(n,e={}){return Ql(n,"GET","/v2/passwordPolicy",dv(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF=6;class RF{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??bF,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vw(this),this.idTokenSubscription=new vw(this),this.beforeStateQueue=new wF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ix,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ms(t)),this._initializationPromise=this.queue(async()=>{var i,r,a;if(!this._deleted&&(this.persistenceManager=await pl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await qh(this,{idToken:e}),i=await wi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(Ii(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,c=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===c)&&(f!=null&&f.user)&&(i=f.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ii(this.app))return Promise.reject(zo(this));const t=e?Sn(e):null;return t&&be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ii(this.app)?Promise.reject(zo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ii(this.app)?Promise.reject(zo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ms(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CF(this),t=new RF(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await SF(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ms(e)||this._popupRedirectResolver;be(t,this,"argument-error"),this.redirectPersistenceManager=await pl.create(this,[Ms(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(c,this,"internal-error"),c.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,r);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ox(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Ii(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&rF(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function vp(n){return Sn(n)}class vw{constructor(e){this.auth=e,this.observer=null,this.addObserver=n4(t=>this.observer=t)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NF(n){pv=n}function MF(n){return pv.loadJS(n)}function DF(){return pv.gapiScript}function PF(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VF(n,e){const t=u_(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),a=t.getOptions();if(Ho(a,e??{}))return r;os(r,"already-initialized")}return t.initialize({options:e})}function kF(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ms);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function LF(n,e,t){const i=vp(n);be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,a=Fx(e),{host:l,port:c}=UF(e),f=c===null?"":`:${c}`,p={url:`${a}//${l}${f}/`},_=Object.freeze({host:l,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){be(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),be(Ho(p,i.config.emulator)&&Ho(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Gl(l)?(FC(`${a}//${l}${f}`),KU("Auth",!0)):OF()}function Fx(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function UF(n){const e=Fx(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const a=r[1];return{host:a,port:Tw(i.substr(a.length+1))}}else{const[a,l]=i.split(":");return{host:a,port:Tw(l)}}}function Tw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function OF(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ns("not implemented")}_getIdTokenResponse(e){return Ns("not implemented")}_linkToIdToken(e,t){return Ns("not implemented")}_getReauthenticationResolver(e){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ml(n,e){return hF(n,"POST","/v1/accounts:signInWithIdp",dv(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF="http://localhost";class Zo extends Bx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):os("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...a}=t;if(!i||!r)return null;const l=new Zo(i,r);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ml(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ml(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ml(e,t)}buildRequest(){const e={requestUri:FF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$c(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id extends mv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends id{constructor(){super("facebook.com")}static credential(e){return Zo._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.FACEBOOK_SIGN_IN_METHOD="facebook.com";br.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends id{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zo._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Rs.credential(t,i)}catch{return null}}}Rs.GOOGLE_SIGN_IN_METHOD="google.com";Rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends id{constructor(){super("github.com")}static credential(e){return Zo._fromParams({providerId:Rr.PROVIDER_ID,signInMethod:Rr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rr.credentialFromTaggedObject(e)}static credentialFromError(e){return Rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rr.credential(e.oauthAccessToken)}catch{return null}}}Rr.GITHUB_SIGN_IN_METHOD="github.com";Rr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends id{constructor(){super("twitter.com")}static credential(e,t){return Zo._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return xr.credential(t,i)}catch{return null}}}xr.TWITTER_SIGN_IN_METHOD="twitter.com";xr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const a=await wi._fromIdTokenResponse(e,i,r),l=Ew(i);return new Ul({user:a,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=Ew(i);return new Ul({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function Ew(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh extends Gs{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Hh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Hh(e,t,i,r)}}function Gx(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Hh._fromErrorAndOperation(n,a,e,i):a})}async function BF(n,e,t=!1){const i=await Kc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ul._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GF(n,e,t=!1){const{auth:i}=n;if(Ii(i.app))return Promise.reject(zo(i));const r="reauthenticate";try{const a=await Kc(n,Gx(i,r,e,n),t);be(a.idToken,i,"internal-error");const l=fv(a.idToken);be(l,i,"internal-error");const{sub:c}=l;return be(n.uid===c,i,"user-mismatch"),Ul._forOperation(n,r,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&os(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(n,e,t=!1){if(Ii(n.app))return Promise.reject(zo(n));const i="signIn",r=await Gx(n,i,e),a=await Ul._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(a.user),a}function zF(n,e,t,i){return Sn(n).onIdTokenChanged(e,t,i)}function HF(n,e,t){return Sn(n).beforeAuthStateChanged(e,t)}function KF(n,e,t,i){return Sn(n).onAuthStateChanged(e,t,i)}function JF(n){return Sn(n).signOut()}const Kh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Kh,"1"),this.storage.removeItem(Kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F=1e3,YF=10;class zx extends qx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ux(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,f)=>{this.notifyListeners(l,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},a=this.storage.getItem(i);IF()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,YF):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},$F)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}zx.type="LOCAL";const QF=zx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx extends qx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hx.type="SESSION";const Kx=Hx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Tp(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:a}=t.data,l=this.handlersMap[r];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const c=Array.from(l).map(async p=>p(t.origin,a)),f=await jF(c);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,l;return new Promise((c,f)=>{const p=gv("",20);r.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);l={messageChannel:r,onMessage(T){const E=T;if(E.data.eventId===p)switch(E.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(E.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),r.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(){return window}function WF(n){ss().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(){return typeof ss().WorkerGlobalScope<"u"&&typeof ss().importScripts=="function"}async function ZF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function eB(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function tB(){return Jx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="firebaseLocalStorageDb",nB=1,Jh="firebaseLocalStorage",Yx="fbase_key";class sd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ep(n,e){return n.transaction([Jh],e?"readwrite":"readonly").objectStore(Jh)}function iB(){const n=indexedDB.deleteDatabase($x);return new sd(n).toPromise()}function $y(){const n=indexedDB.open($x,nB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Jh,{keyPath:Yx})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Jh)?e(i):(i.close(),await iB(),e(await $y()))})})}async function Sw(n,e,t){const i=Ep(n,!0).put({[Yx]:e,value:t});return new sd(i).toPromise()}async function sB(n,e){const t=Ep(n,!1).get(e),i=await new sd(t).toPromise();return i===void 0?null:i.value}function Aw(n,e){const t=Ep(n,!0).delete(e);return new sd(t).toPromise()}const rB=800,oB=3;class Qx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $y(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>oB)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Jx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tp._getInstance(tB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await ZF(),!this.activeServiceWorker)return;this.sender=new XF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||eB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $y();return await Sw(e,Kh,"1"),await Aw(e,Kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Sw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>sB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Aw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const a=Ep(r,!1).getAll();return new sd(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:a}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Qx.type="LOCAL";const aB=Qx;new nd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(n,e){return e?Ms(e):(be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv extends Bx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ml(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ml(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ml(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lB(n){return qF(n.auth,new yv(n),n.bypassAuthState)}function uB(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),GF(t,new yv(n),n.bypassAuthState)}async function cB(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),BF(t,new yv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,t,i,r,a=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:a,error:l,type:c}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lB;case"linkViaPopup":case"linkViaRedirect":return cB;case"reauthViaPopup":case"reauthViaRedirect":return uB;default:os(this.auth,"internal-error")}}resolve(e){Us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB=new nd(2e3,1e4);async function fB(n,e,t){if(Ii(n.app))return Promise.reject(xi(n,"operation-not-supported-in-this-environment"));const i=vp(n);oF(n,e,mv);const r=jx(i,t);return new Oo(i,"signInViaPopup",e,r).executeNotNull()}class Oo extends Xx{constructor(e,t,i,r,a){super(e,t,r,a),this.provider=i,this.authWindow=null,this.pollId=null,Oo.currentPopupAction&&Oo.currentPopupAction.cancel(),Oo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){Us(this.filter.length===1,"Popup operations only handle one event");const e=gv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(xi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Oo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dB.get())};e()}}Oo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB="pendingRedirect",mh=new Map;class pB extends Xx{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=mh.get(this.auth._key());if(!e){try{const i=await mB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}mh.set(this.auth._key(),e)}return this.bypassAuthState||mh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mB(n,e){const t=_B(e),i=yB(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function gB(n,e){mh.set(n._key(),e)}function yB(n){return Ms(n._redirectPersistence)}function _B(n){return ph(hB,n.config.apiKey,n.name)}async function vB(n,e,t=!1){if(Ii(n.app))return Promise.reject(zo(n));const i=vp(n),r=jx(i,e),l=await new pB(i,r,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB=600*1e3;class EB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!SB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Wx(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(xi(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=TB&&this.cachedEventUids.clear(),this.cachedEventUids.has(Iw(e))}saveEventToCache(e){this.cachedEventUids.add(Iw(e)),this.lastProcessedEventTime=Date.now()}}function Iw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Wx({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function SB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wx(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(n,e={}){return Ql(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wB=/^https?/;async function CB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await AB(n);for(const t of e)try{if(bB(t))return}catch{}os(n,"unauthorized-domain")}function bB(n){const e=Ky(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!wB.test(t))return!1;if(IB.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RB=new nd(3e4,6e4);function ww(){const n=ss().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xB(n){return new Promise((e,t)=>{var r,a,l;function i(){ww(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ww(),t(xi(n,"network-request-failed"))},timeout:RB.get()})}if((a=(r=ss().gapi)==null?void 0:r.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=ss().gapi)!=null&&l.load)i();else{const c=PF("iframefcb");return ss()[c]=()=>{gapi.load?i():t(xi(n,"network-request-failed"))},MF(`${DF()}?onload=${c}`).catch(f=>t(f))}}).catch(e=>{throw gh=null,e})}let gh=null;function NB(n){return gh=gh||xB(n),gh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB=new nd(5e3,15e3),DB="__/auth/iframe",PB="emulator/auth/iframe",VB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function LB(n){const e=n.config;be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?cv(e,PB):`https://${n.config.authDomain}/${DB}`,i={apiKey:e.apiKey,appName:n.name,v:ql},r=kB.get(n.config.apiHost);r&&(i.eid=r);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${$c(i).slice(1)}`}async function UB(n){const e=await NB(n),t=ss().gapi;return be(t,n,"internal-error"),e.open({where:document.body,url:LB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VB,dontclear:!0},i=>new Promise(async(r,a)=>{await i.restyle({setHideOnLeave:!1});const l=xi(n,"network-request-failed"),c=ss().setTimeout(()=>{a(l)},MB.get());function f(){ss().clearTimeout(c),r(i)}i.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FB=500,BB=600,GB="_blank",qB="http://localhost";class Cw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zB(n,e,t,i=FB,r=BB){const a=Math.max((window.screen.availHeight-r)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const f={...OB,width:i.toString(),height:r.toString(),top:a,left:l},p=Yt().toLowerCase();t&&(c=Dx(p)?GB:t),Nx(p)&&(e=e||qB,f.scrollbars="yes");const _=Object.entries(f).reduce((E,[C,x])=>`${E}${C}=${x},`,"");if(AF(p)&&c!=="_self")return HB(e||"",c),new Cw(null);const T=window.open(e||"",c,_);be(T,n,"popup-blocked");try{T.focus()}catch{}return new Cw(T)}function HB(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB="__/auth/handler",JB="emulator/auth/handler",$B=encodeURIComponent("fac");async function bw(n,e,t,i,r,a){be(n.config.authDomain,n,"auth-domain-config-required"),be(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ql,eventId:r};if(e instanceof mv){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",t4(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries({}))l[_]=T}if(e instanceof id){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(l.scopes=_.join(","))}n.tenantId&&(l.tid=n.tenantId);const c=l;for(const _ of Object.keys(c))c[_]===void 0&&delete c[_];const f=await n._getAppCheckToken(),p=f?`#${$B}=${encodeURIComponent(f)}`:"";return`${YB(n)}?${$c(c).slice(1)}${p}`}function YB({config:n}){return n.emulator?cv(n,JB):`https://${n.authDomain}/${KB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="webStorageSupport";class QB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kx,this._completeRedirectFn=vB,this._overrideRedirectResult=gB}async _openPopup(e,t,i,r){var l;Us((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await bw(e,t,i,Ky(),r);return zB(e,a,gv())}async _openRedirect(e,t,i,r){await this._originValidation(e);const a=await bw(e,t,i,Ky(),r);return WF(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:a}=this.eventManagers[t];return r?Promise.resolve(r):(Us(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await UB(e),i=new EB(e);return t.register("authEvent",r=>(be(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qg,{type:Qg},r=>{var l;const a=(l=r==null?void 0:r[0])==null?void 0:l[Qg];a!==void 0&&t(!!a),os(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=CB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ux()||Mx()||hv()}}const jB=QB;var Rw="@firebase/auth",xw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WB(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZB(n){gl(new Ko("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=i.options;be(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:l,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ox(n)},p=new xF(i,r,a,f);return kF(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),gl(new Ko("auth-internal",e=>{const t=vp(e.getProvider("auth").getImmediate());return(i=>new XB(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pr(Rw,xw,WB(n)),Pr(Rw,xw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eG=300,tG=OC("authIdTokenMaxAge")||eG;let Nw=null;const nG=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>tG)return;const r=t==null?void 0:t.token;Nw!==r&&(Nw=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function iG(n=$C()){const e=u_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=VF(n,{popupRedirectResolver:jB,persistence:[aB,QF,Kx]}),i=OC("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const l=nG(a.toString());HF(t,l,()=>l(t.currentUser)),zF(t,c=>l(c))}}const r=GU("auth");return r&&LF(t,`http://${r}`),t}function sG(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}NF({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const a=xi("internal-error");a.customData=r,t(a)},i.type="text/javascript",i.charset="UTF-8",sG().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZB("Browser");const Mw={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDf7A1EK0AlQckJjkLbI93Lu1EvWIH-Rws",VITE_FIREBASE_APP_ID:"1:814637797090:web:feb2cda6730397ca9f18bb",VITE_FIREBASE_AUTH_DOMAIN:"the-conservatory-d858b.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-1JKV6H7WDL",VITE_FIREBASE_MESSAGING_SENDER_ID:"814637797090",VITE_FIREBASE_PROJECT_ID:"the-conservatory-d858b",VITE_FIREBASE_STORAGE_BUCKET:"the-conservatory-d858b.firebasestorage.app"};var Dw={};const Ro=n=>{try{if(typeof import.meta<"u"&&Mw){const e=Mw[n];if(e)return e}}catch{}try{if(typeof process<"u"&&Dw){const e=Dw[n];if(e)return e}}catch{}},rG="conservatory_firebase_config";let wt=null;try{const n=localStorage.getItem(rG);n&&(wt=JSON.parse(n))}catch(n){console.warn("Failed to parse local firebase config",n)}const oG={apiKey:(wt==null?void 0:wt.apiKey)||Ro("VITE_FIREBASE_API_KEY")||"AIzaSyDf7A1EK0AlQckJjkLbI93Lu1EvWIH-Rws",authDomain:(wt==null?void 0:wt.authDomain)||Ro("VITE_FIREBASE_AUTH_DOMAIN")||"the-conservatory-d858b.firebaseapp.com",projectId:(wt==null?void 0:wt.projectId)||Ro("VITE_FIREBASE_PROJECT_ID")||"the-conservatory-d858b",storageBucket:(wt==null?void 0:wt.storageBucket)||Ro("VITE_FIREBASE_STORAGE_BUCKET")||"the-conservatory-d858b.firebasestorage.app",messagingSenderId:(wt==null?void 0:wt.messagingSenderId)||Ro("VITE_FIREBASE_MESSAGING_SENDER_ID")||"814637797090",appId:(wt==null?void 0:wt.appId)||Ro("VITE_FIREBASE_APP_ID")||"1:814637797090:web:feb2cda6730397ca9f18bb",measurementId:(wt==null?void 0:wt.measurementId)||Ro("VITE_FIREBASE_MEASUREMENT_ID")||"G-1JKV6H7WDL"},Zx=iO().length?$C():JC(oG),jg=iG(Zx),aG=new Rs;console.log("Initializing Firestore with databaseId: 'theconservatory' (Build: "+new Date().toISOString()+")");const Cs=k6(Zx,{localCache:j6({tabManager:eF()})},"theconservatory"),lG={async testConnection(n){if(!n)return{success:!1,error:"Authentication required",code:"auth_required"};try{const e=new Promise((t,i)=>setTimeout(()=>i(new Error("Connection Timed Out")),5e3));return await Promise.race([nF(al(Cs,"events","init")),e]),{success:!0,code:"connected"}}catch(e){const t=e.message||"Unknown Connection Error",i=e.code;return i==="permission-denied"||t.includes("permission-denied")?{success:!1,error:"Permission Denied",code:"permission_denied"}:t.includes("Connection Timed Out")||i==="unavailable"?{success:!1,error:"Offline",code:"offline"}:i==="failed-precondition"?{success:!1,error:"API Disabled",code:"api_disabled"}:{success:!1,error:t,code:"error"}}}};class uG{constructor(){this.events=[],this.entities=[],this.groups=[],this.messages=[],this.pendingAction=null,this.user=null,this.listeners=[],this.unsubscribes=[],this.loadLocal(),this.initAuth()}initAuth(){KF(jg,e=>{this.user=e,e?this.initFirestoreSync():this.clearSync(),this.notify()})}clearSync(){this.unsubscribes.forEach(e=>e()),this.unsubscribes=[]}async login(){try{await fB(jg,aG)}catch(e){throw console.error("Login failed",e),e}}async logout(){try{await JF(jg),this.clearSync()}catch(e){console.error("Logout failed",e)}}loadLocal(){try{const e=localStorage.getItem("conservatory_events"),t=localStorage.getItem("conservatory_entities"),i=localStorage.getItem("conservatory_groups"),r=localStorage.getItem("conservatory_messages");e&&(this.events=JSON.parse(e)),t&&(this.entities=JSON.parse(t)),i&&(this.groups=JSON.parse(i)),r&&(this.messages=JSON.parse(r))}catch{console.warn("Local storage corrupted, starting fresh.")}}persistLocal(){try{localStorage.setItem("conservatory_events",JSON.stringify(this.events)),localStorage.setItem("conservatory_entities",JSON.stringify(this.entities)),localStorage.setItem("conservatory_groups",JSON.stringify(this.groups)),localStorage.setItem("conservatory_messages",JSON.stringify(this.messages)),this.notify()}catch(e){console.error("LocalStorage Write Failed",e)}}initFirestoreSync(){this.clearSync();try{const e=Kg(Qf(Cs,"events"),Jg("timestamp","desc"),Y6(100)),t=$g(e,c=>{const f=[];c.forEach(_=>{var C,x;const T=_.data(),E=(C=T.timestamp)!=null&&C.toMillis?T.timestamp.toMillis():Date.now();f.push({id:_.id,timestamp:E,raw_input:((x=T.metadata)==null?void 0:x.originalTranscript)||"Manual Entry",status:bs.PARSED,domain_event:{eventId:_.id,type:T.type,timestamp:new Date(E).toISOString(),payload:T.payload,metadata:T.metadata}})});const p=this.events.filter(_=>_.status===bs.PENDING||_.status===bs.ERROR);this.events=[...p,...f],this.persistLocal()}),i=Kg(Qf(Cs,"entities"),Jg("updated_at","desc")),r=$g(i,c=>{const f=[];c.forEach(p=>{f.push({id:p.id,...p.data()})}),this.entities=f,this.persistLocal()}),a=Kg(Qf(Cs,"groups"),Jg("name","asc")),l=$g(a,c=>{const f=[];c.forEach(p=>{f.push({id:p.id,...p.data()})}),this.groups=f,this.persistLocal()});this.unsubscribes.push(t,r,l)}catch(e){console.error("Failed to init Firestore sync",e)}}notify(){this.listeners.forEach(e=>e())}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}getEvents(){return[...this.events]}getEntities(){return[...this.entities]}getGroups(){return[...this.groups]}getMessages(){return[...this.messages]}getPendingAction(){return this.pendingAction?{...this.pendingAction}:null}getUser(){return this.user}resolveEntity(e,t){if(!e)return{match:null,isAmbiguous:!1};const i=e.toLowerCase().trim(),r=t.filter(l=>{var c;return l.name.toLowerCase()===i||((c=l.aliases)==null?void 0:c.some(f=>f.toLowerCase()===i))});if(r.length===1)return{match:r[0],isAmbiguous:!1};if(r.length>1)return{match:null,isAmbiguous:!0};const a=t.filter(l=>{var c;return l.name.toLowerCase().includes(i)||((c=l.aliases)==null?void 0:c.some(f=>f.toLowerCase().includes(i)))});return a.length===1?{match:a[0],isAmbiguous:!1}:a.length>1?{match:null,isAmbiguous:!0}:{match:null,isAmbiguous:!1}}updateSlot(e,t){if(!this.pendingAction)return;const i=JSON.parse(JSON.stringify(this.pendingAction)),r=e.split(".");let a=i;for(let l=0;l<r.length-1;l++)a[r[l]]||(a[r[l]]={}),a=a[r[l]];a[r[r.length-1]]=t,this.pendingAction=i,this.persistLocal()}async processVoiceInput(e){var t;this.pendingAction={status:"ANALYZING",transcript:e,intent:null,candidates:[],aiReasoning:"Processing...",isAmbiguous:!1},this.notify();try{const i=[...this.entities],r=window.mockGeminiParse?await window.mockGeminiParse(e,i):await xc.parseVoiceCommand(e,i),a=r.targetHabitatName?this.resolveEntity(r.targetHabitatName,i):{match:null,isAmbiguous:!1};this.pendingAction={status:"CONFIRMING",transcript:e,intent:r.intent,targetHabitatId:((t=a.match)==null?void 0:t.id)||null,targetHabitatName:r.targetHabitatName,candidates:r.candidates||[],habitatParams:r.habitatParams,observationNotes:r.observationNotes,observationParams:r.observationParams,aiReasoning:r.aiReasoning,isAmbiguous:r.isAmbiguous||a.isAmbiguous},this.persistLocal()}catch(i){console.error("Voice Parsing Error:",i),this.pendingAction={status:"CONFIRMING",transcript:e,intent:"LOG_OBSERVATION",aiReasoning:i.message||"Parsing failed. Please edit manually.",candidates:[],observationNotes:e},this.persistLocal()}}cleanDataObject(e){return Array.isArray(e)?e.map(t=>this.cleanDataObject(t)):e!==null&&typeof e=="object"?Object.fromEntries(Object.entries(e).map(([t,i])=>[t,i===void 0?null:this.cleanDataObject(i)])):e===void 0?null:e}async commitPendingAction(){var c,f,p,_;if(!this.pendingAction)return;this.pendingAction.status="COMMITTING",this.notify();const e=this.pendingAction.intent||"LOG_OBSERVATION",t=e==="ACCESSION_ENTITY"?"ENTITY_ACCESSIONED":e==="MODIFY_HABITAT"?"MODIFY_HABITAT":"OBSERVATION_LOGGED",i=JSON.parse(JSON.stringify(this.pendingAction));delete i.status,delete i.isAmbiguous;const r=Co(),a={eventId:r,type:t,timestamp:new Date().toISOString(),payload:i,metadata:{source:"voice",originalTranscript:this.pendingAction.transcript,enrichmentStatus:"pending"}},l={id:r,timestamp:Date.now(),raw_input:this.pendingAction.transcript,status:bs.PENDING,domain_event:a};this.events.unshift(l),this.pendingAction=null,this.persistLocal();try{if(await iF(Qf(Cs,"events"),this.cleanDataObject({type:t,timestamp:K6(),payload:i,metadata:a.metadata})),e==="MODIFY_HABITAT"){const T=((c=i.habitatParams)==null?void 0:c.name)||"New Habitat",E=T.toLowerCase().trim(),C=this.entities.find(q=>q.type===oi.HABITAT&&q.name.toLowerCase().trim()===E);if(C){console.log(`Matching existing habitat found: ${C.id}`);return}const x=Co(),{name:P,type:k,...K}=i.habitatParams||{},W=this.cleanDataObject({name:T,type:oi.HABITAT,aliases:[],traits:[{type:"AQUATIC",parameters:{salinity:((f=i.habitatParams)==null?void 0:f.type)==="Saltwater"?"marine":"fresh"}}],confidence:1,enrichment_status:"none",created_at:Date.now(),updated_at:Date.now(),overflow:K});this.entities.push({id:x,...W}),this.persistLocal(),await jf(al(Cs,"entities",x),W)}else if(e==="ACCESSION_ENTITY")for(const T of i.candidates||[]){const E=T.commonName.toLowerCase().trim(),C=this.entities.find(z=>z.habitat_id===i.targetHabitatId&&z.name.toLowerCase().trim()===E);if(C){console.log(`Matching existing entity found in habitat: ${C.id}`);continue}const x=Co();let P=oi.ORGANISM;(p=T.traits)!=null&&p.some(z=>z.type==="PHOTOSYNTHETIC")&&(P=oi.PLANT),(_=T.traits)!=null&&_.some(z=>z.type==="COLONY")&&(P=oi.COLONY);const{commonName:k,scientificName:K,quantity:W,traits:q,...ee}=T,ae=this.cleanDataObject({name:T.commonName,scientificName:T.scientificName,habitat_id:i.targetHabitatId,traits:T.traits||[],type:P,quantity:T.quantity,confidence:.9,aliases:[],enrichment_status:"pending",created_at:Date.now(),updated_at:Date.now(),overflow:ee});this.entities.push({id:x,...ae}),this.persistLocal(),await jf(al(Cs,"entities",x),ae)}}catch(T){console.error("Persistence Failed",T);const E=this.events.findIndex(C=>C.id===r);E!==-1&&(this.events[E].status=bs.ERROR,this.events[E].error_message=T.message,this.persistLocal())}}discardPending(){this.pendingAction=null,this.persistLocal()}async updateEntity(e,t){try{const i=al(Cs,"entities",e);await jf(i,{...t,updated_at:Date.now()},{merge:!0})}catch(i){console.error("Failed to update entity in Firestore",i);const r=this.entities.findIndex(a=>a.id===e);r!==-1&&(this.entities[r]={...this.entities[r],...t,updated_at:Date.now()},this.persistLocal())}}async addGroup(e){const t=Co(),i={id:t,name:e};try{await jf(al(Cs,"groups",t),i)}catch(r){console.error("Failed to add group to Firestore",r),this.groups.push(i),this.persistLocal()}return i}async enrichEntity(e){const t=this.entities.find(i=>i.id===e);if(t){this.updateEntity(e,{enrichment_status:"pending"});try{const i=t.scientificName||t.name,[r,a,l]=await Promise.all([Promise.resolve(null),Promise.resolve(null),Promise.resolve(null)]);let c=null;if(t.type===oi.PLANT){const{enrichmentService:f}=await tM(async()=>{const{enrichmentService:p}=await import("./enrichmentService-Bnh0E9cb.js");return{enrichmentService:p}},[]);c=await f.scrapeAquasabi(t.scientificName||t.name),c&&c.details&&this.updateEntity(e,{details:{...t.details,description:c.details.description,notes:c.details.notes,maintenance:c.details.maintenance}})}this.updateEntity(e,{enrichment_status:"complete"})}catch(i){console.error("Enrichment Failed",i),this.updateEntity(e,{enrichment_status:"failed"})}}}async sendMessage(e,t){const i={id:Co(),role:"user",text:e,timestamp:Date.now()};this.messages.push(i),this.notify();try{const r=this.messages.slice(-8),a=window.mockGeminiChat?await window.mockGeminiChat(e,r,t):await xc.chat(e,r,t),l={id:Co(),role:"model",text:a.text,timestamp:Date.now(),isSearch:t.search,isThinking:t.thinking,groundingLinks:a.links};this.messages.push(l),this.persistLocal()}catch(r){this.messages.push({id:Co(),role:"model",text:`Consultant Error: ${r.message}`,timestamp:Date.now()}),this.persistLocal()}}clearMessages(){this.messages=[],this.persistLocal()}async testConnection(){return lG.testConnection(this.user)}}const yt=new uG;function _v(){const[n,e]=ye.useState({events:yt.getEvents(),entities:yt.getEntities(),groups:yt.getGroups(),messages:yt.getMessages(),pendingAction:yt.getPendingAction(),user:yt.getUser()});return ye.useEffect(()=>yt.subscribe(()=>{e({events:yt.getEvents(),entities:yt.getEntities(),groups:yt.getGroups(),messages:yt.getMessages(),pendingAction:yt.getPendingAction(),user:yt.getUser()})}),[]),{...n,login:ye.useCallback(()=>yt.login(),[]),logout:ye.useCallback(()=>yt.logout(),[]),processVoiceInput:ye.useCallback(t=>yt.processVoiceInput(t),[]),commitPendingAction:ye.useCallback(()=>yt.commitPendingAction(),[]),discardPending:ye.useCallback(()=>yt.discardPending(),[]),updateSlot:ye.useCallback((t,i)=>yt.updateSlot(t,i),[]),updateEntity:ye.useCallback((t,i)=>yt.updateEntity(t,i),[]),addGroup:ye.useCallback(t=>yt.addGroup(t),[]),testConnection:ye.useCallback(()=>yt.testConnection(),[]),enrichEntity:ye.useCallback(t=>yt.enrichEntity(t),[]),sendMessage:ye.useCallback((t,i)=>yt.sendMessage(t,i),[]),clearMessages:ye.useCallback(()=>yt.clearMessages(),[])}}/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cG=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dG=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=n=>{const e=dG(n);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hG=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pG=ye.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:a,iconNode:l,...c},f)=>ye.createElement("svg",{ref:f,...fG,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:e1("lucide",r),...!a&&!hG(c)&&{"aria-hidden":"true"},...c},[...l.map(([p,_])=>ye.createElement(p,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=(n,e)=>{const t=ye.forwardRef(({className:i,...r},a)=>ye.createElement(pG,{ref:a,iconNode:e,className:e1(`lucide-${cG(Pw(n))}`,`lucide-${n}`,i),...r}));return t.displayName=Pw(n),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mG=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],vv=Ne("activity",mG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gG=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],t1=Ne("arrow-right",gG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yG=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Vw=Ne("bot",yG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _G=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Wf=Ne("brain",_G);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vG=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],TG=Ne("bug",vG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EG=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],SG=Ne("camera",EG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AG=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Tv=Ne("check",AG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],n1=Ne("circle-alert",IG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],i1=Ne("circle-check",wG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CG=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],bG=Ne("clock",CG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RG=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],xG=Ne("copy",RG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NG=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Yy=Ne("database",NG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MG=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],s1=Ne("droplets",MG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DG=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],kw=Ne("earth",DG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PG=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Qy=Ne("external-link",PG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VG=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],kG=Ne("flower-2",VG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LG=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],UG=Ne("folder-open",LG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Lw=Ne("globe",OG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],BG=Ne("info",FG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GG=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],r1=Ne("layers",GG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qG=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],zG=Ne("layout-grid",qG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HG=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],o1=Ne("leaf",HG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KG=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Sp=Ne("loader-circle",KG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JG=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],$G=Ne("log-in",JG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YG=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],QG=Ne("log-out",YG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jG=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],XG=Ne("message-square",jG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WG=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],ZG=Ne("mic-off",WG);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],t9=Ne("mic",e9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],i9=Ne("package",n9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],r9=Ne("play",s9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Uw=Ne("plus",o9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],l9=Ne("refresh-cw",a9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],c9=Ne("send",u9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],f9=Ne("settings-2",d9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],p9=Ne("settings",h9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],g9=Ne("shield-alert",m9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],a1=Ne("shield-check",y9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _9=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ev=Ne("sparkles",_9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],T9=Ne("tag",v9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],l1=Ne("terminal",E9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S9=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],u1=Ne("thermometer",S9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Sv=Ne("triangle-alert",A9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],w9=Ne("waves",I9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],b9=Ne("wind",C9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Os=Ne("x",R9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],N9=Ne("zap",x9),M9=({onTranscription:n})=>{const[e,t]=ye.useState(!1),[i,r]=ye.useState(""),a=ye.useRef(null),l=ye.useCallback(()=>{const f=window.webkitSpeechRecognition||window.SpeechRecognition;if(!f){alert("Speech recognition not supported in this browser.");return}const p=new f;p.continuous=!0,p.interimResults=!0,p.lang="en-US",p.onresult=_=>{let T="",E="";for(let C=_.resultIndex;C<_.results.length;++C)_.results[C].isFinal?T+=_.results[C][0].transcript:E+=_.results[C][0].transcript;r(E),T&&n(T.trim())},p.onstart=()=>t(!0),p.onend=()=>{t(!1),r("")},p.start(),a.current=p},[n]),c=ye.useCallback(()=>{a.current&&a.current.stop()},[]);return I.jsxs("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 flex flex-col items-center",children:[i&&I.jsx("div",{className:"mb-4 bg-black/80 backdrop-blur-md px-4 py-2 rounded-full border border-emerald-500/30 text-emerald-400 text-sm animate-pulse max-w-xs text-center truncate",children:i}),I.jsx("button",{onPointerDown:l,onPointerUp:c,onPointerLeave:c,className:`
          w-20 h-20 rounded-full flex items-center justify-center shadow-2xl transition-all duration-300 transform active:scale-90
          ${e?"bg-red-500 shadow-red-500/50 scale-110":"bg-emerald-600 hover:bg-emerald-500 shadow-emerald-500/30"}
        `,children:e?I.jsx(ZG,{className:"w-8 h-8 text-white"}):I.jsx(t9,{className:"w-8 h-8 text-white"})}),I.jsx("p",{className:"mt-3 text-xs uppercase tracking-widest text-emerald-500/70 font-bold",children:e?"Listening...":"Hold to Talk"})]})},D9=({events:n})=>{const e=i=>{switch(i){case bs.PENDING:return I.jsx(bG,{className:"w-4 h-4 text-amber-500 animate-spin"});case bs.PARSED:return I.jsx(i1,{className:"w-4 h-4 text-emerald-500"});case bs.ERROR:return I.jsx(n1,{className:"w-4 h-4 text-red-500"});default:return I.jsx(Ev,{className:"w-4 h-4 text-slate-500"})}},t=i=>i?I.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:Object.entries(i).map(([r,a])=>a!=null&&I.jsxs("div",{className:"bg-slate-800/50 rounded px-2 py-1 text-xs flex items-center gap-2 border border-slate-700/50",children:[r==="pH"&&I.jsx(s1,{className:"w-3 h-3 text-cyan-400"}),r==="temp"&&I.jsx(u1,{className:"w-3 h-3 text-red-400"}),r!=="pH"&&r!=="temp"&&I.jsx(vv,{className:"w-3 h-3 text-slate-400"}),I.jsx("span",{className:"text-slate-400 uppercase text-[10px] tracking-wide",children:r}),I.jsx("span",{className:"font-bold text-slate-200 ml-auto",children:String(a)})]},r))}):null;return I.jsxs("div",{className:"space-y-4 pb-32",children:[I.jsx("h2",{className:"text-xl font-serif font-bold text-emerald-400 mb-6 flex items-center gap-2",children:"Activity Log"}),n.length===0&&I.jsx("div",{className:"py-12 text-center text-slate-500 italic",children:"No records yet. Start by speaking to the system."}),n.map(i=>I.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-xl p-4 transition-all hover:bg-slate-900",children:[I.jsxs("div",{className:"flex justify-between items-start mb-2",children:[I.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-mono",children:new Date(i.timestamp).toLocaleTimeString()}),I.jsx("div",{className:"flex items-center gap-2",children:e(i.status)})]}),I.jsxs("p",{className:"text-slate-200 text-sm mb-3 font-medium",children:['"',i.raw_input,'"']}),i.domain_event&&I.jsxs("div",{className:"bg-black/30 rounded-lg p-3 border border-slate-800/50",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx(l1,{className:"w-3 h-3 text-emerald-500"}),I.jsx("span",{className:"text-[10px] font-bold text-emerald-500 uppercase tracking-wider",children:i.domain_event.type})]}),I.jsxs("div",{className:"space-y-1",children:[i.domain_event.payload.targetHabitatName&&I.jsxs("div",{className:"text-xs text-slate-400 flex justify-between",children:[I.jsx("span",{children:"Habitat"}),I.jsx("span",{className:"text-slate-200",children:i.domain_event.payload.targetHabitatName})]}),i.domain_event.payload.candidates&&i.domain_event.payload.candidates.length>0&&I.jsxs("div",{className:"text-xs text-slate-400 mt-2",children:[I.jsx("span",{className:"block mb-1 text-[10px] uppercase",children:"Accessioned:"}),i.domain_event.payload.candidates.map((r,a)=>I.jsxs("div",{className:"flex justify-between pl-2 border-l border-emerald-500/30",children:[I.jsx("span",{className:"text-slate-300",children:r.commonName}),r.quantity&&I.jsxs("span",{className:"text-emerald-500 font-mono",children:["x",r.quantity]})]},a))]}),i.domain_event.payload.observationParams&&t(i.domain_event.payload.observationParams),i.domain_event.payload.observationNotes&&I.jsxs("div",{className:"text-xs text-slate-500 italic border-l-2 border-slate-700 pl-2 mt-2",children:['"',i.domain_event.payload.observationNotes,'"']})]})]}),i.error_message&&I.jsxs("div",{className:"mt-2 text-[10px] text-red-400 font-mono bg-red-900/10 p-2 rounded",children:["Error: ",i.error_message]})]},i.id))]})},P9=({entities:n,groups:e,onSelectEntity:t})=>{const i=c=>{switch(c){case oi.HABITAT:return I.jsx(w9,{className:"w-5 h-5 text-cyan-400"});case oi.PLANT:case oi.PLANT_GROUP:return I.jsx(kG,{className:"w-5 h-5 text-emerald-400"});case oi.ORGANISM:case oi.COLONY:return I.jsx(TG,{className:"w-5 h-5 text-amber-400"});default:return I.jsx(i9,{className:"w-5 h-5 text-slate-400"})}},r=c=>{var f;return I.jsxs("button",{onClick:()=>t(c),className:"bg-slate-900/40 border border-slate-800 p-3 rounded-xl hover:bg-slate-900 transition-all text-left relative group",children:[I.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i(c.type),I.jsxs("div",{className:"flex gap-1",children:[c.quantity!==void 0&&I.jsxs("span",{className:"text-[10px] bg-slate-800 px-1.5 py-0.5 rounded text-slate-300 font-mono",children:["x",c.quantity]}),I.jsx(f9,{className:"w-3 h-3 text-slate-600 opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),I.jsx("h4",{className:"text-sm font-medium text-slate-200 truncate pr-4",children:c.name}),I.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[I.jsx("p",{className:"text-[10px] text-slate-500 truncate flex-1",children:((f=n.find(p=>p.id===c.habitat_id))==null?void 0:f.name)||"Roaming"}),c.aliases.length>0&&I.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_5px_rgba(16,185,129,0.5)]",title:"Has custom aliases"})]})]},c.id)},a=e.reduce((c,f)=>(c[f.id]=n.filter(p=>p.group_id===f.id),c),{}),l=n.filter(c=>!c.group_id);return I.jsxs("div",{className:"space-y-10 pb-20",children:[e.map(c=>a[c.id].length>0&&I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-center gap-2 px-1",children:[I.jsx("h3",{className:"text-sm font-bold uppercase tracking-[0.2em] text-cyan-500/80",children:c.name}),I.jsx("div",{className:"flex-1 h-px bg-cyan-500/10"}),I.jsx("span",{className:"text-[10px] font-mono text-slate-600",children:a[c.id].length})]}),I.jsx("div",{className:"grid grid-cols-2 gap-3",children:a[c.id].map(r)})]},c.id)),l.length>0&&I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-center gap-2 px-1",children:[I.jsx("h3",{className:"text-sm font-bold uppercase tracking-[0.2em] text-slate-600",children:"Ungrouped"}),I.jsx("div",{className:"flex-1 h-px bg-slate-800"}),I.jsx("span",{className:"text-[10px] font-mono text-slate-600",children:l.length})]}),I.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.map(r)})]}),n.length===0&&I.jsx("div",{className:"py-20 text-center text-slate-600 italic",children:"Collection is empty. Record your first organism."})]})},V9=({containers:n,onConfirm:e,onClose:t})=>{const[i,r]=ye.useState(n.map(c=>({...c,selected:!0}))),a=c=>{const f=[...i];f[c].selected=!f[c].selected,r(f)},l=(c,f)=>{const p=[...i];p[c]={...p[c],...f},r(p)};return I.jsxs("div",{className:"fixed inset-0 z-[80] bg-black/90 backdrop-blur-md flex flex-col p-6 overflow-y-auto",children:[I.jsxs("div",{className:"flex justify-between items-center mb-8 shrink-0",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-serif font-bold text-white",children:"Rack Detected"}),I.jsx("p",{className:"text-slate-400 text-sm",children:"Review detected habitats before logging."})]}),I.jsx("button",{onClick:t,className:"p-2 bg-slate-800 rounded-full text-slate-400",children:I.jsx(Os,{className:"w-6 h-6"})})]}),I.jsx("div",{className:"space-y-4 mb-24",children:i.map((c,f)=>I.jsx("div",{className:`bg-slate-900 border transition-all rounded-2xl p-4 ${c.selected?"border-emerald-500/50 bg-emerald-500/5":"border-slate-800 opacity-60"}`,children:I.jsxs("div",{className:"flex gap-4",children:[I.jsx("button",{onClick:()=>a(f),className:`w-10 h-10 rounded-full flex items-center justify-center shrink-0 border ${c.selected?"bg-emerald-500 border-emerald-400 text-white":"border-slate-700 text-slate-700"}`,children:c.selected&&I.jsx(Tv,{className:"w-5 h-5"})}),I.jsxs("div",{className:"flex-1 space-y-3",children:[I.jsx("div",{className:"flex justify-between items-start",children:I.jsx("input",{className:"bg-transparent border-b border-transparent focus:border-emerald-500/50 text-white font-medium outline-none text-lg w-full",defaultValue:`${c.size_estimate} ${c.shelf_level} ${c.horizontal_position}`,onChange:p=>l(f,{size_estimate:p.target.value})})}),I.jsxs("div",{className:"flex flex-wrap gap-2",children:[I.jsxs("span",{className:"text-[10px] bg-slate-800 px-2 py-1 rounded-md text-slate-400 uppercase tracking-tighter",children:[c.shelf_level," shelf"]}),I.jsx("span",{className:"text-[10px] bg-slate-800 px-2 py-1 rounded-md text-slate-400 uppercase tracking-tighter",children:c.horizontal_position})]}),I.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[I.jsx(r1,{className:"w-3 h-3"}),I.jsx("span",{children:c.primary_species.map(p=>p.common_name).join(", ")||"Unknown species"})]})]})]})},f))}),I.jsxs("div",{className:"fixed bottom-8 left-6 right-6 flex gap-4 max-w-2xl mx-auto",children:[I.jsx("button",{onClick:t,className:"flex-1 py-4 bg-slate-800 rounded-2xl text-slate-300 font-bold",children:"Discard All"}),I.jsxs("button",{onClick:()=>e(i.filter(c=>c.selected)),className:"flex-2 py-4 bg-emerald-500 rounded-2xl text-white font-bold flex items-center justify-center gap-2 shadow-xl shadow-emerald-500/20",children:["Confirm & Log Events ",I.jsx(t1,{className:"w-5 h-5"})]})]})]})},k9=({onConfirmObservation:n,onConfirmRack:e})=>{const[t,i]=ye.useState(!1),[r,a]=ye.useState("single"),[l,c]=ye.useState(!1),[f,p]=ye.useState(null),[_,T]=ye.useState(null),[E,C]=ye.useState(null),x=ye.useRef(null),P=ye.useRef(null),k=async q=>{a(q),i(!0);try{const ee=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});x.current&&(x.current.srcObject=ee)}catch(ee){console.error("Camera error:",ee),i(!1)}},K=async()=>{var z;if(!x.current||!P.current)return;c(!0);const q=P.current,ee=x.current;q.width=ee.videoWidth,q.height=ee.videoHeight,(z=q.getContext("2d"))==null||z.drawImage(ee,0,0);const ae=q.toDataURL("image/jpeg",.8).split(",")[1];C(q.toDataURL("image/jpeg")),ee.srcObject.getTracks().forEach(N=>N.stop());try{if(r==="single"){const N=await xc.identifyPhoto(ae);p(N)}else{const N=await xc.analyzeRackScene(ae);T(N.containers)}}catch(N){console.error(N)}finally{c(!1)}},W=()=>{i(!1),p(null),T(null),C(null)};return _?I.jsx(V9,{containers:_,onConfirm:q=>{e(q),W()},onClose:W}):t?I.jsx("div",{className:"fixed inset-0 z-[60] bg-black flex flex-col items-center justify-center p-4",children:I.jsx("div",{className:"relative w-full max-w-md aspect-[3/4] bg-slate-900 rounded-3xl overflow-hidden border border-slate-800",children:E?I.jsxs("div",{className:"relative w-full h-full",children:[I.jsx("img",{src:E,className:"w-full h-full object-cover opacity-50"}),I.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-8 text-center",children:l?I.jsxs("div",{className:"space-y-4",children:[I.jsx(l9,{className:"w-12 h-12 text-emerald-400 animate-spin mx-auto"}),I.jsxs("p",{className:"text-emerald-400 font-serif text-xl italic",children:["Analyzing ",r==="single"?"Species":"Rack","..."]})]}):f?I.jsxs("div",{className:"bg-black/60 backdrop-blur-xl p-6 rounded-2xl border border-emerald-500/30",children:[I.jsx("h3",{className:"text-2xl font-serif text-white mt-1",children:f.common_name}),I.jsxs("p",{className:"mt-8 flex gap-3",children:[I.jsx("button",{onClick:W,className:"flex-1 py-3 bg-slate-800 rounded-xl",children:"Cancel"}),I.jsx("button",{onClick:()=>{n(f),W()},className:"flex-1 py-3 bg-emerald-500 rounded-xl font-bold",children:"Log Event"})]})]}):null})]}):I.jsxs(I.Fragment,{children:[I.jsx("video",{ref:x,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),I.jsx("div",{className:"absolute top-6 left-6 right-6 text-center",children:I.jsx("span",{className:"bg-black/50 backdrop-blur px-4 py-1.5 rounded-full text-xs font-bold text-white uppercase tracking-widest border border-white/10",children:r==="single"?"Species ID Mode":"Rack Scan Mode"})}),I.jsxs("div",{className:"absolute inset-x-0 bottom-8 flex justify-center gap-6 px-8",children:[I.jsx("button",{onClick:W,className:"w-14 h-14 bg-white/10 backdrop-blur rounded-full flex items-center justify-center",children:I.jsx(Os,{className:"w-6 h-6 text-white"})}),I.jsx("button",{onClick:K,className:"w-20 h-20 bg-emerald-500 rounded-full flex items-center justify-center shadow-xl",children:I.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-white/40"})})]})]})})}):I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:()=>k("rack"),className:"bg-slate-800/80 p-3 rounded-full border border-slate-700 hover:bg-slate-700 transition-colors",children:I.jsx(r1,{className:"w-6 h-6 text-cyan-400"})}),I.jsx("button",{onClick:()=>k("single"),className:"bg-slate-800/80 p-3 rounded-full border border-slate-700 hover:bg-slate-700 transition-colors",children:I.jsx(SG,{className:"w-6 h-6 text-emerald-400"})})]})},L9=({entity:n,groups:e,onClose:t,onUpdate:i,onAddGroup:r})=>{const[a,l]=ye.useState(""),[c,f]=ye.useState(!1),[p,_]=ye.useState(""),[T,E]=ye.useState(null),[C,x]=ye.useState(!1);ye.useEffect(()=>{const q=async()=>{x(!0);try{const ee=n.scientificName||n.name,z=await(await fetch(`https://api.gbif.org/v1/species/match?name=${encodeURIComponent(ee)}`)).json();z.matchType!=="NONE"&&(E({scientificName:z.scientificName,kingdom:z.kingdom,family:z.family,matchType:z.matchType,status:z.status}),!n.scientificName&&z.scientificName&&i({scientificName:z.scientificName}))}catch(ee){console.error("GBIF Error",ee)}finally{x(!1)}};(n.type==="ORGANISM"||n.type==="PLANT")&&q()},[n.id]);const P=()=>{a.trim()&&!n.aliases.includes(a.trim())&&(i({aliases:[...n.aliases,a.trim()]}),l(""))},k=q=>{i({aliases:n.aliases.filter(ee=>ee!==q)})},K=q=>{i({group_id:q})},W=async()=>{if(p.trim()){const q=await r(p.trim());K(q.id),_(""),f(!1)}};return I.jsx("div",{className:"fixed inset-0 z-[70] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:I.jsxs("div",{className:"bg-slate-900 w-full max-w-md border border-slate-800 rounded-3xl overflow-hidden shadow-2xl animate-in zoom-in duration-200 flex flex-col max-h-[85vh]",children:[I.jsxs("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-black/20",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-xl font-serif font-bold text-white",children:n.name}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("p",{className:"text-xs text-emerald-500 font-mono uppercase tracking-wider",children:n.type}),n.quantity&&I.jsxs("span",{className:"text-xs bg-slate-800 px-2 rounded-full text-slate-300",children:["x",n.quantity]})]})]}),I.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full text-slate-400",children:I.jsx(Os,{className:"w-6 h-6"})})]}),I.jsxs("div",{className:"p-6 space-y-8 overflow-y-auto no-scrollbar flex-1",children:[(n.type==="ORGANISM"||n.type==="PLANT")&&I.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-xl p-4 relative overflow-hidden",children:[I.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-10",children:I.jsx(kw,{className:"w-24 h-24"})}),I.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[I.jsx(kw,{className:"w-4 h-4 text-emerald-400"}),I.jsx("h3",{className:"text-xs font-bold uppercase tracking-widest text-emerald-400",children:"Scientific Context"})]}),C?I.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[I.jsx(Sp,{className:"w-4 h-4 animate-spin"})," Verifying with GBIF..."]}):T?I.jsxs("div",{className:"space-y-2 relative z-10",children:[I.jsxs("div",{className:"flex justify-between items-start",children:[I.jsxs("div",{children:[I.jsx("div",{className:"text-lg font-serif italic text-white",children:T.scientificName}),I.jsxs("div",{className:"text-xs text-slate-400",children:["Family: ",T.family,"  Kingdom: ",T.kingdom]})]}),T.matchType==="EXACT"&&I.jsx("div",{className:"bg-emerald-500/20 text-emerald-400 p-1.5 rounded-full",title:"Exact Scientific Match",children:I.jsx(i1,{className:"w-5 h-5"})}),T.matchType==="FUZZY"&&I.jsx("div",{className:"bg-amber-500/20 text-amber-400 p-1.5 rounded-full",title:"Fuzzy Match (Approximate)",children:I.jsx(Sv,{className:"w-5 h-5"})})]}),I.jsx("div",{className:"text-[10px] text-slate-600 pt-2 border-t border-slate-700/50",children:"Source: Global Biodiversity Information Facility"})]}):I.jsx("div",{className:"text-sm text-slate-500 italic",children:"No scientific match found in global database."})]}),I.jsxs("section",{children:[I.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[I.jsx(T9,{className:"w-4 h-4 text-slate-400"}),I.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400",children:"Custom Aliases"})]}),I.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.aliases.map(q=>I.jsxs("span",{className:"bg-slate-800 text-slate-300 px-3 py-1.5 rounded-xl text-xs flex items-center gap-2 border border-slate-700",children:[q,I.jsx("button",{onClick:()=>k(q),className:"hover:text-red-400",children:I.jsx(Os,{className:"w-3 h-3"})})]},q)),n.aliases.length===0&&I.jsx("p",{className:"text-xs text-slate-600 italic",children:"No aliases set."})]}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("input",{type:"text",value:a,onChange:q=>l(q.target.value),placeholder:"Add new alias...",className:"flex-1 bg-black/40 border border-slate-800 rounded-xl px-4 py-2 text-sm text-slate-200 focus:outline-none focus:border-emerald-500/50",onKeyDown:q=>q.key==="Enter"&&P()}),I.jsx("button",{onClick:P,className:"p-2 bg-emerald-600 rounded-xl text-white hover:bg-emerald-500 transition-colors",children:I.jsx(Uw,{className:"w-5 h-5"})})]})]}),I.jsxs("section",{children:[I.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[I.jsx(UG,{className:"w-4 h-4 text-cyan-500"}),I.jsx("h3",{className:"text-sm font-bold uppercase tracking-widest text-slate-400",children:"Assign Group"})]}),I.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[I.jsxs("button",{onClick:()=>K(void 0),className:`p-3 rounded-xl text-left text-sm flex justify-between items-center border transition-all ${n.group_id?"bg-slate-800/50 border-slate-800 text-slate-400":"bg-cyan-500/10 border-cyan-500/50 text-cyan-400"}`,children:["No Group",!n.group_id&&I.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-500"})]}),e.map(q=>I.jsxs("button",{onClick:()=>K(q.id),className:`p-3 rounded-xl text-left text-sm flex justify-between items-center border transition-all ${n.group_id===q.id?"bg-cyan-500/10 border-cyan-500/50 text-cyan-400":"bg-slate-800/50 border-slate-800 text-slate-400"}`,children:[q.name,n.group_id===q.id&&I.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-500"})]},q.id)),c?I.jsxs("div",{className:"mt-4 space-y-2",children:[I.jsx("input",{autoFocus:!0,type:"text",value:p,onChange:q=>_(q.target.value),placeholder:"Group name (e.g. 'Basement')",className:"w-full bg-black/40 border border-slate-800 rounded-xl px-4 py-2 text-sm text-slate-200 focus:outline-none focus:border-cyan-500/50"}),I.jsxs("div",{className:"flex gap-2",children:[I.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-2 text-xs text-slate-500",children:"Cancel"}),I.jsx("button",{onClick:W,className:"flex-1 py-2 bg-cyan-600 rounded-lg text-white text-xs font-bold",children:"Create & Assign"})]})]}):I.jsxs("button",{onClick:()=>f(!0),className:"mt-2 p-3 rounded-xl border border-dashed border-slate-700 text-slate-500 text-sm flex items-center justify-center gap-2 hover:border-slate-500 transition-colors",children:[I.jsx(Uw,{className:"w-4 h-4"})," Create New Group"]})]})]})]})]})})},U9=({traits:n,onChange:e})=>{const[t,i]=ye.useState(!1),r=["AQUATIC","TERRESTRIAL","PHOTOSYNTHETIC","INVERTEBRATE","VERTEBRATE","COLONY"],a=l=>{const c=n.find(f=>f.type===l);e(c?n.filter(f=>f.type!==l):[...n,{type:l,parameters:{}}])};return t?I.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",onClick:l=>{l.stopPropagation(),i(!1)},children:I.jsxs("div",{className:"bg-slate-900 p-6 rounded-2xl border border-slate-700 max-w-sm w-full shadow-2xl",onClick:l=>l.stopPropagation(),children:[I.jsxs("h4",{className:"text-white font-serif font-bold mb-4 flex items-center gap-2",children:[I.jsx(Ev,{className:"w-4 h-4 text-emerald-400"}),"Edit Traits (DNA)"]}),I.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:r.map(l=>{const c=n.some(f=>f.type===l);return I.jsx("button",{onClick:()=>a(l),className:`px-3 py-2 rounded-lg text-xs font-bold border transition-all ${c?"bg-emerald-500/20 border-emerald-500 text-emerald-400 shadow-[0_0_10px_rgba(16,185,129,0.2)]":"bg-slate-800 border-slate-700 text-slate-500 hover:border-slate-600"}`,children:l},l)})}),I.jsx("button",{onClick:()=>i(!1),className:"w-full py-3 bg-slate-800 hover:bg-slate-700 rounded-xl text-white font-bold text-sm transition-colors",children:"Done"})]})}):I.jsxs("span",{onClick:()=>i(!0),className:"inline-flex flex-wrap gap-1 mx-1 align-middle cursor-pointer hover:bg-slate-800/50 rounded px-1 transition-colors group",children:[I.jsx("span",{className:"text-slate-600 font-bold text-lg select-none group-hover:text-slate-400",children:"["}),n.length===0?I.jsx("span",{className:"text-amber-500 font-bold italic text-sm px-1",children:"No Traits"}):null,n.map((l,c)=>I.jsx("span",{className:"text-cyan-400 font-bold text-sm bg-cyan-950/40 px-1.5 rounded border border-cyan-500/20 shadow-sm",children:l.type},c)),I.jsx("span",{className:"text-slate-600 font-bold text-lg select-none group-hover:text-slate-400",children:"]"})]})},qn=({value:n,placeholder:e,type:t="text",suffix:i,onChange:r})=>{const[a,l]=ye.useState(!1),c=ye.useRef(null);return ye.useEffect(()=>{a&&c.current&&c.current.focus()},[a]),a?I.jsx("input",{ref:c,type:t,value:n||"",onChange:f=>r(t==="number"?parseFloat(f.target.value):f.target.value),onBlur:()=>l(!1),onKeyDown:f=>f.key==="Enter"&&l(!1),className:"bg-slate-800 text-emerald-400 font-bold rounded px-2 py-0.5 outline-none border border-emerald-500/50 min-w-[40px] inline-block align-middle mx-1",placeholder:e}):I.jsxs("span",{onClick:()=>l(!0),className:`
        inline-block mx-1 px-2 py-0.5 rounded-md cursor-pointer border-b-2 transition-all font-bold align-middle
        ${n==null?"text-amber-500 border-amber-500/50 bg-amber-500/10":"text-emerald-400 border-emerald-500/50 bg-emerald-500/10 hover:bg-emerald-500/20"}
      `,children:[n??e,n&&i&&I.jsx("span",{className:"text-emerald-500/50 text-xs ml-0.5 font-normal",children:i})]})},O9=({action:n,onCommit:e,onDiscard:t,onUpdate:i})=>{var a,l,c,f,p,_,T,E,C,x;return n.status==="ANALYZING"?I.jsx("div",{className:"fixed inset-x-4 top-24 z-[55] animate-in slide-in-from-top duration-300 max-w-2xl mx-auto",children:I.jsxs("div",{className:"bg-slate-900 border border-emerald-500/30 rounded-3xl p-6 shadow-2xl relative overflow-hidden",children:[I.jsx("div",{className:"absolute inset-0 bg-emerald-500/5 animate-pulse"}),I.jsxs("div",{className:"relative z-10 space-y-4",children:[I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx(Sp,{className:"w-5 h-5 text-emerald-400 animate-spin"}),I.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-emerald-500",children:"Processing Intent..."})]}),I.jsxs("p",{className:"text-white font-serif text-xl leading-relaxed opacity-90",children:['"',n.transcript,'"']}),I.jsxs("div",{className:"space-y-2 pt-2",children:[I.jsx("div",{className:"h-4 bg-slate-800 rounded w-2/3 animate-pulse"}),I.jsx("div",{className:"h-4 bg-slate-800 rounded w-1/2 animate-pulse"})]})]})]})}):I.jsx("div",{className:"fixed inset-x-4 top-24 z-[55] animate-in slide-in-from-top duration-500 max-w-2xl mx-auto",children:I.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[70vh]",children:[I.jsxs("div",{className:"bg-black/40 p-4 border-b border-slate-800 flex justify-between items-center",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:`w-2 h-2 rounded-full ${n.isAmbiguous?"bg-amber-500":"bg-emerald-500"}`}),I.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-400",children:(a=n.intent)==null?void 0:a.replace("_"," ")})]}),I.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full text-slate-500 hover:text-white transition-colors",children:I.jsx(Os,{className:"w-5 h-5"})})]}),I.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar",children:[n.intent==="ACCESSION_ENTITY"&&I.jsxs("div",{className:"text-xl leading-relaxed text-slate-300 font-serif",children:["I am adding",n.candidates.map((P,k)=>I.jsx("div",{className:"my-3 pl-4 border-l-2 border-emerald-500/30",children:I.jsxs("div",{className:"flex items-center flex-wrap",children:[I.jsx(qn,{value:P.quantity,placeholder:"#",type:"number",onChange:K=>i(`candidates.${k}.quantity`,K)}),I.jsx(qn,{value:P.commonName,placeholder:"Species Name",onChange:K=>i(`candidates.${k}.commonName`,K)}),I.jsx("span",{className:"mx-1",children:"which are"}),I.jsx(U9,{traits:P.traits,onChange:K=>i(`candidates.${k}.traits`,K)})]})},k)),"to",I.jsx(qn,{value:n.targetHabitatName,placeholder:"Select Habitat...",onChange:P=>i("targetHabitatName",P)}),"."]}),n.intent==="LOG_OBSERVATION"&&I.jsxs("div",{className:"space-y-6",children:[I.jsxs("div",{className:"text-xl leading-relaxed text-slate-300 font-serif",children:[I.jsxs("span",{className:"text-slate-500 text-base italic block mb-2",children:['"',n.observationNotes||n.transcript,'"']}),"I observed",I.jsx(qn,{value:n.targetHabitatName,placeholder:"Select Habitat...",onChange:P=>i("targetHabitatName",P)}),"and recorded:"]}),I.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[I.jsxs("div",{className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-slate-400 uppercase tracking-wider",children:[I.jsx(s1,{className:"w-3 h-3 text-cyan-400"})," pH"]}),I.jsx(qn,{value:(l=n.observationParams)==null?void 0:l.pH,placeholder:"--",type:"number",onChange:P=>i("observationParams.pH",P)})]}),I.jsxs("div",{className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-slate-400 uppercase tracking-wider",children:[I.jsx(u1,{className:"w-3 h-3 text-red-400"})," Temp"]}),I.jsx(qn,{value:(c=n.observationParams)==null?void 0:c.temp,placeholder:"--",type:"number",suffix:"F",onChange:P=>i("observationParams.temp",P)})]}),I.jsxs("div",{className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-slate-400 uppercase tracking-wider",children:[I.jsx(b9,{className:"w-3 h-3 text-purple-400"})," Ammonia"]}),I.jsx(qn,{value:(f=n.observationParams)==null?void 0:f.ammonia,placeholder:"--",type:"number",suffix:"ppm",onChange:P=>i("observationParams.ammonia",P)})]}),I.jsxs("div",{className:"bg-slate-800/50 p-3 rounded-xl border border-slate-700",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-slate-400 uppercase tracking-wider",children:[I.jsx(vv,{className:"w-3 h-3 text-emerald-400"})," Nitrates"]}),I.jsx(qn,{value:(p=n.observationParams)==null?void 0:p.nitrates,placeholder:"--",type:"number",suffix:"ppm",onChange:P=>i("observationParams.nitrates",P)})]})]})]}),n.intent==="MODIFY_HABITAT"&&I.jsxs("div",{className:"text-xl leading-relaxed text-slate-300 font-serif",children:["Create a new",I.jsx(qn,{value:(_=n.habitatParams)==null?void 0:_.size,placeholder:"#",type:"number",onChange:P=>i("habitatParams.size",P)}),I.jsx(qn,{value:(T=n.habitatParams)==null?void 0:T.unit,placeholder:"gal",onChange:P=>i("habitatParams.unit",P)}),I.jsx(qn,{value:(E=n.habitatParams)==null?void 0:E.type,placeholder:"Type (Fresh/Salt)",onChange:P=>i("habitatParams.type",P)}),"habitat named",I.jsx(qn,{value:(C=n.habitatParams)==null?void 0:C.name,placeholder:"Name",onChange:P=>i("habitatParams.name",P)}),"located in the",I.jsx(qn,{value:(x=n.habitatParams)==null?void 0:x.location,placeholder:"Location",onChange:P=>i("habitatParams.location",P)}),"."]})]}),I.jsxs("div",{className:"p-4 bg-black/40 border-t border-slate-800 flex gap-3",children:[I.jsx("button",{onClick:t,className:"px-6 py-4 rounded-xl text-slate-400 font-bold text-sm hover:text-white transition-colors",children:"Cancel"}),I.jsxs("button",{onClick:e,className:"flex-1 bg-emerald-500 hover:bg-emerald-400 text-white rounded-xl font-bold flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/20 transition-all active:scale-[0.98]",children:["Confirm & Save ",I.jsx(t1,{className:"w-5 h-5"})]})]})]})})},F9=()=>{const{processVoiceInput:n,testConnection:e}=_v(),[t,i]=ye.useState(!1),[r,a]=ye.useState("scenarios"),[l,c]=ye.useState("idle"),[f,p]=ye.useState(null),[_,T]=ye.useState(""),[E,C]=ye.useState(!1),[x,P]=ye.useState(null),[k,K]=ye.useState(!1),W=async()=>{c("testing"),p(null);const z=await e();c(z.success?"success":"fail"),!z.success&&z.error&&p(z.error),z.success&&setTimeout(()=>c("idle"),3e3)},q=async()=>{if(_.trim()){C(!0),P(null);try{const z=await xc.getAdvisoryReport(_);P(z)}catch(z){console.error(z)}finally{C(!1)}}},ee=()=>{x&&(navigator.clipboard.writeText(x.ide_prompt),K(!0),setTimeout(()=>K(!1),2e3))},ae=[{label:"New Tank",cmd:"Create a 20 gallon freshwater tank in the living room called The Shallows."},{label:"Log Fish",cmd:"I just added 12 Neon Tetras and 5 Cherry Shrimp to The Shallows."},{label:"Log Parameters",cmd:"Log a water change for The Shallows. pH is 6.8 and temperature is 78 degrees."},{label:"Ambiguous",cmd:"Add 2 snails to the tank."}];return t?I.jsxs("div",{className:`fixed top-4 right-4 z-50 bg-slate-900 border border-slate-800 rounded-xl shadow-2xl p-4 animate-in slide-in-from-right-10 flex flex-col gap-4 transition-all duration-300 ${x?"w-[480px]":"w-80"}`,children:[I.jsxs("div",{className:"flex justify-between items-center border-b border-slate-800 pb-2",children:[I.jsxs("div",{className:"flex gap-1 bg-slate-800/50 p-1 rounded-lg",children:[I.jsx("button",{onClick:()=>a("scenarios"),className:`p-1.5 rounded-md transition-all ${r==="scenarios"?"bg-emerald-500 text-white shadow-sm":"text-slate-400 hover:text-white"}`,title:"Test Scenarios",children:I.jsx(N9,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>a("contractor"),className:`p-1.5 rounded-md transition-all ${r==="contractor"?"bg-emerald-500 text-white shadow-sm":"text-slate-400 hover:text-white"}`,title:"Advisory Service",children:I.jsx(Vw,{className:"w-4 h-4"})})]}),I.jsx("button",{onClick:()=>i(!1),className:"text-slate-500 hover:text-white p-1",children:I.jsx(Os,{className:"w-4 h-4"})})]}),r==="scenarios"?I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"space-y-2",children:[I.jsxs("button",{onClick:W,className:`w-full py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all ${l==="idle"?"bg-slate-800 text-slate-300 hover:bg-slate-700":l==="testing"?"bg-amber-500/20 text-amber-500 animate-pulse":l==="success"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:[I.jsx(Yy,{className:"w-3 h-3"}),l==="idle"&&"Test DB Connection",l==="testing"&&"Verifying...",l==="success"&&"Ping/Pong Verified",l==="fail"&&"Connection Failed"]}),f&&I.jsxs("div",{className:"bg-red-950/30 border border-red-500/20 p-2 rounded text-[10px] text-red-300 flex gap-2 items-start",children:[I.jsx(Sv,{className:"w-3 h-3 shrink-0 mt-0.5"}),I.jsx("span",{className:"break-words",children:f})]})]}),I.jsx("div",{className:"space-y-2",children:ae.map((z,N)=>I.jsxs("button",{onClick:()=>n(z.cmd),className:"w-full text-left px-3 py-2 rounded-lg bg-slate-800/50 hover:bg-emerald-500/10 hover:text-emerald-400 hover:border-emerald-500/30 border border-transparent text-xs text-slate-300 transition-all group",children:[I.jsx("div",{className:"font-bold mb-0.5",children:z.label}),I.jsxs("div",{className:"text-[10px] text-slate-500 truncate group-hover:text-emerald-500/70",children:['"',z.cmd,'"']})]},N))})]}):I.jsxs("div",{className:"space-y-3 animate-in fade-in slide-in-from-right-4 duration-300",children:[I.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-3",children:[I.jsxs("h4",{className:"text-emerald-400 font-bold text-xs flex items-center gap-2 mb-1",children:[I.jsx(Vw,{className:"w-3 h-3"})," Architectural Advisor"]}),I.jsx("p",{className:"text-[10px] text-emerald-500/70 leading-relaxed",children:"Consult on feature implementation. I analyze the intent against the current Entity/Event schema and return a safe implementation plan."})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsx("textarea",{value:_,onChange:z=>T(z.target.value),placeholder:"E.g., 'How do I add support for tracking fertilization schedules?'",className:"w-full bg-black/40 border border-slate-700 rounded-lg px-3 py-2 text-xs text-white focus:border-emerald-500 focus:outline-none placeholder:text-slate-600 min-h-[60px] resize-none",onKeyDown:z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),q())}}),!x&&I.jsxs("button",{onClick:q,disabled:E||!_.trim(),className:"w-full py-2 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-xs font-bold text-white flex items-center justify-center gap-2 transition-colors",children:[E?I.jsx(Sp,{className:"w-3 h-3 animate-spin"}):I.jsx(r9,{className:"w-3 h-3 fill-current"}),"Generate Advisory Report"]})]}),x&&I.jsxs("div",{className:"space-y-4 pt-2 border-t border-slate-800 animate-in slide-in-from-bottom-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Report Status"}),x.persistence_status==="SECURE"?I.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded-full border border-emerald-500/20",children:[I.jsx(a1,{className:"w-3 h-3"})," Audit Log Secure"]}):I.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-red-400 bg-red-500/10 px-2 py-0.5 rounded-full border border-red-500/20",children:[I.jsx(g9,{className:"w-3 h-3"})," Audit Log Failed"]})]}),I.jsxs("div",{className:"space-y-1",children:[I.jsx("h5",{className:"text-xs font-bold text-white",children:"Strategy"}),I.jsx("p",{className:"text-xs text-slate-400 leading-relaxed bg-slate-800/50 p-2 rounded-lg border border-slate-700/50",children:x.strategy})]}),I.jsxs("div",{className:"space-y-1",children:[I.jsx("h5",{className:"text-xs font-bold text-amber-400",children:"Impact Analysis"}),I.jsx("p",{className:"text-xs text-amber-500/80 leading-relaxed bg-amber-900/10 p-2 rounded-lg border border-amber-500/20",children:x.impact_analysis})]}),I.jsxs("div",{className:"space-y-1",children:[I.jsx("h5",{className:"text-xs font-bold text-white",children:"Implementation Steps"}),I.jsx("ul",{className:"text-xs text-slate-400 list-disc list-inside space-y-1 ml-1",children:x.implementation_steps.map((z,N)=>I.jsx("li",{children:z},N))})]}),I.jsxs("button",{onClick:ee,className:"w-full py-3 bg-emerald-600 hover:bg-emerald-500 rounded-xl text-white font-bold text-xs flex items-center justify-center gap-2 shadow-lg shadow-emerald-500/20 transition-all active:scale-[0.98]",children:[k?I.jsx(Tv,{className:"w-4 h-4"}):I.jsx(xG,{className:"w-4 h-4"}),k?"Prompt Copied!":"Copy Master IDE Prompt"]}),I.jsx("button",{onClick:()=>{P(null),T("")},className:"w-full py-2 text-xs text-slate-500 hover:text-white transition-colors",children:"Start New Query"})]})]})]}):I.jsx("button",{onClick:()=>i(!0),className:"fixed top-4 right-4 z-50 bg-slate-800/50 p-2 rounded-full border border-slate-700 hover:bg-slate-700 hover:text-emerald-400 text-slate-500 transition-colors",title:"Open Dev Tools",children:I.jsx(l1,{className:"w-5 h-5"})})},B9=()=>{const{messages:n,sendMessage:e,clearMessages:t}=_v(),[i,r]=ye.useState(!1),[a,l]=ye.useState(""),[c,f]=ye.useState(!1),[p,_]=ye.useState(!1),[T,E]=ye.useState(!1),C=ye.useRef(null);ye.useEffect(()=>{C.current&&(C.current.scrollTop=C.current.scrollHeight)},[n,c]);const x=async()=>{if(!a.trim()||c)return;const P=a;l(""),f(!0);try{await e(P,{search:p,thinking:T})}finally{f(!1)}};return I.jsxs(I.Fragment,{children:[I.jsxs("button",{onClick:()=>r(!0),className:"fixed bottom-32 right-6 z-50 w-14 h-14 bg-emerald-600 rounded-full flex items-center justify-center shadow-2xl hover:bg-emerald-500 transition-all border border-emerald-400/20 group","aria-label":"Open AI Chat",children:[I.jsx(XG,{className:"w-6 h-6 text-white group-hover:scale-110 transition-transform"}),I.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-cyan-500 rounded-full animate-pulse border-2 border-[#0c120c]"})]}),i&&I.jsxs("div",{className:"fixed inset-0 z-[100] md:inset-auto md:bottom-24 md:right-6 md:w-[420px] md:h-[650px] bg-[#0c120c] border border-slate-800 md:rounded-3xl shadow-2xl flex flex-col overflow-hidden animate-in fade-in zoom-in duration-200",children:[I.jsxs("div",{className:"p-4 bg-slate-900/80 border-b border-slate-800 flex justify-between items-center backdrop-blur-md",children:[I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center border border-emerald-500/20",children:I.jsx(Ev,{className:"w-6 h-6 text-emerald-500"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-white font-serif font-bold text-lg",children:"Conservatory Guide"}),I.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-emerald-500/70 font-bold uppercase tracking-widest",children:[I.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"G3-Pro Intelligence Active"]})]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full text-slate-500 hover:text-red-400 transition-colors",title:"Clear History",children:I.jsx(Os,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>r(!1),className:"p-2 hover:bg-slate-800 rounded-full text-slate-500",children:I.jsx(Os,{className:"w-6 h-6"})})]})]}),I.jsxs("div",{ref:C,className:"flex-1 overflow-y-auto p-4 space-y-4 no-scrollbar bg-gradient-to-b from-slate-900/20 to-transparent",children:[n.length===0&&I.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-40 px-10 space-y-4",children:[I.jsx("div",{className:"p-6 bg-slate-800/30 rounded-full border border-slate-700",children:I.jsx(Wf,{className:"w-12 h-12 text-slate-600"})}),I.jsxs("div",{className:"space-y-1",children:[I.jsx("p",{className:"text-sm text-slate-200 font-bold uppercase tracking-widest",children:"Awaiting Input"}),I.jsx("p",{className:"text-xs text-slate-400",children:"Ask about biology, system design, or current trends."})]})]}),n.map(P=>I.jsx("div",{className:`flex ${P.role==="user"?"justify-end":"justify-start"}`,children:I.jsxs("div",{className:`max-w-[90%] rounded-2xl p-4 text-sm shadow-xl ${P.role==="user"?"bg-emerald-600 text-white":"bg-slate-900 border border-slate-800 text-slate-200"}`,children:[I.jsx("div",{className:"whitespace-pre-wrap leading-relaxed font-sans",children:P.text}),P.groundingLinks&&P.groundingLinks.length>0&&I.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-800 space-y-2",children:[I.jsxs("p",{className:"text-[10px] uppercase font-bold text-cyan-500 flex items-center gap-1.5",children:[I.jsx(Lw,{className:"w-3 h-3"})," Grounded Search Results"]}),I.jsx("div",{className:"grid grid-cols-1 gap-1.5",children:P.groundingLinks.map((k,K)=>I.jsxs("a",{href:k.uri,target:"_blank",rel:"noreferrer",className:"text-[11px] text-slate-400 hover:text-cyan-400 hover:bg-cyan-500/5 p-1.5 rounded-lg border border-transparent hover:border-cyan-500/20 flex items-center gap-2 transition-all",children:[I.jsx(Qy,{className:"w-3 h-3 shrink-0"}),I.jsx("span",{className:"truncate",children:k.title})]},K))})]}),P.isThinking&&!P.isSearch&&I.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-[9px] text-amber-500/60 font-bold uppercase tracking-tighter",children:[I.jsx(Wf,{className:"w-3 h-3"})," Processed via Deep Thinking Mode"]})]})},P.id)),c&&I.jsx("div",{className:"flex justify-start",children:I.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-4 flex gap-3 items-center shadow-lg",children:[I.jsxs("div",{className:"relative",children:[I.jsx(Sp,{className:"w-5 h-5 text-emerald-500 animate-spin"}),T&&I.jsx(Wf,{className:"absolute inset-0 m-auto w-2 h-2 text-amber-500"})]}),I.jsxs("div",{className:"space-y-1",children:[I.jsx("span",{className:"text-xs text-slate-200 font-bold block",children:p?"Searching Google...":T?"Thinking Deeply...":"Processing..."}),I.jsx("span",{className:"text-[10px] text-slate-500 italic block animate-pulse",children:"Consulting The Conservatory Knowledge Base"})]})]})})]}),I.jsxs("div",{className:"p-6 bg-slate-900/90 border-t border-slate-800 space-y-4 backdrop-blur-xl",children:[I.jsxs("div",{className:"flex gap-3",children:[I.jsxs("button",{onClick:()=>{_(!p),E(!1)},className:`flex-1 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest flex items-center justify-center gap-2 border transition-all ${p?"bg-cyan-500/20 border-cyan-500 text-cyan-400 shadow-lg shadow-cyan-500/10":"bg-slate-800 border-slate-700 text-slate-500 grayscale"}`,children:[I.jsx(Lw,{className:"w-3.5 h-3.5"})," Grounded"]}),I.jsxs("button",{onClick:()=>{E(!T),_(!1)},className:`flex-1 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest flex items-center justify-center gap-2 border transition-all ${T?"bg-amber-500/20 border-amber-500 text-amber-400 shadow-lg shadow-amber-500/10":"bg-slate-800 border-slate-700 text-slate-500 grayscale"}`,children:[I.jsx(Wf,{className:"w-3.5 h-3.5"})," Reasoning"]})]}),I.jsxs("div",{className:"relative group",children:[I.jsx("input",{value:a,onChange:P=>l(P.target.value),onKeyDown:P=>P.key==="Enter"&&x(),placeholder:p?"Ask for recent news or care guides...":"Ask a complex question...",className:"w-full bg-black/60 border border-slate-800 rounded-2xl pl-5 pr-14 py-4 text-sm text-white focus:outline-none focus:border-emerald-500 transition-all placeholder:text-slate-600 shadow-inner"}),I.jsx("button",{onClick:x,disabled:!a.trim()||c,className:"absolute right-2 top-2 p-3 bg-emerald-600 rounded-xl text-white hover:bg-emerald-500 disabled:opacity-50 disabled:grayscale transition-all shadow-xl active:scale-95",children:I.jsx(c9,{className:"w-5 h-5"})})]}),I.jsxs("div",{className:"flex items-center gap-2 px-1 text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:[I.jsx(BG,{className:"w-3 h-3"})," Powered by Gemini-3-Pro"]})]})]})]})},G9=({onClose:n})=>{const[e,t]=ye.useState(""),[i,r]=ye.useState(null),a=()=>{try{const c=JSON.parse(e);if(!c.apiKey||!c.projectId)throw new Error("Config must contain at least 'apiKey' and 'projectId'");localStorage.setItem("conservatory_firebase_config",JSON.stringify(c)),window.location.reload()}catch(c){r(c.message||"Invalid JSON")}},l=()=>{confirm("This will remove the local configuration. Continue?")&&(localStorage.removeItem("conservatory_firebase_config"),window.location.reload())};return I.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-md flex items-center justify-center p-4",children:I.jsxs("div",{className:"bg-slate-900 w-full max-w-lg border border-slate-700 rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[I.jsxs("div",{className:"p-4 border-b border-slate-800 flex justify-between items-center bg-black/20",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx(Yy,{className:"w-5 h-5 text-emerald-500"}),I.jsx("h3",{className:"text-white font-bold",children:"Connect Database"})]}),I.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:I.jsx(Os,{className:"w-5 h-5"})})]}),I.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[70vh] no-scrollbar",children:[I.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-3 text-xs text-amber-200/80 flex gap-3 items-start leading-relaxed",children:[I.jsx(Sv,{className:"w-5 h-5 shrink-0 text-amber-500"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-bold text-amber-500 mb-1 uppercase tracking-wider",children:"Critical Step: Project ID"}),"Ensure you are using your own Firebase Project. The default ID is ",I.jsx("strong",{children:"the-conservatory-d858b"}),'. If you are seeing "API Disabled" errors, you must manually enable the API for your specific project.']})]}),I.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3 text-xs text-blue-200/80 flex gap-3 items-start leading-relaxed",children:[I.jsx(a1,{className:"w-5 h-5 shrink-0 text-blue-400"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-bold text-blue-400 mb-1",children:"Step 1: Enable Firestore API"}),"Before using Firestore, the API must be active in your Google Cloud Project.",I.jsxs("a",{href:"https://console.developers.google.com/apis/api/firestore.googleapis.com/overview",target:"_blank",rel:"noreferrer",className:"mt-2 flex items-center gap-1 underline font-bold text-blue-400",children:["Go to API Dashboard ",I.jsx(Qy,{className:"w-3 h-3"})]})]})]}),I.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 rounded-lg p-3 text-xs text-emerald-200/80 flex gap-3 items-start leading-relaxed",children:[I.jsx(Yy,{className:"w-5 h-5 shrink-0 text-emerald-500"}),I.jsxs("div",{children:[I.jsx("p",{className:"font-bold text-emerald-500 mb-1",children:"Step 2: Create Database Instance"}),I.jsxs("p",{className:"text-emerald-200/80",children:["Go to ",I.jsx("strong",{children:"Build > Firestore Database"})," in Firebase Console and click ",I.jsx("strong",{children:"Create Database"}),". Select ",I.jsx("strong",{children:"Production Mode"})," or ",I.jsx("strong",{children:"Test Mode"})," (allow writes for dev)."]}),I.jsxs("a",{href:"https://console.firebase.google.com",target:"_blank",rel:"noreferrer",className:"mt-2 flex items-center gap-1 underline font-bold text-emerald-400",children:["Open Firebase Console ",I.jsx(Qy,{className:"w-3 h-3"})]})]})]}),I.jsxs("div",{className:"space-y-2 pt-2",children:[I.jsx("label",{className:"text-xs font-bold uppercase tracking-widest text-slate-500",children:"Step 3: Paste Web App Config"}),I.jsx("textarea",{value:e,onChange:c=>{t(c.target.value),r(null)},placeholder:'{ "apiKey": "...", "authDomain": "...", "projectId": "..." }',className:"w-full h-32 bg-black/50 border border-slate-700 rounded-xl p-4 text-xs font-mono text-emerald-400 placeholder:text-slate-700 focus:outline-none focus:border-emerald-500/50 resize-none"})]}),i&&I.jsx("div",{className:"text-xs text-red-400 bg-red-950/30 p-2 rounded border border-red-900/50",children:i})]}),I.jsxs("div",{className:"p-4 bg-black/40 border-t border-slate-800 flex justify-between items-center shrink-0",children:[I.jsx("button",{onClick:l,className:"text-xs text-red-400 hover:text-red-300 underline",children:"Clear Local Config"}),I.jsxs("div",{className:"flex gap-3",children:[I.jsx("button",{onClick:n,className:"px-4 py-2 text-xs font-bold text-slate-400 hover:text-white",children:"Cancel"}),I.jsxs("button",{onClick:a,disabled:!e.trim(),className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-emerald-900/20",children:[I.jsx(Tv,{className:"w-4 h-4"})," Save & Reload"]})]})]})]})})},q9=({onLogin:n})=>I.jsx("div",{className:"min-h-screen bg-[#0c120c] flex flex-col items-center justify-center p-6 max-w-2xl mx-auto",children:I.jsxs("div",{className:"text-center space-y-8 animate-in fade-in zoom-in duration-700",children:[I.jsxs("div",{className:"flex flex-col items-center gap-4",children:[I.jsx("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center border border-emerald-500/20 shadow-2xl shadow-emerald-500/10",children:I.jsx(o1,{className:"w-12 h-12 text-emerald-500"})}),I.jsxs("div",{children:[I.jsx("h1",{className:"text-4xl font-serif font-bold text-white tracking-tight",children:"The Conservatory"}),I.jsx("p",{className:"text-emerald-500/60 uppercase tracking-[0.4em] text-[10px] font-bold mt-2",children:"Digital Twin Management"})]})]}),I.jsx("div",{className:"max-w-xs mx-auto text-slate-400 text-sm leading-relaxed",children:"A voice-first aquaculture and plant tracking system with Gemini-powered intelligence."}),I.jsxs("button",{onClick:n,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 transition-all shadow-xl shadow-emerald-900/20 group",children:[I.jsx($G,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"}),"Sign in with Google"]}),I.jsx("p",{className:"text-[10px] text-slate-600 uppercase tracking-widest font-bold",children:"Private Access  Event Sourced Integrity"})]})}),z9=({children:n,activeTab:e,setActiveTab:t,connectionStatus:i,onOpenSettings:r,onLogout:a,photoIdentifyComponent:l,voiceButtonComponent:c})=>I.jsxs("div",{className:"min-h-screen bg-[#0c120c] flex flex-col max-w-2xl mx-auto border-x border-slate-900 shadow-2xl relative",children:[I.jsxs("header",{className:"p-6 pt-10 flex justify-between items-end bg-gradient-to-b from-[#111811] to-transparent shrink-0",children:[I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center gap-2 text-emerald-500 mb-1",children:[I.jsx(o1,{className:"w-5 h-5"}),I.jsx("span",{className:"text-[10px] font-bold uppercase tracking-[0.3em]",children:"The Conservatory"}),I.jsx("div",{className:`flex items-center gap-1.5 ml-2 px-2 py-0.5 rounded-full border text-[9px] font-bold uppercase tracking-tighter transition-all ${i==="connected"?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"bg-red-500/10 border-red-500/20 text-red-400"}`,children:i==="connected"?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"w-1 h-1 rounded-full bg-emerald-500 animate-pulse"}),"Live Sync"]}):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"w-1 h-1 rounded-full bg-red-500"}),"Offline"]})})]}),I.jsx("h1",{className:"text-3xl font-serif font-bold text-white tracking-tight",children:e==="feed"?"Activity":"Collection"})]}),I.jsxs("div",{className:"flex gap-2",children:[l,I.jsxs("div",{className:"flex flex-col gap-2",children:[I.jsx("button",{onClick:r,className:`p-3 rounded-full border transition-all ${["error","api_disabled","permission_denied"].includes(i)?"bg-red-500/20 border-red-500 text-red-400 animate-pulse":"bg-slate-800/80 border-slate-700 text-slate-400"}`,children:["error","api_disabled","permission_denied"].includes(i)?I.jsx(n1,{className:"w-6 h-6"}):I.jsx(p9,{className:"w-6 h-6"})}),I.jsx("button",{onClick:a,className:"p-3 bg-slate-800/80 rounded-full border border-slate-700 text-slate-400 hover:text-red-400 transition-colors",children:I.jsx(QG,{className:"w-5 h-5"})})]})]})]}),I.jsx("main",{className:"flex-1 px-6 pt-4 overflow-y-auto no-scrollbar pb-32",children:n}),I.jsx("nav",{className:"fixed bottom-0 left-0 right-0 max-w-2xl mx-auto px-6 pb-6 z-40 pointer-events-none",children:I.jsxs("div",{className:"bg-slate-900/80 backdrop-blur-xl border border-slate-800 rounded-3xl p-2 flex items-center justify-around shadow-2xl pointer-events-auto",children:[I.jsxs("button",{onClick:()=>t("feed"),className:`flex-1 py-3 rounded-2xl flex items-center justify-center gap-2 transition-all ${e==="feed"?"bg-emerald-500/10 text-emerald-400":"text-slate-500"}`,children:[I.jsx(vv,{className:"w-5 h-5"}),I.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Feed"})]}),I.jsx("div",{className:"w-20"})," ",I.jsxs("button",{onClick:()=>t("entities"),className:`flex-1 py-3 rounded-2xl flex items-center justify-center gap-2 transition-all ${e==="entities"?"bg-emerald-500/10 text-emerald-400":"text-slate-500"}`,children:[I.jsx(zG,{className:"w-5 h-5"}),I.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Collection"})]})]})}),I.jsx("div",{className:"pointer-events-none fixed inset-0 flex items-end justify-center z-50",children:I.jsx("div",{className:"pointer-events-auto pb-8",children:c})})]}),H9=()=>{const{events:n,entities:e,groups:t,pendingAction:i,user:r,processVoiceInput:a,commitPendingAction:l,discardPending:c,updateSlot:f,updateEntity:p,addGroup:_,testConnection:T,login:E,logout:C}=_v(),[x,P]=ye.useState("feed"),[k,K]=ye.useState(null),[W,q]=ye.useState(!1),[ee,ae]=ye.useState("unknown"),[z,N]=ye.useState(null);ye.useEffect(()=>{window.setTestUser=G=>N(G),window.processVoiceInput=a;const L=async()=>{const G=await T();ae(G.code||"unknown")};L();const U=setInterval(L,3e4);return()=>clearInterval(U)},[T,r]);const M=L=>{a(`I observed a ${L.common_name} (${L.species}). Reasoning: ${L.reasoning}`)},D=L=>{L.forEach(U=>{a(`Create a new habitat: ${U.size_estimate} tank located at ${U.shelf_level} shelf, ${U.horizontal_position}. It has ${U.primary_species.map(G=>G.common_name).join(", ")}.`)})};return!r&&!z?I.jsx(q9,{onLogin:E}):I.jsxs(z9,{activeTab:x,setActiveTab:P,connectionStatus:ee,onOpenSettings:()=>q(!0),onLogout:C,photoIdentifyComponent:I.jsx(k9,{onConfirmObservation:M,onConfirmRack:D}),voiceButtonComponent:I.jsx(M9,{onTranscription:L=>a(L)}),children:[I.jsx(F9,{}),I.jsx(B9,{}),W&&I.jsx(G9,{onClose:()=>q(!1)}),i&&I.jsx(O9,{action:i,onCommit:l,onDiscard:c,onUpdate:f}),x==="feed"?I.jsx(D9,{events:n}):I.jsx(P9,{entities:e,groups:t,onSelectEntity:L=>K(L)}),k&&I.jsx(L9,{entity:k,groups:t,onClose:()=>K(null),onUpdate:L=>{p(k.id,L),K({...k,...L})},onAddGroup:_})]})},c1=document.getElementById("root");if(!c1)throw new Error("Could not find root element to mount to");const K9=WN.createRoot(c1);K9.render(I.jsx(HN.StrictMode,{children:I.jsx(H9,{})}));
