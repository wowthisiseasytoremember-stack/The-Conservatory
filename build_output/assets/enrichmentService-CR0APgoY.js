import{p as f,l as i}from"./index-WeNjpUpQ.js";const m="https://en.wikipedia.org/w/api.php",p="https://api.gbif.org/v1",d="https://api.inaturalist.org/v1",R={async searchGBIF(a){try{const n=await(await fetch(`${p}/species/match?name=${encodeURIComponent(a)}`)).json();if(!n.usageKey)return null;const t=await(await fetch(`${p}/species/${n.usageKey}`)).json();return{scientificName:t.scientificName,taxonomy:{kingdom:t.kingdom,phylum:t.phylum,order:t.order,family:t.family,genus:t.genus}}}catch(e){return i.warn({err:e,operation:"gbif_search"},"GBIF search failed"),null}},async searchWikipedia(a){var e,n,s,t;try{const r=`${m}?action=query&list=search&srsearch=${encodeURIComponent(a)}&format=json&origin=*`,o=await(await fetch(r)).json();if(!((n=(e=o.query)==null?void 0:e.search)!=null&&n.length))return null;const c=o.query.search[0].title,u=`${m}?action=query&prop=extracts&exintro&explaintext&titles=${encodeURIComponent(c)}&format=json&origin=*`,l=(s=(await(await fetch(u)).json()).query)==null?void 0:s.pages,h=Object.keys(l)[0];return{description:(t=l[h])==null?void 0:t.extract,commonName:c}}catch(r){return i.warn({err:r,operation:"wikipedia_search"},"Wikipedia search failed"),null}},async searchiNaturalist(a){var e;try{const n=`${d}/taxa?q=${encodeURIComponent(a)}`,t=await(await fetch(n)).json();if(!((e=t.results)!=null&&e.length))return null;const r=t.results[0];return{commonName:r.preferred_common_name,scientificName:r.name,images:r.default_photo?[r.default_photo.medium_url]:[]}}catch(n){return i.warn({err:n,operation:"inaturalist_search"},"iNaturalist search failed"),null}},async scrapeAquasabi(a){try{const e=f.search(a);return e?(i.info({query:a,matchName:e.name},"Found local plant library match"),{scientificName:e.scientificName||e.traits["Complete botanical name"],commonName:e.name,description:e.details.description,origin:e.traits.Origin||e.traits.Distribution,images:e.images,tips:e.details.notes}):(i.warn({query:a},"No local plant library match found"),null)}catch(e){return i.warn({err:e,operation:"aquasabi_lookup"},"Aquasabi lookup failed"),null}}};export{R as enrichmentService};
